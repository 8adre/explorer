{"version":3,"sources":["webpack:///webpack/universalModuleDefinition","webpack:///webpack/bootstrap","webpack:///external \"lodash\"","webpack:///external \"react\"","webpack:///./lib/js/app/utils/FormatUtils.js","webpack:///./lib/js/app/utils/ExplorerUtils.js","webpack:///external \"moment\"","webpack:///./lib/js/app/actions/ExplorerActions.js","webpack:///./lib/js/app/utils/ProjectUtils.js","webpack:///external \"classnames\"","webpack:///./lib/js/app/dispatcher/AppDispatcher.js","webpack:///./lib/js/app/utils/FilterUtils.js","webpack:///./lib/js/app/components/common/input.js","webpack:///./lib/js/app/components/common/react_select.js","webpack:///./lib/js/app/stores/ExplorerStore.js","webpack:///./lib/js/app/utils/RunValidations.js","webpack:///./lib/js/app/components/common/fields_toggle.js","webpack:///./lib/js/app/components/common/select.js","webpack:///./lib/js/app/stores/ProjectStore.js","webpack:///./lib/js/app/utils/TimeframeUtils.js","webpack:///./lib/js/app/actions/NoticeActions.js","webpack:///./lib/js/app/constants/ExplorerConstants.js","webpack:///external \"keymirror\"","webpack:///./node_modules/events/events.js","webpack:///external \"jQuery\"","webpack:///./lib/js/vendor/picker.js","webpack:///./lib/js/app/actions/AppStateActions.js","webpack:///./lib/js/app/validations/ExplorerValidations.js","webpack:///./lib/js/app/utils/ChartTypeUtils.js","webpack:///./lib/js/app/components/common/notice.js","webpack:///./lib/js/app/actions/ProjectActions.js","webpack:///./lib/js/app/components/common/loader.js","webpack:///./lib/js/app/validations/FilterValidations.js","webpack:///./lib/js/app/utils/QueryStringUtils.js","webpack:///./lib/js/app/components/common/filter_manager.js","webpack:///./lib/js/app/components/common/timepicker.js","webpack:///./lib/js/app/components/common/datepicker.js","webpack:///./lib/js/app/components/common/timeframe.js","webpack:///./lib/js/app/components/explorer/query_builder/select_field.js","webpack:///./lib/js/app/constants/NoticeConstants.js","webpack:///./lib/js/app/validations/StepValidations.js","webpack:///./lib/js/app/validations/SharedValidators.js","webpack:///./node_modules/moment-timezone/index.js","webpack:///external \"keen-dataviz\"","webpack:///./lib/js/app/components/common/modal.js","webpack:///./lib/js/app/constants/AppStateConstants.js","webpack:///./lib/js/app/stores/AppStateStore.js","webpack:///./lib/js/app/constants/ProjectConstants.js","webpack:///external \"string\"","webpack:///external \"qs\"","webpack:///./lib/js/app/stores/NoticeStore.js","webpack:///./lib/js/app/components/explorer/query_actions.js","webpack:///./lib/js/app/components/explorer/cache_toggle.js","webpack:///./lib/js/app/components/explorer/saved_queries/browse_queries.js","webpack:///./lib/js/app/components/explorer/query_builder/api_url.js","webpack:///./lib/js/app/components/common/interval.js","webpack:///./lib/js/app/components/common/geo.js","webpack:///./lib/js/app/components/common/filter_value_fields.js","webpack:///./lib/js/app/components/common/filter.js","webpack:///./lib/js/app/components/common/timezone.js","webpack:///./lib/js/app/components/common/relative_picker.js","webpack:///./lib/js/vendor/picker.time.js","webpack:///./lib/js/vendor/picker.date.js","webpack:///./lib/js/app/components/common/absolute_picker.js","webpack:///./lib/js/app/components/explorer/query_builder/funnels/funnel_step.js","webpack:///./lib/js/app/components/explorer/query_builder/funnels/funnel_builder.js","webpack:///./lib/js/app/components/explorer/query_builder/latest_field.js","webpack:///./lib/js/app/components/common/react_multi_select.js","webpack:///./lib/js/app/components/explorer/query_builder/extraction_options.js","webpack:///./lib/js/app/components/explorer/query_builder/group_by_field.js","webpack:///./lib/js/app/components/explorer/query_builder/percentile_field.js","webpack:///./lib/js/app/components/explorer/query_builder/index.js","webpack:///./lib/js/app/components/explorer/query_pane_tabs.js","webpack:///./lib/js/app/utils/DataUtils.js","webpack:///external \"react-highlight\"","webpack:///./lib/js/app/components/explorer/visualization/code_sample.js","webpack:///./node_modules/moment-timezone/moment-timezone.js","webpack:///./lib/js/app/components/explorer/visualization/keen_viz.js","webpack:///./lib/js/app/components/explorer/visualization/chart.js","webpack:///./lib/js/app/components/explorer/visualization/index.js","webpack:///./lib/js/app/components/common/event_browser.js","webpack:///./lib/js/app/components/explorer/index.js","webpack:///./lib/js/app/components/app.js","webpack:///external \"flux\"","webpack:///./lib/js/app/utils/DateUtils.js","webpack:///./lib/js/app/utils/FunnelUtils.js","webpack:///external \"json-stable-stringify\"","webpack:///./lib/js/app/modules/persistence/KeenSavedQueries.js","webpack:///./lib/js/app/modules/persistence/persistence.js","webpack:///external \"react-dom\"","webpack:///external \"keen-analysis\"","webpack:///./lib/js/app/app.js"],"names":["toTitleCase","singularize","prettyPrintJSON","coercionTypeForPropertyType","booleanMap","sortItems","isDateInStrictFormat","convertDateToUTC","formatISOTimeNoTimezone","generateRandomId","generateTempId","isValidQueryValue","parseList","isList","isNullOrUndefined","padLeft","ISO_DATE_FORMAT","_isWrappedInSingleQuotes","value","substring","length","_isWrappedInDoubleQuotes","text","replace","txt","charAt","toUpperCase","substr","toLowerCase","json","JSON","stringify","undefined","type","coercionTypeMap","items","keyFunc","formatString","str","mapped","map","el","i","index","sort","a","b","localeCompare","dateString","isValid","date","Date","getUTCFullYear","getUTCMonth","getUTCDate","getUTCHours","getUTCMinutes","getUTCSeconds","time","format","prefix","Math","floor","random","toString","_","isArray","isPlainObject","isEmpty","parsedList","parseCSV","val","quotelessVal","parseFloat","strVal","String","match","trim","isNull","isUndefined","FormatUtils","QUERY_PARAMS","EXRACTION_EVENT_LIMIT","ANALYSIS_TYPES_WITHOUT_TARGET","toCamelcaseName","name","p1","toUnderscoreName","SKIP","mapSkip","collection","fn","without","echoIf","valueMaybe","append","ExplorerUtils","isPersisted","explorer","id","saveType","shouldHaveTarget","query","analysis_type","indexOf","isEmailExtraction","email","isImmediateExtraction","mergeResponseWithExplorer","response","newModel","defaultsDeep","formatQueryParams","originalModel","query_name","cloneDeep","queryJSON","params","latest","property_names","assign","TimeframeUtils","getTimeParameters","timezone","filters","filter","FilterUtils","steps","FunnelUtils","stepJSON","each","key","remove","element","isNumber","includes","toJSON","pick","refresh_rate","cleanJSONforSave","paramsForURL","attrs","omit","runQuery","config","client","then","res","err","error","success","complete","catch","timeframe","unpackedTime","unpackTimeframeParam","group_by","compact","formatFilterParams","active","metadata","display_name","visualization","chart_type","interval","encodeAttribute","attr","encodeURIComponent","getApiQueryUrl","url","analysisType","queryAttrs","Qs","timeframeType","authKey","masterKey","readKey","resultCanBeVisualized","result","isJSONViz","isTableViz","getSdkExample","explorerConfig","defaultKeenAnalysisOpts","host","protocol","requestType","s","dynamicCriteria","paramNames","dynamicConstructorNames","funnelRootParams","dynamicConstructorValues","chartTitle","chartType","step","join","param","space","queryOptions","datavizConfig","keenDatavizOptions","datavizOptionsString","Object","keys","forEach","analysisConfig","keenAnalysisOptions","analysisOptionsString","projectId","newline","slugify","ExplorerActions","create","AppDispatcher","dispatch","actionType","ExplorerConstants","EXPLORER_CREATE","createBatch","models","EXPLORER_CREATE_BATCH","clone","sourceId","EXPLORER_CLONE","NoticeActions","icon","update","updates","updated_query","project","ProjectStore","getProject","EXPLORER_UPDATE","event_collection","ProjectActions","fetchCollectionSchema","EXPLORER_REMOVE","setActive","EXPLORER_SET_ACTIVE","revertActiveChanges","EXPLORER_REVERT_ACTIVE_CHANGES","clear","EXPLORER_CLEAR","validate","EXPLORER_VALIDATE","addFilter","EXPLORER_ADD_FILTER","removeFilter","EXPLORER_REMOVE_FILTER","updateFilter","EXPLORER_UPDATE_FILTER","addStep","EXPLORER_ADD_STEP","removeStep","EXPLORER_REMOVE_STEP","setStepActive","EXPLORER_SET_STEP_ACTIVE","updateStep","EXPLORER_UPDATE_STEP","moveStep","direction","EXPLORER_MOVE_STEP","addStepFilter","stepIndex","EXPLORER_ADD_STEP_FILTER","removeStepFilter","filterIndex","EXPLORER_REMOVE_STEP_FILTER","updateStepFilter","EXPLORER_UPDATE_STEP_FILTER","exec","ExplorerStore","get","loading","Error","EXPLORER_FOUND_INVALID","clearAll","execError","bind","execSuccess","message","body","EXPLORER_QUERY_ERROR","EXPLORER_QUERY_SUCCESS","isSaved","ChartTypeUtils","responseSupportsChartType","getChartTypeOptions","dataTimestamp","now","runEmailExtraction","runEmailExtractionSuccess","runEmailExtractionError","fetchAllPersisted","persistence","callback","AppStateActions","fetchingPersistedExplorers","resp","model","formattedModel","RunValidations","run","ExplorerValidations","console","warn","log","errors","push","fetchPersisted","save","persistenceFunction","EXPLORER_SAVING","saving","explorerJSON","EXPLORER_SAVE_FAIL","errorResp","saveSuccess","updatedModel","EXPLORER_SAVE_SUCCESS","destroy","EXPLORER_DESTROYING","EXPLORER_DESTROY_FAIL","errorMsg","EXPLORER_DESTROY_SUCCESS","CONSTANTS","DEFAULT_TIMEZONE","ANALYSIS_TYPES","ABSOLUTE_INTERVAL_TYPES","RELATIVE_INTERVAL_TYPES","TIMEZONES","offset","dst_offset","FILTER_OPERATORS","canBeCoeredTo","projectUtils","getConstant","eventsUrl","api_key","getEventCollectionPropertyNames","schema","sortedProperties","getPropertyType","propertyName","properties","getLocalTimezoneOffset","getTimezoneOffset","getLocalTimezone","isDST","DateUtils","localOffset","zones","zone","Dispatcher","exists","toType","obj","call","isNumeric","num","isNaN","filterUtils","coercionFunctions","property_value","coercedDate","defaultDate","newVal","isFalse","yesterday","subtract","startOf","Number","getCoercedValue","coercion_type","getCoercionType","operator","isComplete","isObject","FilterValidations","initList","item","isString","coerceGeoValue","trailingDecimals","validFilters","InputComponent","React","createClass","_onChange","event","setState","target","props","onChange","getDefaultProps","classes","inputClasses","placeholder","readonly","getInitialState","componentWillReceiveProps","nextProps","render","required","label","onBlur","state","ReactSelect","wrapClasses","handleBlur","handleChange","handleSelection","focusedItem","limit","initialFocus","selectedItem","visible","visibleItems","resetState","handleClick","e","handleItemFocus","newState","refs","scrollpane","scrollTop","input","handleFocus","relatedTarget","preventDefault","resetTimeout","setTimeout","blurTimeout","clearTimeout","handleItemSelection","selection","focus","handleKeyDown","itemHeight","itemOffset","list","children","scrollHeight","keyDownCallbacks","innerHTML","childNode","getAttribute","handleScroll","pane","diff","appendListItems","arr","self","opt","forceUpdate","insertListItems","splice","apply","concat","removeListItems","getItems","count","inputString","search","escapeRegExp","getScrollPane","title","CHANGE_EVENT","SHARED_FUNNEL_STEP_PROPERTIES","_explorers","_defaultAttrs","target_property","percentile","order_by","moment","tz","guess","relativity","amount","sub_timeframe","_defaultMetadata","_defaultFilter","property_name","_defaultGeoFilter","coordinates","max_distance_miles","_defaultStep","actor_property","ProjectUtils","optional","inverted","with_actors","_validate","_getDefaultFilterCoercionType","propertyType","targetCoercionType","_prepareUpdates","customizer","objValue","srcValue","mergeWith","_migrateToFunnel","_migrateFromFunnel","_removeInvalidFields","firstStep","activeStep","find","_prepareFilterUpdates","merge","newOp","coercionOptions","_wrapGroupBy","pull","_create","newAttrs","_update","_markFirstInvalidStepActive","_setStepActive","_remove","_setActive","_revertActiveChanges","original","_addFilter","_removeFilter","_updateFilter","_addStep","lastStep","_removeStep","_updateStep","_moveStep","stepToDisplace","_addStepFilter","_removeStepFilter","_updateStepFilter","_clear","EventEmitter","prototype","unregisterWithDispatcher","unregister","dispatchToken","set","getActive","getAll","getLast","getAllPersisted","emitChange","emit","addChangeListener","on","removeChangeListener","removeListener","register","action","finishAction","source","wasActive","validatorSet","validator","shouldRun","attribute","msg","FieldsToggle","handleFieldsToggle","toggledState","attrNames","attrsToStore","attrName","_storedAttrs","getFn","resetVal","resetValues","handleReset","updateFn","toggleButtonClick","toggle","openState","fieldsCount","open","toggleCallback","componentWillMount","initialOpenState","hide","componentDidReceiveProps","bodyContent","SelectComponent","buildOptions","options","option","disabled","wrapValuesInObjects","sortOptions","A","B","buildEmptyOption","emptyOption","setupOptions","newOptions","reference","optionNodes","emptyVal","multiple","selectedValue","selectedOption","_projects","defaultAttrs","eventCollections","sortedEventCollections","_updateEventCollection","collectionName","newCollection","_dispatcherToken","ProjectConstants","PROJECT_CREATE","PROJECT_UPDATE","PROJECT_UPDATE_EVENT_COLLECTION","timeframeUtils","has","timeframeBuilders","absolute","start","end","relative","getTimeframe","timeframeBuilder","unpackAbsoluteTimeframe","unpackRelativeTimeframe","formattedValue","z","startVal","endVal","split","NoticeConstants","NOTICE_CREATE","NOTICE_CLEAR_ALL","EXPLORER_SAVE","EXPLORER_SAVE_NEW","EXPLORER_DESTROY","factory","define","amd","exports","module","require","Picker","jQuery","$","$window","window","$document","document","$html","documentElement","PickerConstructor","ELEMENT","NAME","COMPONENT","OPTIONS","IS_DEFAULT_THEME","STATE","abs","SETTINGS","extend","defaults","CLASSES","klasses","klass","$ELEMENT","PickerInstance","P","constructor","$node","methods","autofocus","activeElement","readOnly","editable","component","$root","node","createWrappedComponent","picker","prepareElementRoot","formatSubmit","prepareElementHidden","prepareElement","container","after","onStart","onRender","stop","onStop","onOpen","close","onClose","onSet","isUsingDefaultTheme","trigger","entireComponent","html","box","nodes","_hidden","parentNode","removeChild","removeClass","removeData","off","dontGiveFocus","addClass","aria","opened","css","getScrollbarWidth","which","keycode","keyCode","keycodeToMove","go","highlighted","hasClass","highlight","contains","click","giveFocus","focusToOpen","focused","thing","thingItem","thingValue","thingIsObject","thingObject","muted","formats","method","internal","thingName","thingMethod","names","arguments","namesCount","data","_trigger","methodList","wrap","frame","holder","isKeycodeDelete","test","stopPropagation","haspopup","expanded","owns","focusin","is","nodeName","$target","targetData","targetDisabled","navDisabled","href","nav","hiddenName","hiddenPrefix","hiddenSuffix","theme","prop","currentStyle","getComputedStyle","height","$outer","appendTo","widthWithoutScroll","offsetWidth","$inner","widthWithScroll","group","groupObject","loopObjectScope","nodesList","counter","min","max","wrapper","lead","number","scope","args","digits","string","isDate","isInteger","ariaAttr","Component","componentData","$this","ariaSet","setAttribute","attrVal","AppStateConstants","APP_STATE_UPDATE","reset","APP_STATE_RESET","isNotFunnel","percentile_value","SharedValidators","StepValidations","rate","RegExp","n","getQueryDataType","isInterval","isGroupBy","Array","is2xGroupBy","dataType","dataTypes","queryDataType","isTableChartType","noticeExists","notice","NoticeComponent","closeCallback","closable","closeBtn","fetchProjectCollections","events","recentEvents","stack","updateEventCollection","fetchRecentEventsForCollection","eventCollection","LoaderComponent","additionalClasses","isGeoCoercionType","coercionType","valid","getSearchString","location","updateSearchString","queryStringData","urlPath","origin","pathname","history","pushState","getQueryAttributes","parse","depth","FilterManager","propTypes","PropTypes","propertyNames","array","func","isRequired","modal","coordinateIndex","parseInt","buildFilterNodes","filterNodes","noFiltersMarkup","filterContent","modalClosed","iconName","premadeTimes","parseTime","timeStr","dt","NaN","hours","setHours","setMinutes","setSeconds","Timepicker","validateTime","parsed","getTime","refValue","Datepicker","handleOnBlur","destroyPicker","onFocus","minimum","pickadate","datepicker","relativeDefaults","absoluteDefaults","Timeframe","toggleTimeframeType","currentTarget","dataset","isAbsolute","isRelative","timeframePicker","SelectField","buildBrowseEventsLink","onBrowseEvents","requiredNote","requiredLabel","defaultError","Modal","closeClick","backdropClick","closest","removeBackdrop","addBackdrop","setLoading","backdropEl","createElement","className","appendChild","buildFooter","footerBtns","btnConfig","iconClass","ref","onClick","size","modalClasses","componentDidMount","componentWillUnmount","modalDialogClasses","titleIcon","titleIconClasses","iconClasses","defaultState","codeSampleHidden","ready","_appState","_reset","AppStateStore","getState","_notices","_removeGlobalNotices","_removeStepNotices","tempId","_clearAll","NoticeStore","getGlobalNotice","getStepNotices","waitFor","error_code","QueryActions","runBtnStates","default","inactive","immediateExtraction","emailExtraction","runButtonText","btnStates","saveMsg","saveBtn","cloneBtn","deleteBtn","actionsSupported","runButtonClasses","codeSampleBtnClasses","isFunnel","saveQueryClick","removeClick","cloneQueryClick","handleQuerySubmit","toggleCodeSample","refreshRateMultiplier","CacheToggle","setCached","_isCached","settingsOpen","setSettingsOpen","setRefreshRate","setRefreshRateBlur","round","_refreshRateInHours","cached","isCached","parentClasses","cacheDetailsClasses","cacheSettingsClasses","cacheToggleLabel","_minutesAgo","runInformation","run_information","last_run_status","lastRun","last_run_date","utcOffset","duration","humanize","dateForItem","created_date","datetime","BrowseQueries","clickCallback","buildList","listElements","listItems","listItem","isSelected","selectedIndex","createdAt","isCachedText","displayName","fieldChanged","emptyContent","ApiUrl","handleInputSelect","setSelectionRange","handleInputChange","Interval","tab","getTab","toggleState","intervalSplitted","getCustomInterval","units","customIntervalValue","updateCustomInterval","x","intervalGetFn","intervalUpdateFn","intervalFieldsToggled","setInterval","setCustomValue","setCustomUnits","Geo","dateFormat","timeFormat","pasrseIntoDate","timeString","FilterValueFields","handleChangeWithEvent","setValueState","setDate","setTime","handleDateBlur","handleKeyPress","onPressEnter","getCoercionOptions","filterOperators","getInputPlaceholder","newProps","valueInput","Filter","buildValueFormGroup","buildOperatorSelect","buildPropertyNameSelect","getListSyntaxInfo","buildValidationError","filterCompleteAndInvalid","filterClasses","Timezone","handleTimezoneBlur","handleTimezoneActivated","handleTimezoneChange","timezones","RELATIVE_TIMEFRAMES","hasRelativeTimeframe","RelativePicker","setRelativeTime","buildDescriptionCopy","subIntervalCopy","timeAmountPluralSuffix","relativityCopy","singularCurrentInterval","descriptionCopy","relativeIntervalTypes","HOURS_IN_DAY","MINUTES_IN_HOUR","HOURS_TO_NOON","MINUTES_IN_DAY","TimePicker","settings","clock","elementValue","elementDataValue","valueString","queue","select","view","disable","enable","slice","collectionDisabled","shift","fromValue","timeChange","$pickerHolder","$viewset","viewset","vendors","vendor","animations","$el","position","top","clientHeight","clockItem","pop","getHours","getMinutes","normalize","hour","mins","createRange","from","to","createTime","withinRange","range","timeUnit","overlapRanges","one","two","nowMinutes","isValueInteger","isBelowInterval","minTime","measure","timeObject","timeToVerify","isDisabledMatch","timeToDisable","minLimit","maxLimit","minutes","isPM","parseValue","parsingObject","toArray","formattingLabel","formatLength","h","hh","H","HH","itemObject","isTimeExact","isTimeOverlap","flipEnable","deactivate","timesToDisable","disabledItems","unitToDisable","matchFound","activate","timesToEnable","disabledItemsCount","unitToEnable","disabledUnit","isRangeMatched","getFullYear","getMonth","getDate","isOpen","selectedObject","highlightedObject","viewsetObject","disabledCollection","loopedTime","timeMinutes","isHighlighted","isDisabled","formatLabel","selected","role","activedescendant","buttonClear","controls","DAYS_IN_WEEK","WEEKS_IN_CALENDAR","DatePicker","calendar","isRTL","targetDate","UTC","year","month","selectMonth","selectYear","includeToday","buttonToday","calendarItem","isInfiniteValue","Infinity","day","getUTCDay","createDate","dateUnit","rel","setUTCDate","navigate","targetDateObject","targetYear","targetMonth","isTargetArray","isTargetObject","setUTCHours","dateObject","originalDateObject","isFlippedBase","hasEnabledBeforeTarget","hasEnabledAfterTarget","minLimitObject","maxLimitObject","reachedMin","reachedMax","hasEnabledWeekdays","dateTime","dateToVerify","dateToDisable","firstDay","yyyy","yy","mm","m","dd","d","getWordLengthFromCollection","word","getFirstWordLength","ddd","weekdaysShort","dddd","weekdaysFull","mmm","monthsShort","mmmm","monthsFull","isDateExact","isDateOverlap","datesToDisable","datesToEnable","isExactRange","nowObject","tableHead","fullCollection","weekdays","showWeekdaysFull","createMonthNav","next","labelMonthNext","labelMonthPrev","createMonthLabel","monthsCollection","showMonthsShort","selectMonths","loopedMonth","labelMonthSelect","createYearLabel","focusedYear","numberYears","selectYears","minYear","maxYear","lowestYear","highestYear","availableYears","neededYears","loopedYear","labelYearSelect","header","rowCounter","shiftDateBy","infocus","outfocus","table","today","buttonClose","footer","navPrev","navNext","AbsolutePicker","endValue","FunnelStep","object","toggleStepActive","handleFilterChange","handleAddFilter","handleRemoveFilter","canRemove","confirm","handleCheckboxChange","checked","handleFiltersToggle","moveStepUp","moveStepDown","buildStepBody","stepWrapperClasses","FunnelsBuilder","modelId","stepNotices","getEventPropertyNames","buildSteps","LatestField","ReactMultiSelect","focusedIndex","interceptEvent","itemVal","_isSelected","_handleOptionChange","_renderOption","selectedItems","_toggleOpenClose","_renderOptionMenu","ExtractionOptions","projectSchema","property","shouldBeSelected","newPropertyNames","emailField","latestField","extractionPropertiesFilter","isEmail","_getExtractionKeys","_handlePropertyNamesChange","setExtractionType","GroupByField","toggled","toggleMultiGroupBy","v","handleChangeLimit","shouldBeOpen","updateGroupBy","getGroupBy","handleChangeOrderReset","focusOnReactSelect","handleChangeOrder","valueOrderBy","valueLimit","secondField","multiGroupToggle","PercentileField","QueryBuilder","handleSelectionWithEvent","handleRevertChanges","shouldShowRevertButton","isEqual","buildEventCollectionField","buildExtractionOptions","buildGroupByField","buildTargetPropertyField","buildPercentileField","buildIntervalField","buildFilters","buildGlobalTimeframePicker","buildFunnelBuilder","buildClearButton","handleClearQuery","apiQueryUrl","analysisTypes","QueryPaneTabs","btnNewQuery","queryPaneClasses","persisted","createNewQuery","activePane","exportToCsv","filename","csvContent","htmlElement","row","cell","j","encodeURI","CodeSample","panelClasses","hidden","codeSample","onCloseClick","KeenViz","lastDataTimestamp","lastChartType","datavizInstance","showVisualization","sortGroups","results","dateConvertedToTimezone","KeenDataviz","showTitle","shouldComponentUpdate","nextState","componentDidUpdate","exportBtn","Chart","buildVizContent","buildViz","dataviz","chartContent","msgContent","content","actors","vizContent","Visualization","focusDisplayName","focusQueryName","handleDisplayNameFocus","handleDisplayNameBlur","handleQueryNameFocus","handleQueryNameBlur","noticeClosed","changeChartType","formatChartTypes","first","dispatcherToken","matrix","DataUtils","chartDetailBarClasses","onDisplayNameChange","onQueryNameChange","appState","EventBrowser","onKeyUp","enterKeyCode","selectEventCollection","shouldFetchCollectionSchema","selectEventCollectionClick","activeEventCollection","setActiveEventCollectionClick","setActiveEventCollection","innerText","activeView","fetchRecentEvents","modalOpened","collectionToUse","setSearchText","searchtext","buildEventCollectionNodes","re","getNavClasses","shouldShowLoader","getRecentEvents","getSchema","ordered","changeActiveView","tabName","currentEventCollection","previewData","browseContent","handleKeyUp","alertContent","getStoresState","allPersistedExplorers","activeExplorer","Explorer","toggleFields","getFieldsToggleComponents","toggleObj","hasValue","savedQueryClicked","removeSavedQueryClicked","newExplorer","activeQueryPane","setVizWrapTop","style","getSelectedIndex","findIndex","toggleQueryPane","cacheToggle","queryPane","queryPaneTabs","browseListNotice","browseEmptyContent","activeExplorerOriginal","onNameChange","QueryStringUtils","getProjectState","app","App","jan","jul","stdOffset","STEP_PARAMS","KeenSavedQueries","put","del","status","KeenExplorer","appDispatcher","KeenAnalysis","resources","fetch","querySelector","persistenceInstance","saved_query","doneFetchingSavedQuery","bool","Persistence","baseUrl","savedQueryName","createFactory","AppComponent","ReactDOM","keenGlobals","webpackKeenGlobals"],"mappings":"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CA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;;AAEA;AACA;AACA;;AAEA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA,GAAG;AACH,oBAAoB,SAAS;AAC7B;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA,KAAK;AACL;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;;;;;;AC7SA,iD;;;;;;;;;;;;;ACAA;;;;;;;AAOC,WAAW2T,OAAX,EAAqB;;AAElB;AACA,QAAK,OAAOC,MAAP,IAAiB,UAAjB,IAA+BA,OAAOC,GAA3C,EACID,OAAQ,QAAR,EAAkB,CAAC,QAAD,CAAlB,EAA8BD,OAA9B;;AAEJ;AAHA,SAIK,IAAK,8BAAOG,OAAP,MAAkB,QAAvB,EACDC,OAAOD,OAAP,GAAiBH,QAAS,mBAAAK,CAAQ,EAAR,CAAT,CAAjB;;AAEJ;AAHK,aAIA,KAAKC,MAAL,GAAcN,QAASO,MAAT,CAAd;AAER,CAbA,EAaC,UAAUC,CAAV,EAAc;;AAEhB,QAAIC,UAAUD,EAAGE,MAAH,CAAd;AACA,QAAIC,YAAYH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,cAAc;AACd;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA,SAAS,kBAAkB;AAC3B;AACA;AACA;;AAEA;AACA,aAAa,uBAAuB;AACpC;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA,iBAAiB,kBAAkB;AACnC;AACA;AACA;;AAEA;AACA,iBAAiB,YAAY;AAC7B,mEAAmE;AACnE;;AAEA;AACA;;AAEA;AACA;;AAEA,aAAa,oBAAoB;AACjC;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;;AAEH;AACA;AACA;AACA;;AAEA,cAAc,mBAAmB;AACjC;AACA;AACA;AACA;AACA,GAAG;;AAEH;AACA;AACA;AACA;AACA;AACA;;AAEA,cAAc,SAAS;AACvB;AACA;AACA;;AAEA;AACA;AACA,KAAK;AACL;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA,GAAG;;AAEH;AACA;AACA,GAAG;;AAEH;AACA;AACA;AACA,GAAG;;AAEH;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA,kCAAkC,IAAI;AACtC;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA,IAAI;AACJ;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA,aAAa,QAAQ;AACrB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA,aAAa,OAAO;AACpB;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,aAAa,oBAAoB;AACjC;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,uBAAuB;AACvB;AACA;;AAEA,aAAa,mBAAmB;AAChC;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA,aAAa,oBAAoB;AACjC;AACA,cAAc,mBAAmB;AACjC;AACA;AACA;AACA;;AAEA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA,aAAa,mBAAmB;AAChC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA,aAAa,oBAAoB;AACjC;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,8BAA8B;AAC9B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;;AAE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","file":"keen-explorer.umd.js","sourcesContent":["(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory(require(\"lodash\"), require(\"react\"), require(\"moment\"), require(\"classnames\"), require(\"keymirror\"), require(\"jQuery\"), require(\"keen-dataviz\"), require(\"string\"), require(\"qs\"), require(\"react-highlight\"), require(\"flux\"), require(\"json-stable-stringify\"), require(\"react-dom\"), require(\"keen-analysis\"));\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine([\"lodash\", \"react\", \"moment\", \"classnames\", \"keymirror\", \"jQuery\", \"keen-dataviz\", \"string\", \"qs\", \"react-highlight\", \"flux\", \"json-stable-stringify\", \"react-dom\", \"keen-analysis\"], factory);\n\telse {\n\t\tvar a = typeof exports === 'object' ? factory(require(\"lodash\"), require(\"react\"), require(\"moment\"), require(\"classnames\"), require(\"keymirror\"), require(\"jQuery\"), require(\"keen-dataviz\"), require(\"string\"), require(\"qs\"), require(\"react-highlight\"), require(\"flux\"), require(\"json-stable-stringify\"), require(\"react-dom\"), require(\"keen-analysis\")) : factory(root[\"lodash\"], root[\"react\"], root[\"moment\"], root[\"classnames\"], root[\"keymirror\"], root[\"jQuery\"], root[\"keen-dataviz\"], root[\"string\"], root[\"qs\"], root[\"react-highlight\"], root[\"flux\"], root[\"json-stable-stringify\"], root[\"react-dom\"], root[\"keen-analysis\"]);\n\t\tfor(var i in a) (typeof exports === 'object' ? exports : root)[i] = a[i];\n\t}\n})(window, function(__WEBPACK_EXTERNAL_MODULE__0__, __WEBPACK_EXTERNAL_MODULE__1__, __WEBPACK_EXTERNAL_MODULE__4__, __WEBPACK_EXTERNAL_MODULE__7__, __WEBPACK_EXTERNAL_MODULE__20__, __WEBPACK_EXTERNAL_MODULE__22__, __WEBPACK_EXTERNAL_MODULE__41__, __WEBPACK_EXTERNAL_MODULE__46__, __WEBPACK_EXTERNAL_MODULE__47__, __WEBPACK_EXTERNAL_MODULE__72__, __WEBPACK_EXTERNAL_MODULE__82__, __WEBPACK_EXTERNAL_MODULE__85__, __WEBPACK_EXTERNAL_MODULE__88__, __WEBPACK_EXTERNAL_MODULE__89__) {\nreturn "," \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 91);\n","module.exports = __WEBPACK_EXTERNAL_MODULE__0__;","module.exports = __WEBPACK_EXTERNAL_MODULE__1__;","import _ from 'lodash';\nimport S from 'string';\nimport moment from 'moment';\n\nconst ISO_DATE_FORMAT = 'YYYY-MM-DDTHH:mm:ss.SSS';\n\nfunction _isWrappedInSingleQuotes(value) {\n  return value.substring(0, 1) === \"'\" && value.substring(value.length - 1) === \"'\";\n}\n\nfunction _isWrappedInDoubleQuotes(value) {\n  return value.substring(0, 1) === '\"' && value.substring(value.length - 1) === '\"';\n}\n\nexport function toTitleCase(text) {\n    return text.replace(/\\w\\S*/g, function(txt) {\n      return txt.charAt(0).toUpperCase() + txt.substr(1).toLowerCase();\n    });\n  };\n\nexport function singularize(text) {\n    return text.replace(/s+$/, '');\n  };\n\nexport function prettyPrintJSON(json) {\n    return JSON.stringify(json, undefined, 2);\n  };\n\nexport function coercionTypeForPropertyType(type) {\n    var coercionTypeMap = {\n      'string':   'String',\n      'num':      'Number',\n      'datetime': 'Datetime',\n      'list':     'List',\n      'null':     'Null',\n      'bool':     'Boolean'\n    };\n    return coercionTypeMap[type];\n  };\n\nexport function booleanMap(value) {\n    if (value === null || value === '' ) {\n      return '';\n    } else if (value === 'false') {\n      return 'false';\n    } else if (value === 'true') {\n      return 'true';\n    } else {\n      return value ? 'true' : 'false';\n    }\n  };\n\nexport function sortItems(items, keyFunc) {\n    // using a key + mapped indices avoids repeated calls to\n    // possibly-slow key functions.\n    // keyFunc is assumed to return a unicode string.\n    keyFunc = keyFunc || function formatString(str) {\n        return str.replace(/[-_ .]/, '').toLowerCase();\n    };\n\n    var mapped = items.map(function(el, i) {\n      return { index: i, value: keyFunc(el) };\n    })\n\n    mapped.sort(function(a, b) {\n      return a.value.localeCompare(b.value);\n    });\n\n    return mapped.map(function(el){\n      return items[el.index];\n    });\n  };\n\n  /**\n   * Checks whether the given string is in a date format, as defined by:\n   * 'YYYY-MM-DDTHH:mm:ss.SSS'\n   * @return {Boolean} Whether or not the string is in the expected format.\n   */\nexport function isDateInStrictFormat(dateString) {\n    return moment(dateString, ISO_DATE_FORMAT, true).isValid();\n  };\n\nexport function convertDateToUTC(date) {\n    return new Date(date.getUTCFullYear(), date.getUTCMonth(), date.getUTCDate(), date.getUTCHours(), date.getUTCMinutes(), date.getUTCSeconds());\n  };\n\nexport function formatISOTimeNoTimezone(time) {\n    return moment(time).format('YYYY-MM-DDTHH:mm:ss.SSS');\n  };\n\nexport function generateRandomId(prefix) {\n    return (prefix || '') + (+new Date() + Math.floor(Math.random() * 999999)).toString(36);\n  };\n\nexport function generateTempId() {\n    return generateRandomId('TEMP-');\n  };\n\nexport function isValidQueryValue(value) {\n    if (_.isArray(value)) return value.length > 0;\n    if (value === false) return true;\n    if (value === 0) return true;\n    if (_.isPlainObject(value)) return !_.isEmpty(value);\n    return !isNullOrUndefined(value);\n  };\n\nexport function parseList(value) {\n    if (value) {\n      if (!isList(value)) return '';\n      var parsedList = S(value).parseCSV();\n\n      parsedList = _.map(parsedList, function(val) {\n        if (_isWrappedInSingleQuotes(val)) {\n          var quotelessVal = val.replace(\"'\", \"\");\n          if (parseFloat(quotelessVal)) {\n            val = parseFloat(quotelessVal);\n          }\n        }\n        return val;\n      });\n\n      return parsedList;\n    } else {\n      return '';\n    }\n  };\n\nexport function isList(str) {\n    var strVal = String(str);\n    var isList = true;\n    var items = strVal.match(/(\".*?\"|[^\",\\s]+)(?=\\s*,|\\s*$)/g);\n    if (items) {\n      for(var i=0; i<items.length; i++) {\n        isList = (_isWrappedInSingleQuotes(items[i].trim()) || _isWrappedInDoubleQuotes(items[i].trim()));\n        if (!isList) break;\n      }\n      return isList;\n    }\n    else {\n      return false;\n    }\n\n  };\n\nexport function isNullOrUndefined(value) {\n    return (_.isNull(value) || _.isUndefined(value));\n  };\n\nexport function padLeft(value) {\n    return value < 10 ? '0' + value : value;\n  };\n\nconst FormatUtils = {\n  toTitleCase,\n  singularize,\n  prettyPrintJSON,\n  coercionTypeForPropertyType,\n  booleanMap,\n  sortItems,\n  isDateInStrictFormat,\n  convertDateToUTC,\n  formatISOTimeNoTimezone,\n  generateRandomId,\n  generateTempId,\n  isValidQueryValue,\n  parseList,\n  isList,\n  isNullOrUndefined,\n  padLeft\n};\n\nexport default FormatUtils;\n","import _ from 'lodash';\nimport Qs from 'qs';\nimport stringify from 'json-stable-stringify';\nimport moment from 'moment';\nimport FormatUtils from './FormatUtils';\nimport FunnelUtils from './FunnelUtils';\nimport ProjectUtils from './ProjectUtils';\nimport FilterUtils from './FilterUtils';\nimport TimeframeUtils from './TimeframeUtils';\n\nconst QUERY_PARAMS = [\n  'event_collection',\n  'analysis_type',\n  'target_property',\n  'percentile',\n  'group_by',\n  'order_by',\n  'limit',\n  'timeframe',\n  'interval',\n  'timezone',\n  'filters',\n  'steps',\n  'email',\n  'latest',\n  'property_names'\n];\n\nconst EXRACTION_EVENT_LIMIT = 100;\n\nconst ANALYSIS_TYPES_WITHOUT_TARGET = [\n  'extraction',\n  'count',\n  'funnel'\n];\n\nfunction toCamelcaseName(name) {\n  return name.replace(/_(.)/, function(match, p1) {\n    return p1.toUpperCase();\n  })\n}\n\nfunction toUnderscoreName(name) {\n  return name.replace(/([A-Z])/, function(match, p1) {\n    return '_' + p1.toLowerCase();\n  })\n}\n\nvar SKIP = {}\nfunction mapSkip(collection, fn) {\n  return _.without(_.map(collection, fn), SKIP);\n}\n\nfunction echoIf(valueMaybe, append) {\n  if (valueMaybe) {\n    return append;\n  }\n  return '';\n}\n\nconst ExplorerUtils = {\n\n  EXRACTION_EVENT_LIMIT: EXRACTION_EVENT_LIMIT,\n\n  isPersisted: function(explorer) {\n    return explorer.id && !explorer.id.toString().match('TEMP');\n  },\n\n  saveType: function(explorer) {\n    return ExplorerUtils.isPersisted(explorer) ? 'update' : 'save';\n  },\n\n  shouldHaveTarget: function(explorer) {\n    return !FormatUtils.isNullOrUndefined(explorer.query.analysis_type) && ANALYSIS_TYPES_WITHOUT_TARGET.indexOf(explorer.query.analysis_type) === -1;\n  },\n\n  isEmailExtraction: function(explorer) {\n    return (explorer.query.analysis_type === 'extraction' && !_.isNull(explorer.query.email));\n  },\n\n  isImmediateExtraction: function(explorer) {\n    return (explorer.query.analysis_type === 'extraction' && _.isNull(explorer.query.email));\n  },\n\n  mergeResponseWithExplorer: function(explorer, response) {\n    var newModel = _.defaultsDeep(ExplorerUtils.formatQueryParams(response), explorer);\n    delete newModel.originalModel; // Remove the original model.\n    newModel.id = response.query_name; // Set the ID to the query_name (it's now persisted.)\n    newModel.originalModel = _.cloneDeep(newModel);\n    return newModel;\n  },\n\n  queryJSON: function(explorer) {\n    if (!explorer || !explorer.query) return;\n    var params = _.cloneDeep(explorer.query);\n\n    if (params.analysis_type === 'extraction') {\n      if (FormatUtils.isNullOrUndefined(params.email)) {\n        params.latest = EXRACTION_EVENT_LIMIT;\n      }\n    } else {\n      delete params.latest;\n      delete params.email;\n      delete params.property_names;\n    }\n\n    if (params.analysis_type !== 'funnel') {\n      _.assign(params, TimeframeUtils.getTimeParameters(params.time, params.timezone));\n    }\n\n    // Add filters\n    if (params.filters) {\n      params.filters = _.map(params.filters, function(filter){\n        return FilterUtils.queryJSON(filter);\n      });\n    }\n\n    if (params.steps) {\n      params.steps = _.map(params.steps, FunnelUtils.stepJSON);\n    }\n\n    _.each(params, function(value, key) {\n      // If it's an array, clean out any empty elements\n      if (_.isArray(value)) {\n        _.remove(value, function(element) {\n          return !_.isNumber(element) && _.isEmpty(element);\n        });\n      }\n\n      // Remove any empty properties or ones that shouldn't be\n      // part of the query request.\n      if (!FormatUtils.isValidQueryValue(value) || !_.includes(QUERY_PARAMS, key)) {\n        delete params[key];\n      }\n    });\n\n    return params;\n  },\n\n  toJSON: function(explorer) {\n    var json = _.pick(explorer, [\n      'id',\n      'query_name',\n      'refresh_rate',\n      'metadata'\n    ]);\n    json.query = ExplorerUtils.queryJSON(explorer);\n    if (json.query.analysis_type === 'extraction') json.refresh_rate = 0;\n    return json;\n  },\n\n  cleanJSONforSave: function(explorer) {\n    if (explorer.query.analysis_type === 'extraction') {\n      explorer.query.latest = EXRACTION_EVENT_LIMIT;\n      delete explorer.query.email;\n      delete explorer.query.property_names;\n    }\n    return explorer;\n  },\n\n  paramsForURL: function(explorer) {\n    var attrs = ExplorerUtils.toJSON(explorer);\n    return _.omit(attrs, [\n      'id',\n      'query_name',\n      'refresh_rate',\n      'metadata'\n    ]);\n  },\n\n  /**\n   * Execures a Keen.js query with the provided client and query params, calling the\n   * callbacks after execution.\n   * @param {Object} config The runQuery configuration\n   * Expected structure:\n   * {\n   *   client:   {The Keen.js client},\n   *   query:    {The object with the query parameters},\n   *   success:  {Success callback function},\n   *   error:    {Error callback function},\n   *   complete: {Complete callback function}\n   * }\n   * @return {undefined}\n   */\n  runQuery: function(config) {\n    config.client\n      .query(config.query.analysis_type, _.omit(config.query, 'analysis_type'))\n      .then(function(res, err){\n        if (err) {\n          config.error(err);\n        }\n        else {\n          config.success(res);\n        }\n        if (config.complete) config.complete(err, res);\n      })\n      .catch(config.error);\n  },\n\n  /**\n   * Takes in an object of query params directly taken from the URL and formats/deconstructs them appropriately to work well\n   * with our data model.\n   * @param  {Object} the raw params from the URL\n   * @return {Object} formatted attributes to be used for creating a new Explorer model.\n   */\n  formatQueryParams: function(params) {\n    if (!params || !params.query) return;\n    if (params.query && params.query.timeframe) {\n      var unpackedTime = TimeframeUtils.unpackTimeframeParam(params.query.timeframe, params.query.timezone);\n      params.query.time = unpackedTime.time;\n      params.query.timezone = unpackedTime.timezone;\n    }\n    if (params.query.group_by && !_.isArray(params.query.group_by)) {\n      params.query.group_by = [params.query.group_by];\n    }\n    if (params.query.filters) {\n      params.query.filters = _.compact(_.map(params.query.filters, FilterUtils.formatFilterParams));\n    }\n    if (params.query.steps) {\n      params.query.steps = _.compact(_.map(params.query.steps, FunnelUtils.formatQueryParams));\n      params.query.steps[params.query.steps.length - 1].active = true\n    }\n    if (!params.id && params.query_name) params.id = params.query_name;\n\n    if (!params.metadata) {\n      params.metadata = {};\n    }\n\n    if (!params.metadata.display_name) params.metadata.display_name = params.query_name;\n    if (!params.metadata.visualization || !params.metadata.visualization.chart_type) {\n      params.metadata.visualization = {};\n      if (params.query.interval) {\n        params.metadata.visualization.chart_type = \"area\";\n      } else {\n        params.metadata.visualization.chart_type = \"metric\";\n      }\n    }\n    return params;\n  },\n\n  encodeAttribute: function(attr) {\n    return encodeURIComponent(JSON.stringify(attr));\n  },\n\n  getApiQueryUrl: function(client, explorer) {\n    var attrs = ExplorerUtils.queryJSON(explorer);\n    var url = client.url('queries', attrs.analysis_type);\n\n    var analysisType = attrs.analysis_type;\n    delete attrs.analysis_type;\n\n    var timeframe = _.cloneDeep(attrs.timeframe);\n    delete attrs.timeframe;\n\n    var filters = _.map(attrs.filters, function(filter) {\n      return _.omit(_.cloneDeep(filter), 'coercion_type');\n    });\n    delete attrs.filters;\n\n    var steps;\n    if (attrs.steps && attrs.steps.length) {\n      steps = ExplorerUtils.encodeAttribute(attrs.steps);\n      delete attrs.steps;\n    }\n\n    if (attrs.group_by && _.isArray(attrs.group_by) && attrs.group_by.length) {\n      attrs.group_by = (attrs.group_by.length > 1) ? JSON.stringify(attrs.group_by) : attrs.group_by[0];\n    }\n\n    var queryAttrs = Qs.stringify(attrs);\n\n    if (timeframe && TimeframeUtils.timeframeType(explorer.query.time) === 'relative') {\n      queryAttrs += '&timeframe='+ timeframe;\n    }\n    else if (timeframe && TimeframeUtils.timeframeType(explorer.query.time) === 'absolute') {\n      // This is an absolute timeframe, so we need to encode the object in a specific way before sending it, as per keen docs => https://keen.io/docs/data-analysis/timeframe/#absolute-timeframes\n      timeframe = ExplorerUtils.encodeAttribute(timeframe);\n      queryAttrs += '&timeframe='+ timeframe;\n    }\n\n    // We need to encode the filters the same way as we encode the absolute timeframe.\n    if (filters) {\n      filters = ExplorerUtils.encodeAttribute(filters);\n      queryAttrs += '&filters='+ filters;\n    }\n\n    if (steps) {\n      queryAttrs += '&steps=' + steps;\n    }\n\n    var authKey = client.masterKey() || client.readKey();\n\n    url += '?api_key=' + authKey + '&' + queryAttrs;\n    return url;\n  },\n\n  resultCanBeVisualized: function(explorer) {\n    return (explorer.response && !FormatUtils.isNullOrUndefined(explorer.response.result) && (_.isNumber(explorer.response.result) || (_.isArray(explorer.response.result) && explorer.response.result.length)));\n  },\n\n  isJSONViz: function(explorer) {\n    return explorer.metadata.visualization.chart_type && explorer.metadata.visualization.chart_type.toLowerCase() === 'json';\n  },\n\n  isTableViz: function(explorer) {\n    return explorer.metadata.visualization.chart_type && explorer.metadata.visualization.chart_type.toLowerCase() === 'table';\n  },\n\n  getSdkExample: function(explorer, client, explorerConfig) {\n    var defaultKeenAnalysisOpts = {\n          host: 'api.keen.io',\n          protocol: 'https',\n          requestType: 'jsonp'\n        },\n        params = ExplorerUtils.queryJSON(explorer),\n        s = stringify,\n        dynamicCriteria,\n        paramNames,\n        dynamicConstructorNames = [\n          'host', 'protocol', 'requestType'\n        ],\n        funnelRootParams = [\n          'event_collection', 'steps'\n        ],\n        dynamicConstructorValues;\n\n    var chartTitle = 'Untitled Chart';\n    if (explorer.metadata && explorer.metadata.display_name) {\n      chartTitle = explorer.metadata.display_name;\n    }\n\n    var chartType = '';\n    if (explorer.metadata && explorer.metadata.visualization\n        && explorer.metadata.visualization.chart_type\n          && explorer.metadata.visualization.chart_type !== 'JSON') {\n            chartType = explorer.metadata.visualization.chart_type;\n    }\n\n    switch(params.analysis_type) {\n      case 'funnel':\n        paramNames = ['steps'];\n        break;\n\n      default:\n        paramNames = ['event_collection', 'filters', 'group_by', 'interval', 'target_property', 'percentile', 'timeframe', 'timezone'];\n        break;\n    }\n\n    if(params.steps) {\n      params.steps = _.map(params.steps, function(step) { return _.omit(step, 'active'); });\n    }\n\n    dynamicConstructorValues = mapSkip(dynamicConstructorNames, function(name) {\n      if (client.config[name] == defaultKeenAnalysisOpts[name]) {\n        return SKIP\n      }\n      return '      ' + name + ': ' + s(client.config[name])\n    }).join(',\\n');\n    // remove coercion from example; it's already been handled elsewhere.\n    _.each(params['filters'], function(filter) { delete filter['coercion_type'] })\n\n    dynamicCriteria = mapSkip(paramNames, function(param) {\n      if (!params[param]) {\n        return SKIP\n      }\n      return '      ' + param + ': ' + s(params[param], { space: 0 })\n    }).join(',\\n');\n\n    let queryOptions = `analysis_type: '${params.analysis_type}',\n      ${dynamicCriteria}`;\n\n    if (explorer.query_name) {\n      queryOptions = `saved_query_name: '${explorer.query_name}'`;\n    }\n\n    const datavizConfig = explorerConfig && explorerConfig.keenDatavizOptions;\n    let datavizOptionsString = '';\n    if (datavizConfig) {\n      Object.keys(datavizConfig).forEach(key => {\n        if (!key) return;\n        datavizOptionsString += `,\n          ${key}: ${JSON.stringify(datavizConfig[key])}`;\n      });\n    }\n\n    const analysisConfig = explorerConfig && explorerConfig.keenAnalysisOptions;\n    let analysisOptionsString = `projectId: '${client.config.projectId}',\n    readKey: ${client.config.readKey ? `'${client.config.readKey}'` : undefined},\n    masterKey: ${client.config.masterKey ? `'${client.config.masterKey}'` : undefined}`;\n    if (analysisConfig) {\n      analysisOptionsString = '';\n      let newline = '  ';\n      Object.keys(analysisConfig).forEach(key => {\n        if (!key) return;\n        if (analysisOptionsString) {\n          newline = `,\n            `;\n        }\n        analysisOptionsString += `${newline}${key}: ${JSON.stringify(analysisConfig[key])}`;\n      });\n    }\n\n    var value =\n      `<!DOCTYPE html>\n      <html>\n      <head>\n      <meta charset=\"utf-8\">\n      <script crossorigin src=\"https://cdn.jsdelivr.net/npm/keen-analysis@3.0\"></script>\n      <link href=\"https://cdn.jsdelivr.net/npm/keen-dataviz@3.0/dist/keen-dataviz.min.css\" rel=\"stylesheet\" />\n      <script crossorigin src=\"https://cdn.jsdelivr.net/npm/keen-dataviz@3.0/dist/keen-dataviz.min.js\"></script>\n      </head>\n      <body>\n\n      <style>\n      #keen-example-chart{\n        width: 100%;\n        height: 400px;\n      }\n      </style>\n\n      <!-- Target DOM Node -->\n      <div id=\"keen-example-chart\"></div>\n\n      <script type=\"text/javascript\">\n        const client = new KeenAnalysis({\n          ${\n            analysisOptionsString\n          }\n        });\n        const chart = new KeenDataviz({\n          container: '#keen-example-chart',\n          type: ${chartType ? `'${chartType}'` : undefined},\n          title: ${chartTitle ? `'${chartTitle}'` : undefined}${\n            datavizOptionsString\n          }\n        });\n        client.query({\n          ${queryOptions}\n        })\n        .then((res) => {\n          chart.render(res);\n        })\n        .catch((err) => {\n          chart.message(err.message);\n        });\n        </script>\n  </body>\n</html>`;\n    return value;\n  },\n\n  slugify: function(name) {\n    return name.toLowerCase().replace(/[^\\w\\s-]/g, '').replace(/ /g, '-');\n  }\n\n};\n\nexport default ExplorerUtils;\n","module.exports = __WEBPACK_EXTERNAL_MODULE__4__;","import _ from 'lodash';\nimport AppDispatcher from '../dispatcher/AppDispatcher';\nimport ExplorerConstants from '../constants/ExplorerConstants';\nimport ExplorerStore from '../stores/ExplorerStore';\nimport ExplorerValidations from '../validations/ExplorerValidations';\nimport NoticeActions from './NoticeActions';\nimport AppStateActions from './AppStateActions';\nimport ProjectActions from './ProjectActions';\nimport ProjectStore from '../stores/ProjectStore';\nimport RunValidations from '../utils/RunValidations';\nimport ExplorerUtils from '../utils/ExplorerUtils';\nimport ChartTypeUtils from '../utils/ChartTypeUtils';\n\nconst ExplorerActions = {\n\n  create: function(attrs) {\n    AppDispatcher.dispatch({\n      actionType: ExplorerConstants.EXPLORER_CREATE,\n      attrs: attrs\n    });\n  },\n\n  createBatch: function(models) {\n    AppDispatcher.dispatch({\n      actionType: ExplorerConstants.EXPLORER_CREATE_BATCH,\n      models: models\n    });\n  },\n\n  clone: function(sourceId) {\n    AppDispatcher.dispatch({\n      actionType: ExplorerConstants.EXPLORER_CLONE,\n      id: sourceId\n    });\n    NoticeActions.create({\n      text: \"Query cloned! Add a name for this cloned query and save it.\",\n      type: 'success',\n      icon: 'check'\n    });\n  },\n\n  update: function(id, updates) {\n    var updated_query, project = ProjectStore.getProject();\n    AppDispatcher.dispatch({\n      actionType: ExplorerConstants.EXPLORER_UPDATE,\n      id: id,\n      updates: updates\n    });\n    // Fetch schema for selected event collection\n    updated_query = updates.query ? updates.query : updates.response && updates.response.query ? updates.response.query : {};\n    if (updated_query.event_collection) {\n      ProjectActions.fetchCollectionSchema(project.client, updated_query.event_collection);\n    }\n    if (updated_query.steps && updated_query.steps.length) {\n      _.each(updated_query.steps, function(step, i) {\n        ProjectActions.fetchCollectionSchema(project.client, step.event_collection);\n      });\n    }\n  },\n\n  remove: function(id) {\n    AppDispatcher.dispatch({\n      actionType: ExplorerConstants.EXPLORER_REMOVE,\n      id: id\n    });\n  },\n\n  setActive: function(id) {\n    AppDispatcher.dispatch({\n      actionType: ExplorerConstants.EXPLORER_SET_ACTIVE,\n      id: id\n    });\n  },\n\n  revertActiveChanges: function() {\n    AppDispatcher.dispatch({\n      actionType: ExplorerConstants.EXPLORER_REVERT_ACTIVE_CHANGES\n    });\n  },\n\n  clear: function(id) {\n    AppDispatcher.dispatch({\n      actionType: ExplorerConstants.EXPLORER_CLEAR,\n      id: id\n    });\n  },\n\n  validate: function(id) {\n    AppDispatcher.dispatch({\n      actionType: ExplorerConstants.EXPLORER_VALIDATE,\n      id: id\n    });\n  },\n\n  addFilter: function(id, attrs) {\n    AppDispatcher.dispatch({\n      actionType: ExplorerConstants.EXPLORER_ADD_FILTER,\n      id: id,\n      attrs: attrs\n    });\n  },\n\n  removeFilter: function(id, index) {\n    AppDispatcher.dispatch({\n      actionType: ExplorerConstants.EXPLORER_REMOVE_FILTER,\n      id: id,\n      index: index\n    });\n  },\n\n  updateFilter: function(id, index, attrs) {\n    AppDispatcher.dispatch({\n      actionType: ExplorerConstants.EXPLORER_UPDATE_FILTER,\n      id: id,\n      index: index,\n      attrs: attrs\n    });\n  },\n\n  addStep: function(id, attrs) {\n    AppDispatcher.dispatch({\n      actionType: ExplorerConstants.EXPLORER_ADD_STEP,\n      id: id,\n      attrs: attrs\n    });\n  },\n\n  removeStep: function(id, index) {\n    AppDispatcher.dispatch({\n      actionType: ExplorerConstants.EXPLORER_REMOVE_STEP,\n      id: id,\n      index: index\n    });\n  },\n\n  setStepActive: function(id, index) {\n    AppDispatcher.dispatch({\n      actionType: ExplorerConstants.EXPLORER_SET_STEP_ACTIVE,\n      id: id,\n      index: index\n    });\n  },\n\n  updateStep: function(id, index, attrs) {\n    var project = ProjectStore.getProject();\n    AppDispatcher.dispatch({\n      actionType: ExplorerConstants.EXPLORER_UPDATE_STEP,\n      id: id,\n      index: index,\n      attrs: attrs\n    });\n\n    // Fetch schema for selected event collection\n    if (attrs.event_collection) {\n      ProjectActions.fetchCollectionSchema(project.client, attrs.event_collection);\n    }\n  },\n\n  moveStep: function(id, index, direction) {\n    AppDispatcher.dispatch({\n      actionType: ExplorerConstants.EXPLORER_MOVE_STEP,\n      id: id,\n      index: index,\n      direction: direction\n    });\n  },\n\n  addStepFilter: function(id, stepIndex, attrs) {\n    AppDispatcher.dispatch({\n      actionType: ExplorerConstants.EXPLORER_ADD_STEP_FILTER,\n      id: id,\n      stepIndex: stepIndex,\n      attrs: attrs\n    });\n  },\n\n  removeStepFilter: function(id, stepIndex, filterIndex) {\n    AppDispatcher.dispatch({\n      actionType: ExplorerConstants.EXPLORER_REMOVE_STEP_FILTER,\n      id: id,\n      stepIndex: stepIndex,\n      filterIndex: filterIndex\n    });\n  },\n\n  updateStepFilter: function(id, stepIndex, filterIndex, attrs) {\n    AppDispatcher.dispatch({\n      actionType: ExplorerConstants.EXPLORER_UPDATE_STEP_FILTER,\n      id: id,\n      stepIndex: stepIndex,\n      filterIndex: filterIndex,\n      attrs: attrs\n    });\n  },\n\n  exec: function(client, id) {\n    var explorer = ExplorerStore.get(id);\n    if (explorer.loading) {\n      throw new Error(\"Warning: calling exec when model loading is true. Explorer id: \" + explorer.id);\n    }\n    ExplorerActions.validate(explorer.id);\n    explorer = ExplorerStore.get(id);\n    if (!explorer.isValid) {\n      AppDispatcher.dispatch({\n        actionType: ExplorerConstants.EXPLORER_FOUND_INVALID,\n        id: explorer.id\n      });\n      return;\n    }\n    NoticeActions.clearAll();\n\n    AppDispatcher.dispatch({\n      actionType: ExplorerConstants.EXPLORER_UPDATE,\n      id: explorer.id,\n      updates: { loading: true }\n    });\n\n    ExplorerUtils.runQuery({\n      client: client,\n      query: ExplorerUtils.queryJSON(explorer),\n      error: ExplorerActions.execError.bind(this, explorer),\n      success: ExplorerActions.execSuccess.bind(this, explorer)\n    });\n  },\n\n  execError: function(explorer, err) {\n    if(!err.message && err.body) {\n      err.message = err.body;\n    }\n    AppDispatcher.dispatch({\n      actionType: ExplorerConstants.EXPLORER_QUERY_ERROR,\n      query: explorer.query,\n      error: err.message\n    });\n    ExplorerActions.update(explorer.id, { loading: false });\n    NoticeActions.create({ text: err.message, type: 'error' });\n  },\n\n  execSuccess: function (explorer, response) {\n    AppDispatcher.dispatch({\n      actionType: ExplorerConstants.EXPLORER_QUERY_SUCCESS,\n      query: explorer.query,\n      isSaved: ExplorerUtils.isPersisted(explorer)\n    });\n    NoticeActions.clearAll();\n\n    var updates = {};\n    updates.response = response;\n    // If there is no query object on the response, add one. This is required for Dataviz to properly auto-parse\n    // the result + the query to correctly choose a chart type.\n    if (!response.query) response.query = ExplorerUtils.queryJSON(explorer);\n    updates.loading = false;\n\n    if (!ChartTypeUtils.responseSupportsChartType(response.query, explorer.metadata.visualization.chart_type)) {\n      updates.metadata = _.cloneDeep(explorer.metadata);\n      updates.metadata.visualization.chart_type = ChartTypeUtils.getChartTypeOptions(response.query)[0];\n    }\n\n    updates.dataTimestamp = Date.now();\n    ExplorerActions.update(explorer.id, updates);\n  },\n\n  runEmailExtraction: function(client, id) {\n    ExplorerActions.validate(id);\n    var explorer = ExplorerStore.get(id);\n\n    if (!explorer.isValid) {\n      AppDispatcher.dispatch({\n        actionType: ExplorerConstants.EXPLORER_FOUND_INVALID,\n        id: explorer.id\n      });\n      return;\n    }\n    NoticeActions.clearAll();\n\n    AppDispatcher.dispatch({\n      actionType: ExplorerConstants.EXPLORER_UPDATE,\n      id: explorer.id,\n      updates: { loading: true }\n    });\n\n    ExplorerUtils.runQuery({\n      client: client,\n      query: ExplorerUtils.queryJSON(explorer),\n      success: ExplorerActions.runEmailExtractionSuccess.bind(this, explorer),\n      error: ExplorerActions.runEmailExtractionError,\n    });\n  },\n\n  runEmailExtractionSuccess: function(explorer, res) {\n    AppDispatcher.dispatch({\n      actionType: ExplorerConstants.EXPLORER_QUERY_SUCCESS,\n      query: explorer.query,\n      isSaved: ExplorerUtils.isPersisted(explorer)\n    });\n    NoticeActions.clearAll();\n    NoticeActions.create({\n      text: \"Email extraction successfully requested. Check your email (\"+explorer.query.email+\").\",\n      type: 'success',\n      icon: 'check'\n    });\n    ExplorerActions.update(explorer.id, {\n      result: res,\n      loading: false\n    });\n  },\n\n  runEmailExtractionError: function(err) {\n    NoticeActions.create({ text: err.message, type: 'error', icon: 'remove-sign' });\n  },\n\n  fetchAllPersisted: function(persistence, callback) {\n    AppStateActions.update({ fetchingPersistedExplorers: true });\n    persistence.get(null, function(err, resp) {\n      if (err) {\n        callback(err);\n        return;\n      }\n      var models = [];\n      resp.forEach(function(model) {\n        var formattedModel = ExplorerUtils.formatQueryParams(model);\n        RunValidations.run(ExplorerValidations, formattedModel);\n        if (!formattedModel.isValid) {\n          console.warn('A persisted explorer model is invalid: ', formattedModel);\n          console.log('Errors: ', formattedModel.errors);\n        }\n        models.push(formattedModel);\n      });\n      ExplorerActions.createBatch(models);\n      AppStateActions.update({ fetchingPersistedExplorers: false });\n      callback(null);\n    });\n  },\n\n  fetchPersisted: function(persistence, id, callback) {\n    persistence.get(id, function(err, resp) {\n      if (err) {\n        callback(err);\n        return;\n      }\n      var model = ExplorerUtils.formatQueryParams(resp);\n      RunValidations.run(ExplorerValidations, model);\n      if (!model.isValid) {\n        console.warn('A persisted explorer model is invalid: ', model);\n      }\n      ExplorerActions.create(model);\n      callback(null);\n    });\n  },\n\n  save: function(persistence, sourceId) {\n    var saveType = ExplorerUtils.saveType(ExplorerStore.get(sourceId));\n    var persistenceFunction = saveType === 'save' ? 'create' : 'update';\n    AppDispatcher.dispatch({\n      actionType: ExplorerConstants.EXPLORER_SAVING,\n      id: sourceId,\n      saveType: saveType\n    });\n\n    var explorer = ExplorerStore.get(sourceId);\n    if (!explorer.isValid) {\n      AppDispatcher.dispatch({\n        actionType: ExplorerConstants.EXPLORER_FOUND_INVALID,\n        id: explorer.id\n      });\n      ExplorerActions.update(sourceId, { saving: false });\n      return;\n    }\n    NoticeActions.clearAll();\n\n    var explorerJSON = ExplorerUtils.cleanJSONforSave(\n      ExplorerUtils.toJSON(ExplorerStore.get(sourceId))\n    );\n    persistence[persistenceFunction](explorerJSON, function(err, res) {\n      if (err) {\n        AppDispatcher.dispatch({\n          actionType: ExplorerConstants.EXPLORER_SAVE_FAIL,\n          saveType: saveType,\n          id: sourceId,\n          errorResp: err,\n          query: ExplorerStore.get(sourceId).query\n        });\n        return;\n      }\n      ExplorerActions.saveSuccess(sourceId, res);\n    });\n  },\n\n  saveSuccess: function(sourceId, res) {\n    var saveType = ExplorerUtils.saveType(ExplorerStore.get(sourceId));\n    var updatedModel = ExplorerUtils.mergeResponseWithExplorer(ExplorerStore.get(sourceId), res);\n    AppDispatcher.dispatch({\n      actionType: ExplorerConstants.EXPLORER_UPDATE,\n      id: sourceId,\n      updates: updatedModel\n    });\n    // We need to use the new model id below, not the old sourceId passed in.\n    AppDispatcher.dispatch({\n      actionType: ExplorerConstants.EXPLORER_SAVE_SUCCESS,\n      id: updatedModel.id,\n      saveType: saveType,\n      query: updatedModel.query\n    });\n  },\n\n  destroy: function(persistence, sourceId) {\n    AppDispatcher.dispatch({\n      actionType: ExplorerConstants.EXPLORER_DESTROYING\n    });\n    var attrs = _.clone(ExplorerUtils.toJSON(ExplorerStore.get(sourceId)));\n    persistence.destroy(attrs, function(err, res) {\n      if (err) {\n        AppDispatcher.dispatch({\n          actionType: ExplorerConstants.EXPLORER_DESTROY_FAIL,\n          errorMsg: err,\n          query: ExplorerStore.get(sourceId).query\n        });\n      } else {\n        AppDispatcher.dispatch({\n          actionType: ExplorerConstants.EXPLORER_REMOVE,\n          id: sourceId\n        });\n        AppDispatcher.dispatch({\n          actionType: ExplorerConstants.EXPLORER_DESTROY_SUCCESS,\n          query: attrs.query\n        });\n      }\n    });\n  }\n\n};\n\nexport default ExplorerActions;\n","import _ from 'lodash';\nimport DateUtils from './DateUtils';\nimport FormatUtils from './FormatUtils.js';\n\n// ***********************\n// ** Project Constants\n// ***********************\n\nconst CONSTANTS = {\n\n  DEFAULT_TIMEZONE: 'UTC',\n\n  ANALYSIS_TYPES: [\n    'sum',\n    'count',\n    'count_unique',\n    'minimum',\n    'maximum',\n    'average',\n    'select_unique',\n    'extraction',\n    'percentile',\n    'median',\n    'funnel'\n  ],\n\n  ABSOLUTE_INTERVAL_TYPES: [\n    { name: 'minutely', value: 'minutely' },\n    { name: 'hourly',   value: 'hourly' },\n    { name: 'daily',    value: 'daily' },\n    { name: 'weekly',   value: 'weekly' },\n    { name: 'monthly',  value: 'monthly' },\n    { name: 'yearly',   value: 'yearly' }\n  ],\n\n  RELATIVE_INTERVAL_TYPES: [\n    { name: 'minutes',  value: 'minutes' },\n    { name: 'hours',    value: 'hours' },\n    { name: 'days',     value: 'days' },\n    { name: 'weeks',    value: 'weeks' },\n    { name: 'months',   value: 'months' },\n    { name: 'years',    value: 'years' }\n  ],\n\n  TIMEZONES: [\n    {\n      name: 'UTC',\n      offset: 0,\n      dst_offset: 0\n    },\n    {\n      name: 'Europe/London',\n      offset: 0,\n      dst_offset: 3600\n    },\n    {\n      name: 'Africa/Casablanca',\n      offset: 0,\n      dst_offset: 0\n    },\n    {\n      name: 'Africa/Nairobi',\n      offset: 10800,\n      dst_offset: 0\n    },\n    {\n      name: 'Asia/Dubai',\n      offset: 14400,\n      dst_offset: 0\n    },\n    {\n      name: 'America/Sao_Paulo',\n      offset: -10800,\n      dst_offset: -7200\n    },\n    {\n      name: 'US/Eastern',\n      offset: -18000,\n      dst_offset: -14400\n    },\n    {\n      name: 'US/Central',\n      offset: -21600,\n      dst_offset: -18000\n    },\n    {\n      name: 'US/Mountain',\n      offset: -25200,\n      dst_offset: -21600\n    },\n    {\n      name: 'US/Pacific',\n      offset: -28800,\n      dst_offset: -25200\n    },\n    {\n      name: 'US/Alaska',\n      offset: -32400,\n      dst_offset: -28800\n    },\n    {\n      name: 'US/Hawaii',\n      offset: -36000,\n      dst_offset: -32400\n    },\n    {\n      name: 'Europe/Paris',\n      offset: 3600,\n      dst_offset: 7200\n    },\n    {\n      name: 'Europe/Amsterdam',\n      offset: 3600,\n      dst_offset: 7200\n    },\n    {\n      name: 'Europe/Stockholm',\n      offset: 3600,\n      dst_offset: 7200\n    },\n    {\n      name: 'Europe/Prague',\n      offset: 3600,\n      dst_offset: 7200\n    },\n    {\n      name: 'Asia/Istanbul',\n      offset: 7200,\n      dst_offset: 10800\n    },\n    {\n      name: 'Europe/Istanbul',\n      offset: 7200,\n      dst_offset: 10800\n    },\n    {\n      name: 'Europe/Copenhagen',\n      offset: 3600,\n      dst_offset: 7200\n    },\n    {\n      name: 'Asia/Jakarta',\n      offset: 25200,\n      dst_offset: 25200\n    },\n    {\n      name: 'Asia/Singapore',\n      offset: 28800,\n      dst_offset: 28800\n    },\n    {\n      name: 'Australia/Perth',\n      offset: 28800,\n      dst_offset: 28800\n    },\n    {\n      name: 'Asia/Tokyo',\n      offset: 32400,\n      dst_offset: 32400\n    },\n    {\n      name: 'Australia/Sydney',\n      offset: 36000,\n      dst_offset: 39600\n    },\n    {\n      name: 'Pacific/Auckland',\n      offset: 43200,\n      dst_offset: 46800\n    }\n  ],\n\n  FILTER_OPERATORS: [\n    { name: '\\u003D Equal to',\n      value: 'eq',\n      canBeCoeredTo: ['String', 'Number', 'Null', 'List', 'Boolean', 'Datetime']\n    },\n    { name: '\\u2260 Not equal to',\n      value: 'ne',\n      canBeCoeredTo: ['String', 'Number', 'Null', 'List', 'Boolean', 'Datetime']\n    },\n    { name: '\\u003E Greater than',\n      value: 'gt',\n      canBeCoeredTo: ['Number', 'Null', 'Datetime', 'String']\n    },\n    { name: '\\u2265 Greater than or equal to',\n      value: 'gte',\n      canBeCoeredTo: ['Number', 'Null', 'Datetime', 'String']\n    },\n    { name: '\\u003C Less than',\n      value: 'lt',\n      canBeCoeredTo: ['Number', 'Null', 'Datetime', 'String']\n    },\n    { name: '\\u2264 Less than or equal to',\n      value: 'lte',\n      canBeCoeredTo: ['Number', 'Null', 'Datetime', 'String']\n    },\n    { name: '\\u2203 Property exists',\n      value: 'exists',\n      canBeCoeredTo: ['Boolean']\n    },\n    { name: '\\u229A String contains',\n      value: 'contains',\n      canBeCoeredTo: ['String', 'Null']\n    },\n    { name: '\\u2349 String does not contain',\n      value: 'not_contains',\n      canBeCoeredTo: ['String', 'Null']\n    },\n    { name: '\\u29C7 Matches any value in a list',\n      value: 'in',\n      canBeCoeredTo: ['List']\n    },\n    { name: '\\u2690 Within a given radius (geo)',\n      value: 'within',\n      canBeCoeredTo: ['Geo']\n    }\n  ]\n};\n\nconst projectUtils = {\n\n  getConstant: function(name) {\n    return CONSTANTS[name];\n  },\n\n  eventsUrl: function(client) {\n    return client.url('events', {\n      api_key: client.config.masterKey\n    });\n  },\n\n  getEventCollectionPropertyNames: function(project, collection) {\n    return project.schema[collection] ? project.schema[collection].sortedProperties : [];\n  },\n\n  getPropertyType: function(project, collection, propertyName) {\n    var collection = project.schema[collection];\n    return collection ? collection.properties[propertyName] : null;\n  },\n\n  /*\n    Returns the local timezone offset in seconds offset from UTC.\n    This is how the Keen API wants the offset to look. This is also\n    opposite in negative/positive numbers from how Javascript\n    handles it.\n   */\n  getLocalTimezoneOffset: function(date){\n    return (new Date().getTimezoneOffset() * -1) * 60;\n  },\n\n  getLocalTimezone: function(date){\n    var isDST = DateUtils.isDST();\n    var localOffset = projectUtils.getLocalTimezoneOffset();\n    var zones = CONSTANTS.TIMEZONES.filter((zone) => {\n      if (isDST) {\n        return zone.dst_offset === localOffset;\n      } else {\n        return zone.offset === localOffset;\n      }\n    });\n    if (!zones.length) return localOffset;\n    return zones[0].name;\n  },\n\n};\n\nexport default projectUtils;\n","module.exports = __WEBPACK_EXTERNAL_MODULE__7__;","import { Dispatcher } from 'flux';\n\nexport default new Dispatcher();\n","import _ from 'lodash';\nimport moment from 'moment';\nimport S from 'string';\nimport TimeframeUtils from './TimeframeUtils';\nimport FormatUtils from './FormatUtils';\nimport FilterValidations from '../validations/FilterValidations';\nimport RunValidations from './RunValidations';\n\nfunction exists(value) {\n  return !_.isNull(value) && !_.isUndefined(value);\n}\n\nfunction toType(obj) {\n  return ({}).toString.call(obj).match(/\\s([a-zA-Z]+)/)[1].toLowerCase();\n}\n\nfunction isNumeric(num) {\n  return !isNaN(num);\n}\n\nconst filterUtils = {\n\n  coercionFunctions: {\n\n    'Datetime': function(filter) {\n      if (typeof filter.property_value === 'string') {\n        var coercedDate = new Date(filter.property_value);\n        if (coercedDate !== null && coercedDate.toString() !== 'Invalid Date') return coercedDate.toString();\n      }\n      return filterUtils.defaultDate();\n    },\n\n    'String': function(filter) {\n      if (!exists(filter.property_value)) return null;\n      return filter.property_value.toString();\n    },\n\n    'Number': function(filter) {\n      if (!exists(filter.property_value)) return null;\n      var newVal = parseFloat(filter.property_value);\n      if (typeof newVal === 'undefined' || newVal === null || isNaN(newVal)) {\n        newVal = '';\n      }\n      return newVal;\n    },\n\n    'Boolean': function(filter) {\n      var isFalse = filter.property_value === 'false' || filter.property_value === false;\n      return isFalse ? false : true;\n    },\n\n    'Null': function(filter) {\n      return null;\n    },\n\n    'Geo': function(filter) {\n      return filter.property_value;\n    },\n\n    'List': function(filter) {\n      return filter.property_value;\n    }\n\n  },\n\n  defaultDate: function() {\n    var yesterday = moment().subtract(1, 'days').startOf('day').format('x');\n    return new Date(Number(yesterday));\n  },\n\n  getCoercedValue: function(filter) {\n    if (!filterUtils.coercionFunctions[filter.coercion_type]) return null;\n    return filterUtils.coercionFunctions[filter.coercion_type](filter);\n  },\n\n  /**\n   * Gets the type for the given filter's property_value. This value should be raw, as in it should not have\n   * been put through getCoercedValue yet. So for example, if it's a list type, it should be a string with the\n   * expected list format: \"\\a word\\\"\", '1', '56', \\\"\"another word\\\"\"\n   * @param  {Object} filter The filter to get the property value coercion type for.\n   * @return {String}        The determined type for the given property value.\n   */\n  getCoercionType: function(filter) {\n    switch (toType(filter.property_value)) {\n      case 'object':\n        return 'Geo';\n        break;\n      case 'string':\n        if (filter.operator === 'exists') return 'Boolean';\n        if (['false', 'true'].indexOf(filter.property_value) > -1) return 'Boolean';\n        if (isNumeric(filter.property_value) && ['contains', 'not_contains'].indexOf(filter.operator) === -1) return 'Number';\n        if (FormatUtils.isDateInStrictFormat(filter.property_value.substring(0, filter.property_value.length-6))) return 'Datetime';\n        if (FormatUtils.isList(filter.property_value)) return 'List';\n        return 'String';\n        break;\n      case 'array':\n        return 'List';\n        break;\n      case 'boolean':\n        return 'Boolean';\n        break;\n      case 'number':\n        return 'Number';\n        break;\n      case 'null':\n        return 'Null';\n        break;\n    }\n  },\n\n  isComplete: function(filter) {\n    var attrs = [\n      'property_name',\n      'property_value',\n      'operator',\n      'coercion_type'\n    ];\n    var complete = true;\n    for(var i=0; i<attrs.length; i++) {\n      var val = filter[attrs[i]];\n      complete = !_.isUndefined(val) && !_.isNull(val);\n      if (_.isObject(val)) complete = !_.isEmpty(val);\n      if (!complete) break;\n    }\n    return complete;\n  },\n\n  queryJSON: function(filter) {\n    RunValidations.run(FilterValidations, filter);\n    if (!filter.isValid) return {};\n\n    var attrs = _.cloneDeep(filter);\n    attrs.property_value = filterUtils.getCoercedValue(filter);\n\n    if (attrs.coercion_type === 'Datetime') {\n      attrs.property_value = FormatUtils.formatISOTimeNoTimezone(attrs.property_value);\n    }\n    if (attrs.coercion_type === 'List') {\n      attrs.property_value = FormatUtils.parseList(attrs.property_value);\n    }\n\n    return _.pick(attrs, ['property_name', 'operator', 'property_value']);\n  },\n\n  initList: function(filter) {\n    var newVal = \"\";\n    _.each(filter.property_value, function(item, index){\n      if (_.isString(item)) newVal += '\"' + item + '\"';\n      if (_.isNumber(item)) newVal += \"'\" + item + \"'\";\n      if (index !== filter.property_value.length - 1) newVal += ', ';\n    });\n    filter.property_value = newVal;\n    return filter;\n  },\n\n  formatFilterParams: function(filter) {\n    filter.coercion_type = filterUtils.getCoercionType(filter);\n    if (filter.coercion_type === 'List') {\n      filter = _.assign({}, filter, filterUtils.initList(filter));\n    }\n    filter.property_value = filterUtils.getCoercedValue(filter);\n    if (filter.coercion_type === 'Datetime') {\n      filter.property_value = FormatUtils.convertDateToUTC(new Date(filter.property_value));\n    }\n    return filter;\n  },\n\n  coerceGeoValue: function(value) {\n    var trailingDecimals = value.match(/\\.+$/);\n    if (value === '-' || (trailingDecimals && trailingDecimals.length)) {\n      return value;\n    } else {\n      return parseFloat(value) || 0;\n    }\n  },\n\n  validFilters: function(filters) {\n    return _.filter(filters, function(filter) {\n      RunValidations.run(FilterValidations, filter)\n      return filter.isValid;\n    });\n  }\n\n};\n\nexport default filterUtils;\n","import React from 'react';\nimport _ from 'lodash';\n\nconst InputComponent = React.createClass({\n\n  _onChange: function(event) {\n    this.setState({ value: event.target.value });\n    this.props.onChange(event);\n  },\n\n  getDefaultProps: function() {\n    return {\n      classes: 'form-group',\n      inputClasses: '',\n      type: 'text',\n      placeholder: '',\n      readonly: false,\n      onChange: function(){}\n    };\n  },\n\n  getInitialState: function() {\n    return {\n      value: this.props.value || ''\n    };\n  },\n\n  componentWillReceiveProps: function(nextProps) {\n    this.setState({ value: nextProps.value });\n  },\n\n  render: function() {\n    var required = this.props.required ? <small>(required)</small> : null;\n    var label = this.props.label ? <label htmlFor={this.props.name}>{this.props.label} {required}</label> : null;\n    var inputClasses = \"form-control\";\n    if (this.props.inputClasses) inputClasses = inputClasses + \" \" + this.props.inputClasses;\n\n    return (\n      <div className={this.props.classes}>\n        {label}\n        <input ref=\"input\"\n               type={this.props.type}\n               name={this.props.name}\n               className={inputClasses}\n               placeholder={this.props.placeholder}\n               onChange={this._onChange}\n               onBlur={this.props.onBlur}\n               value={this.state.value}\n               readOnly={this.props.readonly}\n               autoComplete=\"off\" />\n      </div>\n    );\n  }\n\n});\n\nexport default InputComponent;\n","import React from 'react';\nimport _ from 'lodash';\n\n/* TODO:\n[ ] resting state (selection/empty)\n[x] activate component on `up/down` key, or by typing\n[x] 'esc' key to close w/out changing selection (webkit pattern)\n[~] accessibility\n    [x] announce/surface options to screen readers\n    [x] input field should instruct further key controls\n[x] snag: re-activating w/ prior selection -> only see that selection\n    - should we show all on first (re-)focus?\n    - only filter list when typing? track interaction states?\n[ ] snag: long strings wrap and throw off scroll-sync\n    - truncrate at calc'd length? maybe truncate the middle? 'beginning.ah...ok.end'\n    - crazy: 'walk' the truncatation of the 'active' li (from right to left) after a 1-2sec 'pause'\n    - can we use 'left/right' key actions to change truncation? maybe w/ CSS?\n[ ] snag: mobile. perhaps we should revert to native elements, to avoid input+list+keyboard hysteria?\n[ ] bug: Escape event listener bubbles up and closes the modal.\n[ ] bug: With breaks on selects inside filter manager modal.\n*/\n\nconst ReactSelect = React.createClass({\n\n  getDefaultProps: function() {\n    return {\n      items: [],\n      wrapClasses: '',\n      inputClasses: '',\n      placeholder: '',\n      handleBlur: function(){},\n      handleChange: function(){},\n      handleSelection: function(){}\n    };\n  },\n\n  getInitialState: function() {\n    return {\n      focusedItem: '',\n      limit: 30,\n      initialFocus: false,\n      selectedItem: 0,\n      visible: false,\n      visibleItems: 0\n    };\n  },\n\n  resetState: function(){\n    this.setState({\n      focusedItem: '',\n      limit: 30,\n      selectedItem: 0,\n      visible: false,\n      initialFocus: true\n    });\n  },\n\n  handleClick: function(e) {\n    this.setState({ visible: true });\n    this.handleItemFocus();\n  },\n\n  handleChange: function(e) {\n    var newState = {\n      initialFocus: false\n    };\n    if (this.state.visible) {\n      newState['limit'] = 30;\n      newState['selectedItem'] = 0;\n      this.refs.scrollpane.scrollTop = 0;\n    }\n    else {\n      newState['visible'] = true;\n    }\n    this.setState(newState);\n    this.props.handleChange(\n      this.props.name,\n      this.refs.input.value\n    );\n  },\n\n  handleFocus: function(e) {\n    if (!this.state.visible) {\n      this.setState({\n        initialFocus: true,\n        visible: true\n      });\n    }\n    else {\n      this.resetState();\n    }\n  },\n\n  handleBlur: function(e) {\n    if (this.refs.scrollpane && e.relatedTarget !== this.refs.scrollpane) {\n      if (!this.state.visible) e.preventDefault();\n      this.resetTimeout = setTimeout(this.resetState, 100);\n      this.blurTimeout = setTimeout(this.props.handleBlur(e), 100);\n    }\n  },\n\n  handleItemFocus: function() {\n    clearTimeout(this.resetTimeout);\n    clearTimeout(this.blurTimeout);\n  },\n\n  handleItemSelection: function(index) {\n    if (typeof this.props.items[index]) {\n      var selection = String(this.props.items[index]);\n      this.setState({ initialFocus: false });\n      this.refs.input.focus();\n      this.resetState();\n      this.props.handleChange(this.props.name, selection);\n      this.props.handleSelection(this.props.name, selection);\n    }\n  },\n\n  handleKeyDown: function(e) {\n    var itemHeight, itemOffset;\n\n    if (e.key === \"Tab\" || e.key === \"Shift\") return;\n\n    this.setState({ visible: true });\n\n    if (this.refs.list && this.state.selectedItem) {\n      itemHeight = this.refs.list.children[this.state.selectedItem].scrollHeight + 1;\n      itemOffset = itemHeight * this.state.selectedItem;\n    }\n\n    if (this.keyDownCallbacks[e.key]) {\n      this.keyDownCallbacks[e.key].call(this, e, itemHeight, itemOffset);\n    }\n  },\n\n  keyDownCallbacks: {\n\n    \"ArrowUp\": function(e, itemHeight, itemOffset) {\n      var newState = {};\n      var list = this.refs.list;\n\n      if (this.state.selectedItem-1 >= 0) {\n        newState['selectedItem'] = this.state.selectedItem-1;\n        if (list) {\n          newState['focusedItem'] = list.children[this.state.selectedItem-1].innerHTML;\n        }\n      }\n      else {\n        newState['selectedItem'] = 0;\n        if (list) {\n          newState['focusedItem'] = list.children[0].innerHTML;\n        }\n      }\n      this.setState(newState);\n\n      if (list && itemOffset > itemHeight*3) {\n        this.refs.scrollpane.scrollTop -= itemHeight;\n      }\n      e.preventDefault();\n    },\n\n    \"ArrowDown\": function(e, itemHeight, itemOffset) {\n      var newState = {};\n      var list = this.refs.list;\n\n      if (this.state.selectedItem+1 < this.visibleItems) {\n        newState['selectedItem'] = this.state.selectedItem+1;\n        if (list) {\n          newState['focusedItem'] = this.refs.list.children[this.state.selectedItem+1].innerHTML;\n        }\n      }\n      else {\n        newState['selectedItem'] = this.visibleItems-1;\n        if (list) {\n          newState['focusedItem'] = list.children[this.visibleItems-1].innerHTML;\n        }\n      }\n      this.setState(newState);\n\n      if (list && itemOffset > itemHeight*3) {\n        this.refs.scrollpane.scrollTop += itemHeight;\n      }\n      e.preventDefault();\n    },\n\n    \"Enter\": function(e, itemHeight, itemOffset) {\n      var list = this.refs.list;\n      if (list) {\n        var childNode = list.children[this.state.selectedItem];\n        if (childNode) this.handleItemSelection( childNode.getAttribute('data-index') );\n      }\n      else {\n        this.resetState();\n      }\n      e.preventDefault();\n    },\n\n    \"Escape\": function(e, itemHeight, itemOffset) {\n      this.handleBlur(e);\n      e.preventDefault();\n    }\n\n  },\n\n  handleScroll: function(e) {\n    var pane = this.refs.scrollpane;\n    var diff = pane.scrollHeight - pane.scrollTop - 200;\n      // -200 offset is a hack to account for fixed height\n    if (diff < 50) {\n      this.setState({ limit: this.state.limit + 30 });\n    }\n  },\n\n  // Data management\n\n  appendListItems: function(arr) {\n    var self = this;\n    arr.forEach(function(opt, i){\n      self.props.items.push(opt);\n    });\n    this.forceUpdate();\n    return this;\n  },\n\n  insertListItems: function(index, arr){\n    this.props.items.splice.apply(this.props.items, [index,0].concat(arr));\n    this.forceUpdate();\n    return this;\n  },\n\n  removeListItems: function(){\n    this.props.items = [];\n    this.forceUpdate();\n    return this;\n  },\n\n  getItems: function() {\n    var self = this;\n    var count = 0;\n    this.visibleItems = 0;\n    var inputString = this.state.initialFocus ? '' : (this.props.value || '');\n    return this.props.items.map(function(item, index) {\n      // If input is present, skip items that don't match\n      if (inputString.length > 0 && String(item).toLowerCase().search(_.escapeRegExp(inputString).toLowerCase()) < 0) return;\n\n      // Simple result limiting\n      count++; if (count > self.state.limit) return;\n      self.visibleItems = self.visibleItems+1;\n      return (\n        <li className={self.state.selectedItem === count-1 ? \"react-select-item active\" : \"react-select-item\" }\n          key={index}\n          data-index={index}\n          onMouseDown={self.handleItemSelection.bind(self, index)}\n          onFocus={self.handleItemFocus.bind(self, index)}\n          aria-live=\"polite\"\n          role=\"option\">\n            {item}\n        </li>\n      );\n    });\n  },\n\n  getScrollPane: function(items) {\n    // Hide scrollpane unless active\n    if (this.state.visible) {\n      return (\n        <div\n        ref=\"scrollpane\"\n        className=\"react-select-scrollpane\"\n        onScroll={this.handleScroll}\n        tabIndex=\"-1\"\n        aria-hidden=\"false\">\n          <div className=\"react-select-aria-notice\" aria-live=\"assertive\">\n            {this.state.focusedItem || ''}\n          </div>\n          <ul ref=\"list\" className=\"react-select-list\"\n              aria-atomic=\"false\"\n              aria-label=\"Begin typing to filter options, or key up or down to browse available options\"\n              aria-live=\"assertive\"\n              aria-relevant=\"additions\"\n              role=\"listbox\"\n              id={this.props.id + '-scrollpane'}>\n            {items}\n          </ul>\n        </div>\n      );\n    }\n  },\n\n  // React methods\n\n  render: function(){\n    var items = this.getItems();\n    var scrollpane = this.getScrollPane(items);\n\n    var wrapClasses = 'react-select';\n    if (this.props.wrapClasses) {\n      wrapClasses = wrapClasses + ' ' + this.props.wrapClasses;\n    }\n    if (this.state.visible) {\n      wrapClasses = wrapClasses + ' visible';\n    }\n\n    var inputClasses = 'react-select-input';\n    if (this.props.inputClasses) {\n      inputClasses = inputClasses + ' ' + this.props.inputClasses;\n    }\n\n    return (\n      <div ref=\"wrapper\" className={wrapClasses}>\n        <input ref=\"input\"\n               name={this.props.name}\n               className={inputClasses}\n               value={this.props.value || \"\"}\n               placeholder={this.props.placeholder}\n               onClick={this.handleClick}\n               onChange={this.handleChange}\n               onFocus={this.handleFocus}\n               onBlur={this.handleBlur}\n               onKeyDown={this.handleKeyDown}\n               aria-expanded={this.state.visible}\n               aria-owns={this.props.id + '-scrollpane'}\n               aria-label={this.props.title || \"Select value\"}\n               aria-selected={(this.props.value && this.props.value.length) ? true : undefined}\n               aria-live=\"polite\"\n               autoComplete=\"off\" />\n        {scrollpane}\n      </div>\n    );\n  }\n\n});\n\nexport default ReactSelect;\n","/* ExplorerStore */\n\nimport AppDispatcher from '../dispatcher/AppDispatcher';\nimport { EventEmitter } from 'events';\nimport _ from 'lodash';\nimport moment from 'moment-timezone';\n\nimport ExplorerConstants from '../constants/ExplorerConstants';\nimport FormatUtils from '../utils/FormatUtils';\nimport ExplorerUtils from '../utils/ExplorerUtils';\nimport FilterUtils from '../utils/FilterUtils';\nimport ProjectUtils from '../utils/ProjectUtils';\nimport ProjectStore from './ProjectStore';\n\nimport RunValidations from '../utils/RunValidations.js';\nimport ExplorerValidations from '../validations/ExplorerValidations.js';\nimport FilterValidations from '../validations/FilterValidations.js';\nimport StepValidations from '../validations/StepValidations.js';\n\nconst CHANGE_EVENT = 'change';\nconst SHARED_FUNNEL_STEP_PROPERTIES = ['event_collection', 'time', 'timezone', 'filters'];\n\nlet _explorers = {};\n\nfunction _defaultAttrs() {\n  return {\n    id: FormatUtils.generateTempId(),\n    query_name: null,\n    active: false,\n    saving: false,\n    dataTimestamp: null,\n    response: null,\n    loading: false,\n    isValid: true,\n    errors: [],\n    refresh_rate: 0,\n    query: {\n      event_collection: null,\n      analysis_type: null,\n      target_property: null,\n      percentile: null,\n      group_by: [],\n      order_by: null,\n      limit: null,\n      interval: null,\n      timezone: moment.tz.guess(),\n      filters: [],\n      steps: [],\n      email: null,\n      latest: null,\n      property_names: [],\n      time: {\n        relativity: 'this',\n        amount: 14,\n        sub_timeframe: 'days'\n      }\n    },\n    metadata: _defaultMetadata()\n  };\n}\n\nfunction _defaultMetadata() {\n  return {\n    display_name: null,\n    visualization: {\n      chart_type: null\n    }\n  };\n}\n\nfunction _defaultFilter() {\n  return {\n    property_name: null,\n    property_value: null,\n    operator: 'eq',\n    coercion_type: 'String',\n    isValid: true,\n    errors: []\n  };\n}\n\nfunction _defaultGeoFilter() {\n  return {\n    coordinates: [],\n    max_distance_miles: null\n  };\n}\n\nfunction _defaultStep() {\n  return {\n    event_collection: null,\n    actor_property: null,\n    time: {\n      relativity: 'this',\n      amount: 14,\n      sub_timeframe: 'days'\n    },\n    timezone: ProjectUtils.getLocalTimezone(),\n    filters: [],\n    optional: false,\n    inverted: false,\n    with_actors: false,\n    active: false,\n    isValid: true,\n    errors: []\n  }\n}\n\n\nfunction _validate(id) {\n  RunValidations.run(ExplorerValidations, _explorers[id]);\n}\n\n/**\n * Get the default coercion type for this filter based off the filter's property_name's set type\n * in the project schema.\n * @param  {Object} explorer  The explorer model that the filter belongs to\n * @param  {Object} filter    The filter\n * @return {String}           The default coercion type\n */\nfunction _getDefaultFilterCoercionType(explorer, filter) {\n  var propertyType = ProjectUtils.getPropertyType(\n    ProjectStore.getProject(),\n    explorer.query.event_collection,\n    filter.property_name);\n  var targetCoercionType = FormatUtils.coercionTypeForPropertyType(propertyType);\n  return targetCoercionType;\n}\n\n/**\n * Runs through the changeset and moves data around if necessary\n * @param {Object} explorer   The explorer model that is being updated\n * @param {Object} updates    The updated explorer model\n * @return {Object}           The new set of updates\n */\nfunction _prepareUpdates(explorer, updates) {\n  // TODO: We're assigning the response object directly onto the model so we\n  // don't have to loop through the (sometimes) massive response object.\n  function customizer(objValue, srcValue, key) {\n    if (_.isArray(objValue)) {\n      return srcValue;\n    } else if (key === 'time' && _.isPlainObject(objValue)) {\n      return srcValue;\n    }\n  }\n  var newModel = _.mergeWith({}, explorer, _.omit(updates, 'response'), customizer);\n  if (updates.response) newModel.response = updates.response;\n\n  // Check if the event collection has changed. Clear the property names if so.\n  if (updates.query && updates.query.event_collection && updates.query.event_collection !== explorer.query.event_collection) {\n    newModel.query.property_names = [];\n  }\n\n  if(newModel.query.analysis_type === 'funnel' && explorer.query.analysis_type !== 'funnel') {\n    newModel = _migrateToFunnel(explorer, newModel);\n  } else if(newModel.query.analysis_type !== 'funnel' && explorer.query.analysis_type === 'funnel') {\n    newModel = _migrateFromFunnel(explorer, newModel);\n  }\n  newModel = _removeInvalidFields(newModel);\n\n  return newModel;\n}\n\n/**\n * If the query got changed to a funnel, move the step-specific parameters to a steps object.\n * @param {Object} explorer The explorer model that is being updated\n * @param {Object} newModel The updated explorer model\n * @return {Object}         The new set of updates\n */\nfunction _migrateToFunnel(explorer, newModel) {\n  var firstStep = _defaultStep();\n  firstStep.active = true;\n\n  _.each(SHARED_FUNNEL_STEP_PROPERTIES, function (key) {\n    if(!_.isUndefined(explorer.query[key]) && !_.isNull(explorer.query[key])) {\n      firstStep[key] = explorer.query[key]\n    }\n\n    newModel.query[key] = (key === 'filters') ? [] : null;\n  });\n\n  if(!_.isUndefined(explorer.query.target_property) && !_.isNull(explorer.query.target_property)) {\n    firstStep.actor_property = explorer.query.target_property;\n    explorer.query.target_property = null;\n  }\n\n  newModel.query.steps = [firstStep];\n\n  return newModel;\n}\n\n/**\n * If the query got changed from a funnel, move the applicable parameters out to the root query\n * @param {Object} explorer The explorer model that is being updated\n * @param {Object} newModel The updated explorer model\n * @return {Object}         The new set of updates\n */\nfunction _migrateFromFunnel(explorer, newModel) {\n  if (explorer.query.steps.length < 1) return newModel;\n  var activeStep = _.find(explorer.query.steps, { active: true }) || explorer.query.steps[0];\n\n  _.each(SHARED_FUNNEL_STEP_PROPERTIES, function (key) {\n    if (!_.isUndefined(activeStep[key])) {\n      newModel.query[key] = activeStep[key];\n    }\n  });\n\n  if (!_.isNull(activeStep.actor_property) && ExplorerUtils.shouldHaveTarget(newModel)) {\n    newModel.query.target_property = activeStep.actor_property;\n  }\n\n  newModel.query.steps = [];\n\n  return newModel;\n}\n\n/**\n * Removes fields from the query that aren't valid given the new analysis type.\n * @param {Object} newModel   The updated explorer model\n * @return {Object}           The new set of updates\n */\nfunction _removeInvalidFields(newModel) {\n  if (!ExplorerUtils.isEmailExtraction(newModel)) {\n    newModel.query.latest = null;\n    newModel.query.email = null;\n  }\n  if (newModel.query.analysis_type === 'extraction') {\n    newModel.query.group_by = null;\n    newModel.query.order_by = null;\n    newModel.query.limit = null;\n    newModel.query.interval = null;\n  }\n  if (newModel.query.analysis_type !== 'extraction') {\n    newModel.query.latest = null;\n  }\n  if (newModel.query.analysis_type !== 'percentile') {\n    newModel.query.percentile = null;\n  }\n  if (_.includes(['count', 'extraction', 'funnel'], newModel.query.analysis_type)) {\n    newModel.query.target_property = null;\n  }\n  if (newModel.query.analysis_type !== 'funnel') {\n    newModel.query.steps = [];\n  }\n  if(newModel.query.analysis_type === 'funnel') {\n    newModel.query.filters = [];\n    newModel.query.time = null;\n    newModel.query.timezone = null;\n    newModel.query.group_by = null;\n    newModel.query.order_by = null;\n    newModel.query.limit = null;\n    newModel.query.timeframe = null;\n    newModel.query.interval = null;\n  }\n  return newModel;\n}\n\n/**\n * Looks at updates about to be made to a filter and performs a series of operations to\n * change the filter values depending on the coercion_type, operator and type of property_value.\n * @param  {Object} explorer  The explorer model that owns the filter to be updated\n * @param  {Object} filter    The filter to be updated\n * @param  {Object} updates   The updates to be made to the filter\n * @return {Object}           The updated version of the filter after the changes have been made to it.\n */\nfunction _prepareFilterUpdates(explorer, filter, updates) {\n  if (updates.property_name && updates.property_name !== filter.property_name) {\n    if (filter.operator === 'exists') {\n      updates.coercion_type = 'Boolean';\n    } else {\n      // No need to update the operator - we allow any operator for any property type right now.\n      updates.coercion_type = _getDefaultFilterCoercionType(explorer, _.merge({}, filter, updates));\n    }\n  }\n  else if (updates.operator && updates.operator !== filter.operator) {\n    var newOp = updates.operator;\n    if (newOp === 'in') updates.coercion_type = 'List';\n    if (newOp === 'exists') updates.coercion_type = 'Boolean';\n    if (newOp === 'within') updates.coercion_type = 'Geo';\n\n    // If it's not any of these operators, we still need to make sure that the current coercion_type is available\n    // as an option for this new operator.\n    var coercionOptions = _.find(ProjectUtils.getConstant('FILTER_OPERATORS'), { value: updates.operator }).canBeCoeredTo;\n    var coercion_type = updates.coercion_type || filter.coercion_type;\n    if (!_.includes(coercionOptions, coercion_type)) {\n      updates.coercion_type = coercionOptions[0];\n    }\n  }\n\n  if (updates.coercion_type === 'Geo' && filter.coercion_type !== 'Geo') {\n    updates.property_value = _defaultGeoFilter();\n  }\n\n  updates.property_value = FilterUtils.getCoercedValue(_.merge({}, filter, updates));\n\n  return updates;\n}\n\nfunction _wrapGroupBy(group_by) {\n  if (!_.isArray(group_by)) group_by = [group_by];\n  return _.pull(group_by, null);\n}\n\nfunction _create(attrs) {\n  if (attrs && attrs.active === true) {\n    throw new Error('You must use setActive to set a model as active.');\n    return;\n  }\n\n  attrs = attrs || {};\n  var newAttrs = _.merge(_defaultAttrs(), attrs);\n\n  if (newAttrs.query.steps) {\n    newAttrs.query.steps = _.map(newAttrs.query.steps, function (step) {\n      return _.merge(_defaultStep(), step);\n    });\n  }\n  if (!newAttrs.metadata) newAttrs.metadata = _defaultMetadata();\n  newAttrs.query.group_by = _wrapGroupBy(newAttrs.query.group_by);\n  newAttrs.query.percentile = parseFloat(newAttrs.query.percentile) || null;\n\n  _explorers[newAttrs.id] = newAttrs;\n  return newAttrs.id;\n}\n\nfunction _update(id, updates) {\n  if (updates && updates.active === true && !_explorers[id].active) {\n    throw new Error('You must use setActive to set a model as active.');\n    return;\n  }\n\n  var newModel = _prepareUpdates(_explorers[id], updates);\n  newModel.query.group_by = _wrapGroupBy(newModel.query.group_by);\n  if (newModel.query.percentile &&\n    newModel.query.percentile[newModel.query.percentile.length-1] === '.') {\n  } else {\n    newModel.query.percentile = parseFloat(newModel.query.percentile) || null;\n  }\n\n\n  if (updates.id && updates.id !== id) {\n    _explorers[updates.id] = newModel;\n    delete _explorers[id];\n    return updates.id;\n  } else {\n    _explorers[id] = newModel;\n    return id;\n  }\n}\n\nfunction _markFirstInvalidStepActive(id) {\n  var explorer = _explorers[id];\n  if (explorer.query.analysis_type !== 'funnel') return;\n  explorer.query.steps.forEach(function(step, index) {\n    if (!step.isValid) _setStepActive(id, index);\n  });\n}\n\nfunction _remove(id) {\n  delete _explorers[id];\n}\n\nfunction _setActive(id) {\n  _.each(_explorers, function(explorer, key) {\n    explorer.active = false;\n    delete explorer.originalModel;\n  });\n  _explorers[id].active = true;\n  _explorers[id].originalModel = _.cloneDeep(_explorers[id]);\n}\n\nfunction _revertActiveChanges() {\n  var active = _.find(_explorers, { active: true });\n  var original = _explorers[active.id].originalModel;\n  _explorers[active.id] = _.assign({}, original, { originalModel: original, response: active.response });\n  return active.id;\n}\n\nfunction _addFilter(id, attrs) {\n  attrs = attrs || {};\n  _explorers[id].query.filters.push(_.assign(_defaultFilter(), attrs));\n}\n\nfunction _removeFilter(id, index) {\n  _explorers[id].query.filters.splice(index, 1);\n}\n\nfunction _updateFilter(id, index, updates) {\n  var filter = _explorers[id].query.filters[index];\n  var updates = _prepareFilterUpdates(_explorers[id], filter, updates);\n\n  _explorers[id].query.filters[index] = _.assign({}, filter, updates);\n\n  // Hack around the fact that _.assign doesn't assign null values. But we\n  // actually WANT a null value if the coercion_type is null.\n  if (_explorers[id].query.filters[index].coercion_type === 'Null') {\n    _explorers[id].query.filters[index].property_value = null;\n  }\n}\n\nfunction _addStep(id, attrs) {\n  var explorer = _explorers[id];\n  if (explorer.query.analysis_type !== 'funnel') {\n    throw new Error('Error: Attempting to add a step to a non-funnel query. Explorer id: '+explorer.id);\n  }\n  var step = _.assign(_defaultStep(), attrs || {});\n  step.active = true;\n\n  // This is likely always true, but I like being defensive\n  if(explorer.query.steps.length > 0) {\n    var lastStep = explorer.query.steps[explorer.query.steps.length - 1];\n\n    step.time = lastStep.time;\n    step.timezone = lastStep.timezone;\n  }\n\n  explorer.query.steps.push(step);\n  _setStepActive(id, explorer.query.steps.length - 1);\n}\n\nfunction _removeStep(id, index) {\n  _explorers[id].query.steps.splice(index, 1);\n\n  if(index > _explorers[id].query.steps.length - 1) {\n    _setStepActive(id, _explorers[id].query.steps.length - 1);\n  } else {\n    _setStepActive(id, index);\n  }\n}\n\nfunction _updateStep(id, index, updates) {\n  var step = _explorers[id].query.steps[index];\n  _explorers[id].query.steps[index] = _.assign({}, step, updates);\n}\n\nfunction _setStepActive(id, index) {\n  _explorers[id].query.steps.forEach(function(step) {\n    step.active = false\n  })\n  _explorers[id].query.steps[index].active = true;\n}\n\nfunction _moveStep(id, index, direction) {\n  var steps = _.cloneDeep(_explorers[id].query.steps);\n\n  if (direction === 'up') {\n    if (index === 0) return;\n\n    var stepToDisplace = steps[index-1];\n    var step = steps[index];\n    steps[index-1] = step;\n    steps[index] = stepToDisplace;\n  }\n  if (direction === 'down') {\n    if (index === steps.length-1) return;\n\n    var stepToDisplace = steps[index+1];\n    var step = steps[index];\n    steps[index+1] = step;\n    steps[index] = stepToDisplace;\n  }\n\n  _explorers[id].query.steps = steps;\n}\n\nfunction _addStepFilter(id, stepIndex, attrs) {\n  attrs = attrs || {};\n  _explorers[id].query.steps[stepIndex].filters.push(_.assign(_defaultFilter(), attrs));\n}\n\nfunction _removeStepFilter(id, stepIndex, filterIndex) {\n  _explorers[id].query.steps[stepIndex].filters.splice(filterIndex, 1);\n}\n\nfunction _updateStepFilter(id, stepIndex, filterIndex, updates) {\n  var filter = _explorers[id].query.steps[stepIndex].filters[filterIndex];\n  var updates = _prepareFilterUpdates(_explorers[id], filter, updates);\n  _explorers[id].query.steps[stepIndex].filters[filterIndex] = _.assign({}, filter, updates);\n\n  // Hack around the fact that _.assign doesn't assign null values. But we\n  // actually WANT a null value if the coercion_type is null.\n  if (_explorers[id].query.steps[stepIndex].filters[filterIndex].coercion_type === 'Null') {\n    _explorers[id].query.steps[stepIndex].filters[filterIndex].property_value = null;\n  }\n}\n\nfunction _clear(id) {\n  var model = _explorers[id];\n  _explorers[id] = _.assign({}, _defaultAttrs(), _.pick(model, ['id', 'query_name', 'active', 'metadata', 'originalModel']));\n}\n\nvar ExplorerStore = _.assign({}, EventEmitter.prototype, {\n\n  unregisterWithDispatcher: function() {\n    AppDispatcher.unregister(this.dispatchToken);\n  },\n\n  clearAll: function() {\n    _explorers = {};\n  },\n\n  set: function(explorer) {\n    _explorers[explorer.id] = explorer;\n  },\n\n  get: function(id) {\n    return _explorers[id];\n  },\n\n  getActive: function() {\n    return _.find(_explorers, { active: true });\n  },\n\n  getAll: function() {\n    return _explorers;\n  },\n\n  getLast: function() {\n    var keys = _.keys(_explorers);\n    return _explorers[keys[keys.length-1]];\n  },\n\n  getAllPersisted: function() {\n    return _.filter(_explorers, function(explorer){\n      return ExplorerUtils.isPersisted(explorer);\n    });\n  },\n\n  emitChange: function() {\n    this.emit(CHANGE_EVENT);\n  },\n\n  addChangeListener: function(callback) {\n    this.on(CHANGE_EVENT, callback);\n  },\n\n  removeChangeListener: function(callback) {\n    this.removeListener(CHANGE_EVENT, callback);\n  }\n\n});\n\n// Register callback to handle all updates\nExplorerStore.dispatchToken = AppDispatcher.register(function(action) {\n\n  function finishAction(id) {\n    // Validate the model\n    if (id) _validate(id);\n\n    // Emit change\n    ExplorerStore.emitChange();\n  }\n\n  switch(action.actionType) {\n    case ExplorerConstants.EXPLORER_CREATE:\n      _create(action.attrs);\n      finishAction();\n      break;\n\n    case ExplorerConstants.EXPLORER_CREATE_BATCH:\n      action.models.forEach(function(model) {\n        _explorers[model.id] ? _update(model.id, model) : _create(model);\n      });\n      finishAction();\n      break;\n\n    case ExplorerConstants.EXPLORER_CLONE:\n      var source = ExplorerStore.get(action.id);\n      _create({ query: _.cloneDeep(source.query),\n                metadata: {\n                  display_name: null,\n                  visualization: {\n                    chart_type: _.cloneDeep(source.metadata.visualization.chart_type)\n                  }\n                }\n              });\n      finishAction();\n      break;\n\n    case ExplorerConstants.EXPLORER_UPDATE:\n      var id = _update(action.id, action.updates);\n      finishAction(id);\n      break;\n\n    case ExplorerConstants.EXPLORER_REMOVE:\n      var wasActive = (_explorers[action.id].active === true);\n      _remove(action.id);\n      // Create a new active explorer to replace the previously active one.\n      if (wasActive) {\n        var id = _create();\n        _setActive(id);\n      }\n      finishAction();\n      break;\n\n    case ExplorerConstants.EXPLORER_SET_ACTIVE:\n      _setActive(action.id);\n      finishAction(action.id);\n      break;\n\n    case ExplorerConstants.EXPLORER_REVERT_ACTIVE_CHANGES:\n      var id = _revertActiveChanges();\n      finishAction(id);\n      break;\n\n    case ExplorerConstants.EXPLORER_CLEAR:\n      _clear(action.id);\n      finishAction();\n      break;\n\n    case ExplorerConstants.EXPLORER_SAVING:\n      _update(action.id, { saving: true });\n      finishAction(action.id);\n      break;\n\n    case ExplorerConstants.EXPLORER_SAVE_SUCCESS:\n      _update(action.id, { saving: false });\n      finishAction(action.id);\n      break;\n\n    case ExplorerConstants.EXPLORER_SAVE_FAIL:\n      _update(action.id, { saving: false });\n      finishAction(action.id);\n      break;\n\n    case ExplorerConstants.EXPLORER_ADD_FILTER:\n      _addFilter(action.id, action.attrs);\n      finishAction(action.id);\n      break;\n\n    case ExplorerConstants.EXPLORER_REMOVE_FILTER:\n      _removeFilter(action.id, action.index);\n      finishAction(action.id);\n      break;\n\n    case ExplorerConstants.EXPLORER_UPDATE_FILTER:\n      _updateFilter(action.id, action.index, action.attrs);\n      finishAction(action.id);\n      break;\n\n    case ExplorerConstants.EXPLORER_ADD_STEP:\n      _addStep(action.id, action.attrs);\n      finishAction(action.id);\n      break;\n\n    case ExplorerConstants.EXPLORER_REMOVE_STEP:\n      _removeStep(action.id, action.index);\n      finishAction(action.id);\n      break;\n\n    case ExplorerConstants.EXPLORER_UPDATE_STEP:\n      _updateStep(action.id, action.index, action.attrs);\n      finishAction(action.id);\n      break;\n\n    case ExplorerConstants.EXPLORER_SET_STEP_ACTIVE:\n      _setStepActive(action.id, action.index);\n      finishAction(action.id);\n      break;\n\n    case ExplorerConstants.EXPLORER_MOVE_STEP:\n      _moveStep(action.id, action.index, action.direction);\n      finishAction(action.id);\n      break;\n\n    case ExplorerConstants.EXPLORER_ADD_STEP_FILTER:\n      _addStepFilter(action.id, action.stepIndex, action.attrs);\n      finishAction(action.id);\n      break;\n\n    case ExplorerConstants.EXPLORER_REMOVE_STEP_FILTER:\n      _removeStepFilter(action.id, action.stepIndex, action.filterIndex);\n      finishAction(action.id);\n      break;\n\n    case ExplorerConstants.EXPLORER_UPDATE_STEP_FILTER:\n      _updateStepFilter(action.id, action.stepIndex, action.filterIndex, action.attrs);\n      finishAction(action.id);\n      break;\n\n    case ExplorerConstants.EXPLORER_VALIDATE:\n      _validate(action.id);\n      finishAction();\n      break;\n\n    case ExplorerConstants.EXPLORER_FOUND_INVALID:\n      // Find any invalid steps and mark the first one active to display the notice.\n      _markFirstInvalidStepActive(action.id);\n      finishAction();\n      break;\n\n    default:\n      // no op\n  }\n\n  return true;\n});\n\nexport default ExplorerStore;\n","const run = function(validatorSet, model) {\n    var keys = Object.keys(validatorSet);\n    model.isValid = true;\n    model.errors = [];\n\n    for (var i=0; i<keys.length; i++) {\n      var validator = validatorSet[keys[i]];\n\n      // Check if this validator should be run at all.\n      if (validator.shouldRun && !validator.shouldRun(model)) continue;\n\n      var result = validator.validate(model);\n\n      // Validator returned true. This attribute is valid. Move on.\n      if (result === true) continue;\n\n      // There is an error. Set the model as invalid and set the errors on the model.\n      model.isValid = false;\n      model.errors.push({\n        attribute: keys[i],\n        msg: (result === false) ? validator.msg : result\n      });\n    }\n};\nexport default { run };\n","import React from 'react';\nimport classNames from 'classnames';\nimport _ from 'lodash';\n\nconst FieldsToggle = React.createClass({\n\n  handleFieldsToggle: function(toggledState) {\n    var attrNames = this.props.attrsToStore;\n    var updates = {};\n\n    if (!_.isArray(attrNames)) {\n      attrNames = [attrNames];\n    }\n    _.each(attrNames, function(attrName){\n      if (toggledState) {\n        if (this._storedAttrs[attrName]) {\n          updates[attrName] = this._storedAttrs[attrName];\n        }\n      } else {\n        this._storedAttrs[attrName] = this.props.getFn(attrName);\n        var resetVal = this.props.resetValues[attrName] || null;\n        updates[attrName] = resetVal;\n        if (this.props.handleReset) {\n          this.props.handleReset();\n        }\n      }\n    }.bind(this));\n\n    this.props.updateFn(updates);\n  },\n\n  toggleButtonClick: function(event) {\n    event.preventDefault();\n    this.toggle();\n  },\n\n  toggle: function() {\n    var openState;\n    if (this.props.fieldsCount === null) {\n      openState = !this.state.open;\n      this.setState({ open: openState });\n      this.handleFieldsToggle(openState);\n    }\n    this.props.toggleCallback(openState || null);\n  },\n\n  // React Methods\n\n  componentWillMount: function() {\n    this._storedAttrs = {};\n  },\n\n  getDefaultProps: function() {\n    return {\n      toggleCallback: function(){},\n      initialOpenState: false,\n      fieldsCount: null,\n      resetValues: {}\n    };\n  },\n\n  getInitialState: function(){\n    return {\n      open: this.props.initialOpenState ? true : false\n    };\n  },\n\n  componentWillReceiveProps: function(nextProps) {\n    if (!this.props.initialOpenState && nextProps.initialOpenState) {\n      this.setState({ open: true });\n    }\n    if (this.props.hide) {\n      this.setState({ open: false });\n    }\n  },\n\n  componentDidReceiveProps: function() {\n    if (this.props.hide && this.state.open) {\n      this.setState({ open: false });\n    }\n  },\n\n  render: function() {\n    var fieldsCount = this.props.fieldsCount ? this.props.fieldsCount : null;\n\n    var classes = classNames({\n      'has-fields-count': fieldsCount,\n      'open': this.state.open && fieldsCount === null,\n      'fields-toggle': true\n    });\n\n    var bodyContent;\n    if (this.props.children) {\n      bodyContent = (\n        <div className=\"toggle-body\">\n          {this.props.children}\n        </div>\n      );\n    }\n\n    return (\n      <div className={classes}>\n        <a href=\"#\" className=\"toggle-label\" onClick={this.toggleButtonClick} ref=\"toggle-label\">\n          <h5 ref=\"name\">{this.props.name}</h5>\n          <button type=\"button\" className=\"toggle-button\">\n            <span className=\"icon\" ref=\"icon\">{fieldsCount}</span>\n          </button>\n        </a>\n        {bodyContent}\n      </div>\n    );\n  }\n\n});\n\nexport default FieldsToggle;\n","import React from 'react';\nimport _ from 'lodash';\n\nconst SelectComponent = React.createClass({\n\n  buildOptions: function() {\n    if (this.state.options.length) {\n\n      return this.state.options.map(function(option) {\n        return (\n          <option value={option.value} key={option.value} disabled={option.disabled || false}>\n            {option.name}\n          </option>\n        );\n      });\n    } else {\n      return null;\n    }\n  },\n\n  wrapValuesInObjects: function(options) {\n    if (!_.isObject(options[0])) {\n      return _.map(options, function(option) {\n        return { name: option, value: option };\n      });\n    }\n    return options;\n  },\n\n  sortOptions: function(options) {\n    return options.sort(function(a, b){\n      var A = a.name.toLowerCase();\n      var B = b.name.toLowerCase();\n\n       if (A < B){\n        return -1;\n       } else if (A > B) {\n        return  1;\n       } else {\n         return 0;\n       }\n    });\n  },\n\n  buildEmptyOption: function() {\n    var emptyOption = this.props.emptyOption;\n\n    if (emptyOption === true) {\n      return (<option value=\"\"></option>);\n    } else if (emptyOption) {\n      return (<option value=\"\">{emptyOption}</option>);\n    } else {\n      return null;\n    }\n  },\n\n  setupOptions: function(options) {\n    var newOptions = this.wrapValuesInObjects(options);\n    if (this.props.sort) newOptions = this.sortOptions(newOptions);\n    return newOptions;\n  },\n\n  // React Methods\n\n  getDefaultProps: function() {\n    return {\n      classes: 'form-group',\n      sort: true,\n      emptyOption: true,\n      reference: 'select',\n      handleSelection: function(){},\n      handleBlur: function(){},\n      options: []\n    };\n  },\n\n  componentWillReceiveProps: function(nextProps) {\n    this.setState({ options: this.setupOptions(nextProps.options) });\n  },\n\n  getInitialState: function() {\n    return {\n      options: this.setupOptions(this.props.options)\n    };\n  },\n\n  render: function() {\n    var optionNodes = this.buildOptions();\n    var label = this.props.label ? <label htmlFor={this.props.name}>{this.props.label}</label> : null;\n    var emptyOption = this.buildEmptyOption();\n    var emptyVal = this.props.multiple ? [] : ''\n    var selectedValue = this.props.selectedOption ? this.props.selectedOption : emptyVal;\n\n    return (\n      <div className={this.props.classes}>\n        {label}\n        <div className=\"select-element\">\n          <select ref={this.props.reference}\n                  name={this.props.name}\n                  value={selectedValue}\n                  className=\"form-control\"\n                  multiple={this.props.multiple}\n                  onChange={this.props.handleSelection}\n                  onBlur={this.props.handleBlur}\n                  disabled={this.props.disabled}>\n            {emptyOption}\n            {optionNodes}\n          </select>\n        </div>\n      </div>\n    );\n  }\n\n});\n\nexport default SelectComponent;\n","/* ExplorerStore */\n\nimport AppDispatcher from '../dispatcher/AppDispatcher';\nimport { EventEmitter } from 'events';\nimport _ from 'lodash';\nimport ProjectConstants from '../constants/ProjectConstants';\nimport ProjectUtils from '../utils/ProjectUtils';\nimport FormatUtils from '../utils/FormatUtils';\n\nconst CHANGE_EVENT = 'change';\n\nlet _projects = {};\n\nfunction defaultAttrs() {\n  return {\n    id: null,\n    loading: true,\n    eventCollections: [],\n    sortedEventCollections: {},\n    schema: {}\n  };\n}\n\nfunction _create(attrs) {\n  var id = FormatUtils.generateTempId();\n  _projects[id] = _.assign(defaultAttrs(), { id: id }, attrs);\n}\n\nfunction _update(id, updates) {\n  _projects[id] = _.assign({}, _projects[id], updates);\n}\n\nfunction _updateEventCollection(id, collectionName, updates) {\n  var newCollection = _.assign(\n    {},\n    _projects[id].schema[collectionName],\n    updates\n  );\n  _projects[id].schema[collectionName] = newCollection;\n}\n\nvar ProjectStore = _.assign({}, EventEmitter.prototype, {\n  unregisterWithDispatcher: function() {\n    AppDispatcher.unregister(_dispatcherToken);\n  },\n\n  clearAll: function() {\n    _projects = {};\n  },\n\n  getProject: function() {\n    var keys = Object.keys(_projects);\n    if (keys.length) {\n      return _projects[keys[0]];\n    }\n  },\n\n  getAll: function() {\n    return _projects;\n  },\n\n  emitChange: function() {\n    this.emit(CHANGE_EVENT);\n  },\n\n  addChangeListener: function(callback) {\n    this.on(CHANGE_EVENT, callback);\n  },\n\n  removeChangeListener: function(callback) {\n    this.removeListener(CHANGE_EVENT, callback);\n  }\n});\n\n// Register callback to handle all updates\nvar _dispatcherToken = AppDispatcher.register(function(action) {\n  var attrs;\n\n  switch(action.actionType) {\n    case ProjectConstants.PROJECT_CREATE:\n      _create(action.attrs);\n      ProjectStore.emitChange();\n      break;\n\n    case ProjectConstants.PROJECT_UPDATE:\n      _update(action.id, action.updates);\n      ProjectStore.emitChange();\n      break;\n\n    case ProjectConstants.PROJECT_UPDATE_EVENT_COLLECTION:\n      _updateEventCollection(action.id, action.collectionName, action.updates);\n      ProjectStore.emitChange();\n      break;\n\n    default:\n      // no op\n  }\n\n  return true;\n});\n\nexport default ProjectStore;\n","import _ from 'lodash';\nimport ProjectUtils from './ProjectUtils';\nimport FormatUtils from './FormatUtils';\n\nconst timeframeUtils = {\n\n  /**\n   * Takes a time object and returns a string representing the timeframe type (absolute or relative)\n   * @param  {Object} time The time object\n   * @return {String} The type of timeframe, 'absolute' or 'relative'\n   */\n   timeframeType: function(time) {\n      if (_.isUndefined(time)) {\n        return null;\n      } else if (!_.isPlainObject(time)) {\n        throw new Error('Invalid timeframe type: not a plain object.');\n      } else if (_.has(time, 'start') || _.has(time, 'end')) {\n        return 'absolute';\n      } else if (_.has(time, 'relativity') && _.has(time, 'amount') && _.has(time, 'sub_timeframe')) {\n        return 'relative';\n      } else {\n        throw new Error('Invalid timeframe type: invalid time value.');\n      }\n   },\n\n  getTimezoneOffset: function(timezone) {\n    var zone = _.find(ProjectUtils.getConstant('TIMEZONES'), { value: timezone });\n    return zone ? zone.offset : '+00:00';\n  },\n\n  timeframeBuilders: {\n\n    absolute: function(time) {\n      if (time && time.start && time.end) {\n        return {\n          start: FormatUtils.formatISOTimeNoTimezone(time.start),\n          end: FormatUtils.formatISOTimeNoTimezone(time.end)\n        };\n      }\n    },\n\n    relative: function(time) {\n      if (time && time.relativity && time.amount && time.sub_timeframe) {\n        return [time.relativity, time.amount, time.sub_timeframe].join('_');\n      }\n    }\n\n  },\n\n  getTimeframe: function(time) {\n    var timeframeBuilder = timeframeUtils.timeframeBuilders[timeframeUtils.timeframeType(time)];\n    if (typeof(timeframeBuilder) === 'undefined') return \"\";\n    return timeframeBuilder(time);\n  },\n\n  getTimeParameters: function(timeframe, timezone) {\n    return {\n      timeframe: timeframe ? timeframeUtils.getTimeframe(timeframe) : null,\n      timezone: timezone || ProjectUtils.getConstant('DEFAULT_TIMEZONE')\n    };\n  },\n\n  /**\n   * Takes a URL encoded timerame string or object and returns a time object that looks how the Explorer store wants\n   * it to\n   * @param  {String} timeframe\n   * @return {Object}\n   * Return structure:\n   * {\n   *  time: {an Object, either containing a deconstructed absolute or relative timeframe}\n   * }\n   */\n  unpackTimeframeParam: function(timeframe, timezone) {\n    if (typeof timeframe === 'object') {\n      return timeframeUtils.unpackAbsoluteTimeframe(timeframe, timezone);\n    } else if (typeof timeframe === 'string') {\n      return timeframeUtils.unpackRelativeTimeframe(timeframe, timezone);\n    }\n  },\n\n  unpackAbsoluteTimeframe: function (timeframe, timezone) {\n    var formattedValue = {\n      time: {},\n      timezone: null\n    };\n\n    if (!timezone || !ProjectUtils.getConstant('TIMEZONES').filter(z => z.name === timezone).length) {\n      formattedValue.timezone = 'UTC';\n    } else {\n      formattedValue.timezone = timezone;\n    }\n\n    var startVal = timeframe.start ? timeframe.start.substring(0, 19) : \"\";\n    formattedValue.time.start = FormatUtils.formatISOTimeNoTimezone(startVal);\n\n    var endVal = timeframe.end ? timeframe.end.substring(0, 19) : \"\";\n    formattedValue.time.end = FormatUtils.formatISOTimeNoTimezone(endVal);\n\n    return formattedValue;\n  },\n\n  unpackRelativeTimeframe: function (timeframe, timezone) {\n    var split = timeframe.split('_');\n    return {\n      time: {\n        relativity: split[0],\n        amount: split[1],\n        sub_timeframe: split[2]\n      },\n      timezone: timezone\n    };\n  }\n\n}\n\nexport default timeframeUtils;\n","import AppDispatcher from '../dispatcher/AppDispatcher';\nimport NoticeConstants from '../constants/NoticeConstants';\n\nconst NoticeActions = {\n\n  create: function(attrs) {\n    AppDispatcher.dispatch({\n      actionType: NoticeConstants.NOTICE_CREATE,\n      attrs: attrs\n    });\n  },\n\n  clearAll: function() {\n    AppDispatcher.dispatch({\n      actionType: NoticeConstants.NOTICE_CLEAR_ALL\n    });\n  }\n\n};\n\nexport default NoticeActions;\n","import keyMirror from 'keymirror';\n\nexport default keyMirror({\n  EXPLORER_CREATE: null,\n  EXPLORER_CREATE_BATCH: null,\n  EXPLORER_CLONE: null,\n  EXPLORER_UPDATE: null,\n  EXPLORER_REMOVE: null,\n  EXPLORER_SET_ACTIVE: null,\n  EXPLORER_REVERT_ACTIVE_CHANGES: null,\n  EXPLORER_CLEAR: null,\n  EXPLORER_VALIDATE: null,\n  EXPLORER_FOUND_INVALID: null,\n  EXPLORER_QUERY_SUCCESS: null,\n  EXPLORER_QUERY_ERROR: null,\n\n  // Filter Actions\n  EXPLORER_ADD_FILTER: null,\n  EXPLORER_REMOVE_FILTER: null,\n  EXPLORER_UPDATE_FILTER: null,\n  EXPLORER_ADD_STEP: null,\n  EXPLORER_REMOVE_STEP: null,\n  EXPLORER_UPDATE_STEP: null,\n  EXPLORER_SET_STEP_ACTIVE: null,\n  EXPLORER_MOVE_STEP: null,\n  EXPLORER_ADD_STEP_FILTER: null,\n  EXPLORER_REMOVE_STEP_FILTER: null,\n  EXPLORER_UPDATE_STEP_FILTER: null,\n\n  // Saved Query Actions\n  EXPLORER_SAVE: null,\n  EXPLORER_SAVE_NEW: null,\n  EXPLORER_DESTROY: null,\n  EXPLORER_SAVING: null,\n  EXPLORER_SAVE_SUCCESS: null,\n  EXPLORER_SAVE_FAIL: null,\n  EXPLORER_DESTROYING: null,\n  EXPLORER_DESTROY_SUCCESS: null,\n  EXPLORER_DESTROY_FAIL: null\n});\n","module.exports = __WEBPACK_EXTERNAL_MODULE__20__;","// Copyright Joyent, Inc. and other Node contributors.\n//\n// Permission is hereby granted, free of charge, to any person obtaining a\n// copy of this software and associated documentation files (the\n// \"Software\"), to deal in the Software without restriction, including\n// without limitation the rights to use, copy, modify, merge, publish,\n// distribute, sublicense, and/or sell copies of the Software, and to permit\n// persons to whom the Software is furnished to do so, subject to the\n// following conditions:\n//\n// The above copyright notice and this permission notice shall be included\n// in all copies or substantial portions of the Software.\n//\n// THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS\n// OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF\n// MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN\n// NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM,\n// DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR\n// OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE\n// USE OR OTHER DEALINGS IN THE SOFTWARE.\n\nfunction EventEmitter() {\n  this._events = this._events || {};\n  this._maxListeners = this._maxListeners || undefined;\n}\nmodule.exports = EventEmitter;\n\n// Backwards-compat with node 0.10.x\nEventEmitter.EventEmitter = EventEmitter;\n\nEventEmitter.prototype._events = undefined;\nEventEmitter.prototype._maxListeners = undefined;\n\n// By default EventEmitters will print a warning if more than 10 listeners are\n// added to it. This is a useful default which helps finding memory leaks.\nEventEmitter.defaultMaxListeners = 10;\n\n// Obviously not all Emitters should be limited to 10. This function allows\n// that to be increased. Set to zero for unlimited.\nEventEmitter.prototype.setMaxListeners = function(n) {\n  if (!isNumber(n) || n < 0 || isNaN(n))\n    throw TypeError('n must be a positive number');\n  this._maxListeners = n;\n  return this;\n};\n\nEventEmitter.prototype.emit = function(type) {\n  var er, handler, len, args, i, listeners;\n\n  if (!this._events)\n    this._events = {};\n\n  // If there is no 'error' event listener then throw.\n  if (type === 'error') {\n    if (!this._events.error ||\n        (isObject(this._events.error) && !this._events.error.length)) {\n      er = arguments[1];\n      if (er instanceof Error) {\n        throw er; // Unhandled 'error' event\n      } else {\n        // At least give some kind of context to the user\n        var err = new Error('Uncaught, unspecified \"error\" event. (' + er + ')');\n        err.context = er;\n        throw err;\n      }\n    }\n  }\n\n  handler = this._events[type];\n\n  if (isUndefined(handler))\n    return false;\n\n  if (isFunction(handler)) {\n    switch (arguments.length) {\n      // fast cases\n      case 1:\n        handler.call(this);\n        break;\n      case 2:\n        handler.call(this, arguments[1]);\n        break;\n      case 3:\n        handler.call(this, arguments[1], arguments[2]);\n        break;\n      // slower\n      default:\n        args = Array.prototype.slice.call(arguments, 1);\n        handler.apply(this, args);\n    }\n  } else if (isObject(handler)) {\n    args = Array.prototype.slice.call(arguments, 1);\n    listeners = handler.slice();\n    len = listeners.length;\n    for (i = 0; i < len; i++)\n      listeners[i].apply(this, args);\n  }\n\n  return true;\n};\n\nEventEmitter.prototype.addListener = function(type, listener) {\n  var m;\n\n  if (!isFunction(listener))\n    throw TypeError('listener must be a function');\n\n  if (!this._events)\n    this._events = {};\n\n  // To avoid recursion in the case that type === \"newListener\"! Before\n  // adding it to the listeners, first emit \"newListener\".\n  if (this._events.newListener)\n    this.emit('newListener', type,\n              isFunction(listener.listener) ?\n              listener.listener : listener);\n\n  if (!this._events[type])\n    // Optimize the case of one listener. Don't need the extra array object.\n    this._events[type] = listener;\n  else if (isObject(this._events[type]))\n    // If we've already got an array, just append.\n    this._events[type].push(listener);\n  else\n    // Adding the second element, need to change to array.\n    this._events[type] = [this._events[type], listener];\n\n  // Check for listener leak\n  if (isObject(this._events[type]) && !this._events[type].warned) {\n    if (!isUndefined(this._maxListeners)) {\n      m = this._maxListeners;\n    } else {\n      m = EventEmitter.defaultMaxListeners;\n    }\n\n    if (m && m > 0 && this._events[type].length > m) {\n      this._events[type].warned = true;\n      console.error('(node) warning: possible EventEmitter memory ' +\n                    'leak detected. %d listeners added. ' +\n                    'Use emitter.setMaxListeners() to increase limit.',\n                    this._events[type].length);\n      if (typeof console.trace === 'function') {\n        // not supported in IE 10\n        console.trace();\n      }\n    }\n  }\n\n  return this;\n};\n\nEventEmitter.prototype.on = EventEmitter.prototype.addListener;\n\nEventEmitter.prototype.once = function(type, listener) {\n  if (!isFunction(listener))\n    throw TypeError('listener must be a function');\n\n  var fired = false;\n\n  function g() {\n    this.removeListener(type, g);\n\n    if (!fired) {\n      fired = true;\n      listener.apply(this, arguments);\n    }\n  }\n\n  g.listener = listener;\n  this.on(type, g);\n\n  return this;\n};\n\n// emits a 'removeListener' event iff the listener was removed\nEventEmitter.prototype.removeListener = function(type, listener) {\n  var list, position, length, i;\n\n  if (!isFunction(listener))\n    throw TypeError('listener must be a function');\n\n  if (!this._events || !this._events[type])\n    return this;\n\n  list = this._events[type];\n  length = list.length;\n  position = -1;\n\n  if (list === listener ||\n      (isFunction(list.listener) && list.listener === listener)) {\n    delete this._events[type];\n    if (this._events.removeListener)\n      this.emit('removeListener', type, listener);\n\n  } else if (isObject(list)) {\n    for (i = length; i-- > 0;) {\n      if (list[i] === listener ||\n          (list[i].listener && list[i].listener === listener)) {\n        position = i;\n        break;\n      }\n    }\n\n    if (position < 0)\n      return this;\n\n    if (list.length === 1) {\n      list.length = 0;\n      delete this._events[type];\n    } else {\n      list.splice(position, 1);\n    }\n\n    if (this._events.removeListener)\n      this.emit('removeListener', type, listener);\n  }\n\n  return this;\n};\n\nEventEmitter.prototype.removeAllListeners = function(type) {\n  var key, listeners;\n\n  if (!this._events)\n    return this;\n\n  // not listening for removeListener, no need to emit\n  if (!this._events.removeListener) {\n    if (arguments.length === 0)\n      this._events = {};\n    else if (this._events[type])\n      delete this._events[type];\n    return this;\n  }\n\n  // emit removeListener for all listeners on all events\n  if (arguments.length === 0) {\n    for (key in this._events) {\n      if (key === 'removeListener') continue;\n      this.removeAllListeners(key);\n    }\n    this.removeAllListeners('removeListener');\n    this._events = {};\n    return this;\n  }\n\n  listeners = this._events[type];\n\n  if (isFunction(listeners)) {\n    this.removeListener(type, listeners);\n  } else if (listeners) {\n    // LIFO order\n    while (listeners.length)\n      this.removeListener(type, listeners[listeners.length - 1]);\n  }\n  delete this._events[type];\n\n  return this;\n};\n\nEventEmitter.prototype.listeners = function(type) {\n  var ret;\n  if (!this._events || !this._events[type])\n    ret = [];\n  else if (isFunction(this._events[type]))\n    ret = [this._events[type]];\n  else\n    ret = this._events[type].slice();\n  return ret;\n};\n\nEventEmitter.prototype.listenerCount = function(type) {\n  if (this._events) {\n    var evlistener = this._events[type];\n\n    if (isFunction(evlistener))\n      return 1;\n    else if (evlistener)\n      return evlistener.length;\n  }\n  return 0;\n};\n\nEventEmitter.listenerCount = function(emitter, type) {\n  return emitter.listenerCount(type);\n};\n\nfunction isFunction(arg) {\n  return typeof arg === 'function';\n}\n\nfunction isNumber(arg) {\n  return typeof arg === 'number';\n}\n\nfunction isObject(arg) {\n  return typeof arg === 'object' && arg !== null;\n}\n\nfunction isUndefined(arg) {\n  return arg === void 0;\n}\n","module.exports = __WEBPACK_EXTERNAL_MODULE__22__;","/*!\n * pickadate.js v3.5.4, 2014/09/11\n * By Amsul, http://amsul.ca\n * Hosted on http://amsul.github.io/pickadate.js\n * Licensed under MIT\n */\n\n(function ( factory ) {\n\n    // AMD.\n    if ( typeof define == 'function' && define.amd )\n        define( 'picker', ['jquery'], factory )\n\n    // Node.js/browserify.\n    else if ( typeof exports == 'object' )\n        module.exports = factory( require('jquery') )\n\n    // Browser globals.\n    else this.Picker = factory( jQuery )\n\n}(function( $ ) {\n\nvar $window = $( window )\nvar $document = $( document )\nvar $html = $( document.documentElement )\n\n\n/**\n * The picker constructor that creates a blank picker.\n */\nfunction PickerConstructor( ELEMENT, NAME, COMPONENT, OPTIONS ) {\n\n    // If there’s no element, return the picker constructor.\n    if ( !ELEMENT ) return PickerConstructor\n\n\n    var\n        IS_DEFAULT_THEME = false,\n\n\n        // The state of the picker.\n        STATE = {\n            id: ELEMENT.id || 'P' + Math.abs( ~~(Math.random() * new Date()) )\n        },\n\n\n        // Merge the defaults and options passed.\n        SETTINGS = COMPONENT ? $.extend( true, {}, COMPONENT.defaults, OPTIONS ) : OPTIONS || {},\n\n\n        // Merge the default classes with the settings classes.\n        CLASSES = $.extend( {}, PickerConstructor.klasses(), SETTINGS.klass ),\n\n\n        // The element node wrapper into a jQuery object.\n        $ELEMENT = $( ELEMENT ),\n\n\n        // Pseudo picker constructor.\n        PickerInstance = function() {\n            return this.start()\n        },\n\n\n        // The picker prototype.\n        P = PickerInstance.prototype = {\n\n            constructor: PickerInstance,\n\n            $node: $ELEMENT,\n\n\n            /**\n             * Initialize everything\n             */\n            start: function() {\n\n                // If it’s already started, do nothing.\n                if ( STATE && STATE.start ) return P\n\n\n                // Update the picker states.\n                STATE.methods = {}\n                STATE.start = true\n                STATE.open = false\n                STATE.type = ELEMENT.type\n\n\n                // Confirm focus state, convert into text input to remove UA stylings,\n                // and set as readonly to prevent keyboard popup.\n                ELEMENT.autofocus = ELEMENT == document.activeElement\n                ELEMENT.readOnly = !SETTINGS.editable\n                ELEMENT.id = ELEMENT.id || STATE.id\n                if ( ELEMENT.type != 'text' ) {\n                    ELEMENT.type = 'text'\n                }\n\n\n                // Create a new picker component with the settings.\n                P.component = new COMPONENT(P, SETTINGS)\n\n\n                // Create the picker root with a holder and then prepare it.\n                P.$root = $( PickerConstructor._.node('div', createWrappedComponent(), CLASSES.picker, 'id=\"' + ELEMENT.id + '_root\"') )\n                prepareElementRoot()\n\n\n                // If there’s a format for the hidden input element, create the element.\n                if ( SETTINGS.formatSubmit ) {\n                    prepareElementHidden()\n                }\n\n\n                // Prepare the input element.\n                prepareElement()\n\n\n                // Insert the root as specified in the settings.\n                if ( SETTINGS.container ) $( SETTINGS.container ).append( P.$root )\n                else $ELEMENT.after( P.$root )\n\n\n                // Bind the default component and settings events.\n                P.on({\n                    start: P.component.onStart,\n                    render: P.component.onRender,\n                    stop: P.component.onStop,\n                    open: P.component.onOpen,\n                    close: P.component.onClose,\n                    set: P.component.onSet\n                }).on({\n                    start: SETTINGS.onStart,\n                    render: SETTINGS.onRender,\n                    stop: SETTINGS.onStop,\n                    open: SETTINGS.onOpen,\n                    close: SETTINGS.onClose,\n                    set: SETTINGS.onSet\n                })\n\n\n                // Once we’re all set, check the theme in use.\n                IS_DEFAULT_THEME = isUsingDefaultTheme( P.$root.children()[ 0 ] )\n\n\n                // If the element has autofocus, open the picker.\n                if ( ELEMENT.autofocus ) {\n                    P.open()\n                }\n\n\n                // Trigger queued the “start” and “render” events.\n                return P.trigger( 'start' ).trigger( 'render' )\n            }, //start\n\n\n            /**\n             * Render a new picker\n             */\n            render: function( entireComponent ) {\n\n                // Insert a new component holder in the root or box.\n                if ( entireComponent ) P.$root.html( createWrappedComponent() )\n                else P.$root.find( '.' + CLASSES.box ).html( P.component.nodes( STATE.open ) )\n\n                // Trigger the queued “render” events.\n                return P.trigger( 'render' )\n            }, //render\n\n\n            /**\n             * Destroy everything\n             */\n            stop: function() {\n\n                // If it’s already stopped, do nothing.\n                if ( !STATE.start ) return P\n\n                // Then close the picker.\n                P.close()\n\n                // Remove the hidden field.\n                if ( P._hidden ) {\n                    P._hidden.parentNode.removeChild( P._hidden )\n                }\n\n                // Remove the root.\n                P.$root.remove()\n\n                // Remove the input class, remove the stored data, and unbind\n                // the events (after a tick for IE - see `P.close`).\n                $ELEMENT.removeClass( CLASSES.input ).removeData( NAME )\n                setTimeout( function() {\n                    $ELEMENT.off( '.' + STATE.id )\n                }, 0)\n\n                // Restore the element state\n                ELEMENT.type = STATE.type\n                ELEMENT.readOnly = false\n\n                // Trigger the queued “stop” events.\n                P.trigger( 'stop' )\n\n                // Reset the picker states.\n                STATE.methods = {}\n                STATE.start = false\n\n                return P\n            }, //stop\n\n\n            /**\n             * Open up the picker\n             */\n            open: function( dontGiveFocus ) {\n\n                // If it’s already open, do nothing.\n                if ( STATE.open ) return P\n\n                // Add the “active” class.\n                $ELEMENT.addClass( CLASSES.active )\n                aria( ELEMENT, 'expanded', true )\n\n                // * A Firefox bug, when `html` has `overflow:hidden`, results in\n                //   killing transitions :(. So add the “opened” state on the next tick.\n                //   Bug: https://bugzilla.mozilla.org/show_bug.cgi?id=625289\n                setTimeout( function() {\n\n                    // Add the “opened” class to the picker root.\n                    P.$root.addClass( CLASSES.opened )\n                    aria( P.$root[0], 'hidden', false )\n\n                }, 0 )\n\n                // If we have to give focus, bind the element and doc events.\n                if ( dontGiveFocus !== false ) {\n\n                    // Set it as open.\n                    STATE.open = true\n\n                    // Prevent the page from scrolling.\n                    if ( IS_DEFAULT_THEME ) {\n                        $html.\n                            css( 'overflow', 'hidden' ).\n                            css( 'padding-right', '+=' + getScrollbarWidth() )\n                    }\n\n                    // Pass focus to the element’s jQuery object.\n                    $ELEMENT.trigger( 'focus' )\n\n                    // Bind the document events.\n                    $document.on( 'click.' + STATE.id + ' focusin.' + STATE.id, function( event ) {\n\n                        var target = event.target\n\n                        // If the target of the event is not the element, close the picker picker.\n                        // * Don’t worry about clicks or focusins on the root because those don’t bubble up.\n                        //   Also, for Firefox, a click on an `option` element bubbles up directly\n                        //   to the doc. So make sure the target wasn't the doc.\n                        // * In Firefox stopPropagation() doesn’t prevent right-click events from bubbling,\n                        //   which causes the picker to unexpectedly close when right-clicking it. So make\n                        //   sure the event wasn’t a right-click.\n                        if ( target != ELEMENT && target != document && event.which != 3 ) {\n\n                            // If the target was the holder that covers the screen,\n                            // keep the element focused to maintain tabindex.\n                            P.close( target === P.$root.children()[0] )\n                        }\n\n                    }).on( 'keydown.' + STATE.id, function( event ) {\n\n                        var\n                            // Get the keycode.\n                            keycode = event.keyCode,\n\n                            // Translate that to a selection change.\n                            keycodeToMove = P.component.key[ keycode ],\n\n                            // Grab the target.\n                            target = event.target\n\n\n                        // On escape, close the picker and give focus.\n                        if ( keycode == 27 ) {\n                            P.close( true )\n                        }\n\n\n                        // Check if there is a key movement or “enter” keypress on the element.\n                        else if ( target == ELEMENT && ( keycodeToMove || keycode == 13 ) ) {\n\n                            // Prevent the default action to stop page movement.\n                            event.preventDefault()\n\n                            // Trigger the key movement action.\n                            if ( keycodeToMove ) {\n                                PickerConstructor._.trigger( P.component.key.go, P, [ PickerConstructor._.trigger( keycodeToMove ) ] )\n                            }\n\n                            // On “enter”, if the highlighted item isn’t disabled, set the value and close.\n                            else if ( !P.$root.find( '.' + CLASSES.highlighted ).hasClass( CLASSES.disabled ) ) {\n                                P.set( 'select', P.component.item.highlight ).close()\n                            }\n                        }\n\n\n                        // If the target is within the root and “enter” is pressed,\n                        // prevent the default action and trigger a click on the target instead.\n                        else if ( $.contains( P.$root[0], target ) && keycode == 13 ) {\n                            event.preventDefault()\n                            target.click()\n                        }\n                    })\n                }\n\n                // Trigger the queued “open” events.\n                return P.trigger( 'open' )\n            }, //open\n\n\n            /**\n             * Close the picker\n             */\n            close: function( giveFocus ) {\n\n                // If we need to give focus, do it before changing states.\n                if ( giveFocus ) {\n                    // ....ah yes! It would’ve been incomplete without a crazy workaround for IE :|\n                    // The focus is triggered *after* the close has completed - causing it\n                    // to open again. So unbind and rebind the event at the next tick.\n                    $ELEMENT.off( 'focus.' + STATE.id ).trigger( 'focus' )\n                    setTimeout( function() {\n                        $ELEMENT.on( 'focus.' + STATE.id, focusToOpen )\n                    }, 0 )\n                }\n\n                // Remove the “active” class.\n                $ELEMENT.removeClass( CLASSES.active )\n                aria( ELEMENT, 'expanded', false )\n\n                // * A Firefox bug, when `html` has `overflow:hidden`, results in\n                //   killing transitions :(. So remove the “opened” state on the next tick.\n                //   Bug: https://bugzilla.mozilla.org/show_bug.cgi?id=625289\n                setTimeout( function() {\n\n                    // Remove the “opened” and “focused” class from the picker root.\n                    P.$root.removeClass( CLASSES.opened + ' ' + CLASSES.focused )\n                    aria( P.$root[0], 'hidden', true )\n\n                }, 0 )\n\n                // If it’s already closed, do nothing more.\n                if ( !STATE.open ) return P\n\n                // Set it as closed.\n                STATE.open = false\n\n                // Allow the page to scroll.\n                if ( IS_DEFAULT_THEME ) {\n                    $html.\n                        css( 'overflow', '' ).\n                        css( 'padding-right', '-=' + getScrollbarWidth() )\n                }\n\n                // Unbind the document events.\n                $document.off( '.' + STATE.id )\n\n                // Trigger the queued “close” events.\n                return P.trigger( 'close' )\n            }, //close\n\n\n            /**\n             * Clear the values\n             */\n            clear: function( options ) {\n                return P.set( 'clear', null, options )\n            }, //clear\n\n\n            /**\n             * Set something\n             */\n            set: function( thing, value, options ) {\n\n                var thingItem, thingValue,\n                    thingIsObject = $.isPlainObject( thing ),\n                    thingObject = thingIsObject ? thing : {}\n\n                // Make sure we have usable options.\n                options = thingIsObject && $.isPlainObject( value ) ? value : options || {}\n\n                if ( thing ) {\n\n                    // If the thing isn’t an object, make it one.\n                    if ( !thingIsObject ) {\n                        thingObject[ thing ] = value\n                    }\n\n                    // Go through the things of items to set.\n                    for ( thingItem in thingObject ) {\n\n                        // Grab the value of the thing.\n                        thingValue = thingObject[ thingItem ]\n\n                        // First, if the item exists and there’s a value, set it.\n                        if ( thingItem in P.component.item ) {\n                            if ( thingValue === undefined ) thingValue = null\n                            P.component.set( thingItem, thingValue, options )\n                        }\n\n                        // Then, check to update the element value and broadcast a change.\n                        if ( thingItem == 'select' || thingItem == 'clear' ) {\n                            $ELEMENT.\n                                val( thingItem == 'clear' ? '' : P.get( thingItem, SETTINGS.format ) ).\n                                trigger( 'change' )\n                        }\n                    }\n\n                    // Render a new picker.\n                    P.render()\n                }\n\n                // When the method isn’t muted, trigger queued “set” events and pass the `thingObject`.\n                return options.muted ? P : P.trigger( 'set', thingObject )\n            }, //set\n\n\n            /**\n             * Get something\n             */\n            get: function( thing, format ) {\n\n                // Make sure there’s something to get.\n                thing = thing || 'value'\n\n                // If a picker state exists, return that.\n                if ( STATE[ thing ] != null ) {\n                    return STATE[ thing ]\n                }\n\n                // Return the value, if that.\n                if ( thing == 'value' ) {\n                    return ELEMENT.value\n                }\n\n                // Check if a component item exists, return that.\n                if ( thing in P.component.item ) {\n                    if ( typeof format == 'string' ) {\n                        var thingValue = P.component.get( thing )\n                        return thingValue ?\n                            PickerConstructor._.trigger(\n                                P.component.formats.toString,\n                                P.component,\n                                [ format, thingValue ]\n                            ) : ''\n                    }\n                    return P.component.get( thing )\n                }\n            }, //get\n\n\n\n            /**\n             * Bind events on the things.\n             */\n            on: function( thing, method, internal ) {\n\n                var thingName, thingMethod,\n                    thingIsObject = $.isPlainObject( thing ),\n                    thingObject = thingIsObject ? thing : {}\n\n                if ( thing ) {\n\n                    // If the thing isn’t an object, make it one.\n                    if ( !thingIsObject ) {\n                        thingObject[ thing ] = method\n                    }\n\n                    // Go through the things to bind to.\n                    for ( thingName in thingObject ) {\n\n                        // Grab the method of the thing.\n                        thingMethod = thingObject[ thingName ]\n\n                        // If it was an internal binding, prefix it.\n                        if ( internal ) {\n                            thingName = '_' + thingName\n                        }\n\n                        // Make sure the thing methods collection exists.\n                        STATE.methods[ thingName ] = STATE.methods[ thingName ] || []\n\n                        // Add the method to the relative method collection.\n                        STATE.methods[ thingName ].push( thingMethod )\n                    }\n                }\n\n                return P\n            }, //on\n\n\n\n            /**\n             * Unbind events on the things.\n             */\n            off: function() {\n                var i, thingName,\n                    names = arguments;\n                for ( i = 0, namesCount = names.length; i < namesCount; i += 1 ) {\n                    thingName = names[i]\n                    if ( thingName in STATE.methods ) {\n                        delete STATE.methods[thingName]\n                    }\n                }\n                return P\n            },\n\n\n            /**\n             * Fire off method events.\n             */\n            trigger: function( name, data ) {\n                var _trigger = function( name ) {\n                    var methodList = STATE.methods[ name ]\n                    if ( methodList ) {\n                        methodList.map( function( method ) {\n                            PickerConstructor._.trigger( method, P, [ data ] )\n                        })\n                    }\n                }\n                _trigger( '_' + name )\n                _trigger( name )\n                return P\n            } //trigger\n        } //PickerInstance.prototype\n\n\n    /**\n     * Wrap the picker holder components together.\n     */\n    function createWrappedComponent() {\n\n        // Create a picker wrapper holder\n        return PickerConstructor._.node( 'div',\n\n            // Create a picker wrapper node\n            PickerConstructor._.node( 'div',\n\n                // Create a picker frame\n                PickerConstructor._.node( 'div',\n\n                    // Create a picker box node\n                    PickerConstructor._.node( 'div',\n\n                        // Create the components nodes.\n                        P.component.nodes( STATE.open ),\n\n                        // The picker box class\n                        CLASSES.box\n                    ),\n\n                    // Picker wrap class\n                    CLASSES.wrap\n                ),\n\n                // Picker frame class\n                CLASSES.frame\n            ),\n\n            // Picker holder class\n            CLASSES.holder\n        ) //endreturn\n    } //createWrappedComponent\n\n\n\n    /**\n     * Prepare the input element with all bindings.\n     */\n    function prepareElement() {\n\n        $ELEMENT.\n\n            // Store the picker data by component name.\n            data(NAME, P).\n\n            // Add the “input” class name.\n            addClass(CLASSES.input).\n\n            // If there’s a `data-value`, update the value of the element.\n            val( $ELEMENT.data('value') ?\n                P.get('select', SETTINGS.format) :\n                ELEMENT.value\n            ).\n\n            // On focus/click, open the picker and adjust the root “focused” state.\n            on('focus.' + STATE.id + ' click.' + STATE.id, focusToOpen)\n\n\n        // Only bind keydown events if the element isn’t editable.\n        if ( !SETTINGS.editable ) {\n\n            // Handle keyboard event based on the picker being opened or not.\n            $ELEMENT.on('keydown.' + STATE.id, function(event) {\n\n                var keycode = event.keyCode,\n\n                    // Check if one of the delete keys was pressed.\n                    isKeycodeDelete = /^(8|46)$/.test(keycode)\n\n                // For some reason IE clears the input value on “escape”.\n                if ( keycode == 27 ) {\n                    P.close()\n                    return false\n                }\n\n                // Check if `space` or `delete` was pressed or the picker is closed with a key movement.\n                if ( keycode == 32 || isKeycodeDelete || !STATE.open && P.component.key[keycode] ) {\n\n                    // Prevent it from moving the page and bubbling to doc.\n                    event.preventDefault()\n                    event.stopPropagation()\n\n                    // If `delete` was pressed, clear the values and close the picker.\n                    // Otherwise open the picker.\n                    if ( isKeycodeDelete ) { P.clear().close() }\n                    else { P.open() }\n                }\n            })\n        }\n\n\n        // Update the aria attributes.\n        aria(ELEMENT, {\n            haspopup: true,\n            expanded: false,\n            readonly: false,\n            owns: ELEMENT.id + '_root' + (P._hidden ? ' ' + P._hidden.id : '')\n        })\n    }\n\n\n    /**\n     * Prepare the root picker element with all bindings.\n     */\n    function prepareElementRoot() {\n\n        P.$root.\n\n            on({\n\n                // When something within the root is focused, stop from bubbling\n                // to the doc and remove the “focused” state from the root.\n                focusin: function( event ) {\n                    P.$root.removeClass( CLASSES.focused )\n                    event.stopPropagation()\n                },\n\n                // When something within the root holder is clicked, stop it\n                // from bubbling to the doc.\n                'mousedown click': function( event ) {\n\n                    var target = event.target\n\n                    // Make sure the target isn’t the root holder so it can bubble up.\n                    if ( target != P.$root.children()[ 0 ] ) {\n\n                        event.stopPropagation()\n\n                        // * For mousedown events, cancel the default action in order to\n                        //   prevent cases where focus is shifted onto external elements\n                        //   when using things like jQuery mobile or MagnificPopup (ref: #249 & #120).\n                        //   Also, for Firefox, don’t prevent action on the `option` element.\n                        if ( event.type == 'mousedown' && !$( target ).is( ':input' ) && target.nodeName != 'OPTION' ) {\n\n                            event.preventDefault()\n\n                            // Re-focus onto the element so that users can click away\n                            // from elements focused within the picker.\n                            ELEMENT.focus()\n                        }\n                    }\n                }\n            }).\n\n            // If there’s a click on an actionable element, carry out the actions.\n            on( 'click', '[data-pick], [data-nav], [data-clear], [data-close]', function() {\n\n                var $target = $( this ),\n                    targetData = $target.data(),\n                    targetDisabled = $target.hasClass( CLASSES.navDisabled ) || $target.hasClass( CLASSES.disabled ),\n\n                    // * For IE, non-focusable elements can be active elements as well\n                    //   (http://stackoverflow.com/a/2684561).\n                    activeElement = document.activeElement\n                    activeElement = activeElement && ( activeElement.type || activeElement.href ) && activeElement\n\n                // If it’s disabled or nothing inside is actively focused, re-focus the element.\n                if ( targetDisabled || activeElement && !$.contains( P.$root[0], activeElement ) ) {\n                    ELEMENT.focus()\n                }\n\n                // If something is superficially changed, update the `highlight` based on the `nav`.\n                if ( !targetDisabled && targetData.nav ) {\n                    P.set( 'highlight', P.component.item.highlight, { nav: targetData.nav } )\n                }\n\n                // If something is picked, set `select` then close with focus.\n                else if ( !targetDisabled && 'pick' in targetData ) {\n                    P.set( 'select', targetData.pick ).close( true )\n                }\n\n                // If a “clear” button is pressed, empty the values and close with focus.\n                else if ( targetData.clear ) {\n                    P.clear().close( true )\n                }\n\n                else if ( targetData.close ) {\n                    P.close( true )\n                }\n\n            }) //P.$root\n\n        aria( P.$root[0], 'hidden', true )\n    }\n\n\n     /**\n      * Prepare the hidden input element along with all bindings.\n      */\n    function prepareElementHidden() {\n\n        var name\n\n        if ( SETTINGS.hiddenName === true ) {\n            name = ELEMENT.name\n            ELEMENT.name = ''\n        }\n        else {\n            name = [\n                typeof SETTINGS.hiddenPrefix == 'string' ? SETTINGS.hiddenPrefix : '',\n                typeof SETTINGS.hiddenSuffix == 'string' ? SETTINGS.hiddenSuffix : '_submit'\n            ]\n            name = name[0] + ELEMENT.name + name[1]\n        }\n\n        P._hidden = $(\n            '<input ' +\n            'type=hidden ' +\n\n            // Create the name using the original input’s with a prefix and suffix.\n            'name=\"' + name + '\"' +\n\n            // If the element has a value, set the hidden value as well.\n            (\n                $ELEMENT.data('value') || ELEMENT.value ?\n                    ' value=\"' + P.get('select', SETTINGS.formatSubmit) + '\"' :\n                    ''\n            ) +\n            '>'\n        )[0]\n\n        $ELEMENT.\n\n            // If the value changes, update the hidden input with the correct format.\n            on('change.' + STATE.id, function() {\n                P._hidden.value = ELEMENT.value ?\n                    P.get('select', SETTINGS.formatSubmit) :\n                    ''\n            }).\n\n            // Insert the hidden input after the element.\n            after(P._hidden)\n    }\n\n\n    // Separated for IE\n    function focusToOpen( event ) {\n\n        // Stop the event from propagating to the doc.\n        event.stopPropagation()\n\n        // If it’s a focus event, add the “focused” class to the root.\n        if ( event.type == 'focus' ) {\n            P.$root.addClass( CLASSES.focused )\n        }\n\n        // And then finally open the picker.\n        P.open()\n    }\n\n\n    // Return a new picker instance.\n    return new PickerInstance()\n} //PickerConstructor\n\n\n\n/**\n * The default classes and prefix to use for the HTML classes.\n */\nPickerConstructor.klasses = function( prefix ) {\n    prefix = prefix || 'picker'\n    return {\n\n        picker: prefix,\n        opened: prefix + '--opened',\n        focused: prefix + '--focused',\n\n        input: prefix + '__input',\n        active: prefix + '__input--active',\n\n        holder: prefix + '__holder',\n\n        frame: prefix + '__frame',\n        wrap: prefix + '__wrap',\n\n        box: prefix + '__box'\n    }\n} //PickerConstructor.klasses\n\n\n\n/**\n * Check if the default theme is being used.\n */\nfunction isUsingDefaultTheme( element ) {\n\n    var theme,\n        prop = 'position'\n\n    // For IE.\n    if ( element.currentStyle ) {\n        theme = element.currentStyle[prop]\n    }\n\n    // For normal browsers.\n    else if ( window.getComputedStyle ) {\n        theme = getComputedStyle( element )[prop]\n    }\n\n    return theme == 'fixed'\n}\n\n\n\n/**\n * Get the width of the browser’s scrollbar.\n * Taken from: https://github.com/VodkaBears/Remodal/blob/master/src/jquery.remodal.js\n */\nfunction getScrollbarWidth() {\n\n    if ( $html.height() <= $window.height() ) {\n        return 0\n    }\n\n    var $outer = $( '<div style=\"visibility:hidden;width:100px\" />' ).\n        appendTo( 'body' )\n\n    // Get the width without scrollbars.\n    var widthWithoutScroll = $outer[0].offsetWidth\n\n    // Force adding scrollbars.\n    $outer.css( 'overflow', 'scroll' )\n\n    // Add the inner div.\n    var $inner = $( '<div style=\"width:100%\" />' ).appendTo( $outer )\n\n    // Get the width with scrollbars.\n    var widthWithScroll = $inner[0].offsetWidth\n\n    // Remove the divs.\n    $outer.remove()\n\n    // Return the difference between the widths.\n    return widthWithoutScroll - widthWithScroll\n}\n\n\n\n/**\n * PickerConstructor helper methods.\n */\nPickerConstructor._ = {\n\n    /**\n     * Create a group of nodes. Expects:\n     * `\n        {\n            min:    {Integer},\n            max:    {Integer},\n            i:      {Integer},\n            node:   {String},\n            item:   {Function}\n        }\n     * `\n     */\n    group: function( groupObject ) {\n\n        var\n            // Scope for the looped object\n            loopObjectScope,\n\n            // Create the nodes list\n            nodesList = '',\n\n            // The counter starts from the `min`\n            counter = PickerConstructor._.trigger( groupObject.min, groupObject )\n\n\n        // Loop from the `min` to `max`, incrementing by `i`\n        for ( ; counter <= PickerConstructor._.trigger( groupObject.max, groupObject, [ counter ] ); counter += groupObject.i ) {\n\n            // Trigger the `item` function within scope of the object\n            loopObjectScope = PickerConstructor._.trigger( groupObject.item, groupObject, [ counter ] )\n\n            // Splice the subgroup and create nodes out of the sub nodes\n            nodesList += PickerConstructor._.node(\n                groupObject.node,\n                loopObjectScope[ 0 ],   // the node\n                loopObjectScope[ 1 ],   // the classes\n                loopObjectScope[ 2 ]    // the attributes\n            )\n        }\n\n        // Return the list of nodes\n        return nodesList\n    }, //group\n\n\n    /**\n     * Create a dom node string\n     */\n    node: function( wrapper, item, klass, attribute ) {\n\n        // If the item is false-y, just return an empty string\n        if ( !item ) return ''\n\n        // If the item is an array, do a join\n        item = $.isArray( item ) ? item.join( '' ) : item\n\n        // Check for the class\n        klass = klass ? ' class=\"' + klass + '\"' : ''\n\n        // Check for any attributes\n        attribute = attribute ? ' ' + attribute : ''\n\n        // Return the wrapped item\n        return '<' + wrapper + klass + attribute + '>' + item + '</' + wrapper + '>'\n    }, //node\n\n\n    /**\n     * Lead numbers below 10 with a zero.\n     */\n    lead: function( number ) {\n        return ( number < 10 ? '0': '' ) + number\n    },\n\n\n    /**\n     * Trigger a function otherwise return the value.\n     */\n    trigger: function( callback, scope, args ) {\n        return typeof callback == 'function' ? callback.apply( scope, args || [] ) : callback\n    },\n\n\n    /**\n     * If the second character is a digit, length is 2 otherwise 1.\n     */\n    digits: function( string ) {\n        return ( /\\d/ ).test( string[ 1 ] ) ? 2 : 1\n    },\n\n\n    /**\n     * Tell if something is a date object.\n     */\n    isDate: function( value ) {\n        return {}.toString.call( value ).indexOf( 'Date' ) > -1 && this.isInteger( value.getUTCDate() )\n    },\n\n\n    /**\n     * Tell if something is an integer.\n     */\n    isInteger: function( value ) {\n        return {}.toString.call( value ).indexOf( 'Number' ) > -1 && value % 1 === 0\n    },\n\n\n    /**\n     * Create ARIA attribute strings.\n     */\n    ariaAttr: ariaAttr\n} //PickerConstructor._\n\n\n\n/**\n * Extend the picker with a component and defaults.\n */\nPickerConstructor.extend = function( name, Component ) {\n\n    // Extend jQuery.\n    $.fn[ name ] = function( options, action ) {\n\n        // Grab the component data.\n        var componentData = this.data( name )\n\n        // If the picker is requested, return the data object.\n        if ( options == 'picker' ) {\n            return componentData\n        }\n\n        // If the component data exists and `options` is a string, carry out the action.\n        if ( componentData && typeof options == 'string' ) {\n            return PickerConstructor._.trigger( componentData[ options ], componentData, [ action ] )\n        }\n\n        // Otherwise go through each matched element and if the component\n        // doesn’t exist, create a new picker using `this` element\n        // and merging the defaults and options with a deep copy.\n        return this.each( function() {\n            var $this = $( this )\n            if ( !$this.data( name ) ) {\n                new PickerConstructor( this, name, Component, options )\n            }\n        })\n    }\n\n    // Set the defaults.\n    $.fn[ name ].defaults = Component.defaults\n} //PickerConstructor.extend\n\n\n\nfunction aria(element, attribute, value) {\n    if ( $.isPlainObject(attribute) ) {\n        for ( var key in attribute ) {\n            ariaSet(element, key, attribute[key])\n        }\n    }\n    else {\n        ariaSet(element, attribute, value)\n    }\n}\nfunction ariaSet(element, attribute, value) {\n    element.setAttribute(\n        (attribute == 'role' ? '' : 'aria-') + attribute,\n        value\n    )\n}\nfunction ariaAttr(attribute, data) {\n    if ( !$.isPlainObject(attribute) ) {\n        attribute = { attribute: data }\n    }\n    data = ''\n    for ( var key in attribute ) {\n        var attr = (key == 'role' ? '' : 'aria-') + key,\n            attrVal = attribute[key]\n        data += attrVal == null ? '' : attr + '=\"' + attribute[key] + '\"'\n    }\n    return data\n}\n\n\n\n// Expose the picker constructor.\nreturn PickerConstructor\n\n\n}));\n","import AppDispatcher from '../dispatcher/AppDispatcher';\nimport AppStateConstants from '../constants/AppStateConstants';\n\nconst AppStateActions = {\n\n  update: function(updates) {\n    AppDispatcher.dispatch({\n      actionType: AppStateConstants.APP_STATE_UPDATE,\n      updates: updates\n    });\n  },\n\n  reset: function() {\n    AppDispatcher.dispatch({\n      actionType: AppStateConstants.APP_STATE_RESET,\n    });\n  }\n\n};\n\nexport default AppStateActions;\n","import _ from 'lodash';\nimport ExplorerUtils from '../utils/ExplorerUtils';\nimport SharedValidators from './SharedValidators';\nimport StepValidations from './StepValidations';\nimport RunValidations from '../utils/RunValidations';\n\nfunction isNotFunnel(model) {\n  return model.query.analysis_type !== 'funnel';\n}\n\nexport default {\n\n  analysis_type: {\n\n    msg: 'Choose an Analysis Type.',\n\n    validate: function(model) {\n      return (typeof model.query.analysis_type ==='string' && model.query.analysis_type.length > 0);\n    }\n\n  },\n\n  event_collection: {\n\n    msg: 'Choose an Event Collection.',\n\n    shouldRun: isNotFunnel,\n\n    validate: function(model) {\n      return (typeof model.query.event_collection ==='string' && model.query.event_collection.length > 0);\n    }\n\n  },\n\n  target_property: {\n\n    msg: 'Choose a Target Property.',\n\n    shouldRun: function(model) {\n      return ExplorerUtils.shouldHaveTarget(model);\n    },\n\n    validate: function(model) {\n      return (typeof model.query.target_property ==='string' && model.query.target_property.length > 0);\n    }\n\n  },\n\n  percentile_value: {\n\n    msg: 'Choose a Percentile Value.',\n\n    shouldRun: function(model) {\n      return model.query.analysis_type === 'percentile';\n    },\n\n    validate: function(model) {\n      return model.query.percentile !== null && model.query.percentile !== '' && typeof model.query.percentile === 'number';\n    }\n\n  },\n\n  filters: {\n\n    shouldRun: isNotFunnel,\n\n    msg: 'One of your filters is invalid.',\n\n    validate: function(model) {\n      return SharedValidators.filters(model.query.filters);\n    }\n\n  },\n\n  steps: {\n\n    msg: 'One of your funnel steps is invalid.',\n\n    shouldRun: function(model) {\n      return model.query.analysis_type === 'funnel';\n    },\n\n    validate: function(model) {\n      if (!model.query.steps) return false;\n      var isValid = true;\n      for (var i=0; i<model.query.steps.length; i++) {\n        RunValidations.run(StepValidations, model.query.steps[i]);\n        if (!model.query.steps[i].isValid) isValid = false;\n      }\n      return isValid;\n    },\n\n  },\n\n  time: {\n\n    shouldRun: isNotFunnel,\n\n    validate: function(model) {\n      return SharedValidators.time(model.query.time);\n    }\n\n  },\n\n  query_name: {\n\n    msg: 'You must give your saved query a name.',\n\n    shouldRun: function(model) {\n      return model.saving;\n    },\n\n    validate: function(model) {\n      var name = model.query_name;\n      return (name !== null && name !== undefined && typeof name === \"string\" && name.length > 0);\n    }\n\n  },\n\n  refresh_rate: {\n\n    msg: 'Refresh rate must be between 4 and 24 hours.',\n\n    validate: function(model) {\n      var rate = model.refresh_rate;\n      return (typeof rate !== 'number' || (rate >= 1440 && rate <= 86400) || rate == 0);\n    }\n\n  },\n\n  email: {\n\n    msg: 'A valid email address is required.',\n\n    shouldRun: ExplorerUtils.isEmailExtraction,\n\n    validate: function(model) {\n      return new RegExp(/.+@.+\\..+/i).test(model.query.email);\n    }\n\n  },\n\n  latest: {\n\n    msg: 'Latest must be a number.',\n\n    shouldRun: ExplorerUtils.isEmailExtraction,\n\n    validate: function(model) {\n      var value = model.query.latest;\n      if (!value) return true;\n      var n = ~~Number(value);\n      return String(n) === value && n >= 0;\n    }\n\n  }\n\n};\n","import _ from 'lodash';\n\nconst ChartTypeUtils = {\n  getQueryDataType: function(query){\n    var isInterval = typeof query.interval === \"string\";\n    var isGroupBy = typeof query.group_by === \"string\" || (query.group_by instanceof Array && query.group_by.length === 1);\n    var is2xGroupBy = query.group_by instanceof Array && query.group_by.length === 2;\n    var dataType;\n\n    if (query.analysis_type === \"funnel\") {\n      dataType = 'cat-ordinal';\n    }\n    else if (query.analysis_type === \"extraction\") {\n      dataType = 'extraction';\n    }\n    else if (query.analysis_type === \"select_unique\") {\n      dataType = 'nominal';\n    }\n\n    // metric\n    else if (!isGroupBy && !isInterval && !is2xGroupBy) {\n      dataType = 'singular';\n    }\n\n    // group_by, no interval\n    else if (isGroupBy && !isInterval) {\n      dataType = 'categorical';\n    }\n\n    // interval, no group_by\n    else if (isInterval && (!isGroupBy && !is2xGroupBy)) {\n      dataType = 'chronological';\n    }\n\n    // interval, group_by\n    else if (isInterval && (isGroupBy || is2xGroupBy)) {\n      dataType = 'cat-chronological';\n    }\n\n    // 2x group_by\n    // TODO: research possible dataType options\n    else if (!isInterval && is2xGroupBy) {\n      dataType = 'categorical';\n    }\n\n    return dataType;\n  },\n\n  getChartTypeOptions: function(query) {\n    var dataTypes = {\n      'singular':           ['metric'],\n      'categorical':        ['pie', 'bar', 'donut', 'table'],\n      'cat-interval':       ['area', 'bar', 'line', 'spline', 'area-spline', 'step', 'area-step', 'table'],\n      'cat-ordinal':        ['area', 'bar', 'line', 'spline', 'area-spline', 'step', 'area-step', 'table'],\n      'chronological':      ['area', 'bar', 'line', 'spline', 'area-spline', 'step', 'area-step', 'table'],\n      'cat-chronological':  ['area', 'bar', 'line', 'spline', 'area-spline', 'step', 'area-step', 'table'],\n      'nominal':            ['table'],\n      'extraction':         ['table']\n    };\n    var queryDataType = ChartTypeUtils.getQueryDataType(query);\n    return dataTypes[queryDataType].concat(['JSON']);\n  },\n\n  responseSupportsChartType: function(query, chartType) {\n    return _.includes(ChartTypeUtils.getChartTypeOptions(query), chartType);\n  },\n\n  isTableChartType: function(chartType) {\n    return chartType == 'table';\n  }\n}\n\nexport default ChartTypeUtils;\n","import React from 'react';\nimport _ from 'lodash';\n\nfunction noticeExists(notice) {\n  return notice && !_.isEmpty(notice);\n}\n\nconst NoticeComponent = React.createClass({\n\n  close: function(event) {\n    event.preventDefault();\n    this.setState({ open: false });\n    this.props.closeCallback();\n  },\n\n  getDefaultProps: function() {\n    return {\n      notice: {},\n      closeCallback: function(){},\n      closable: true\n    };\n  },\n\n  getInitialState: function() {\n    return {\n      open: noticeExists(this.props.notice)\n    };\n  },\n\n  componentWillReceiveProps: function(nextProps) {\n    this.setState({ open: noticeExists(nextProps.notice) });\n  },\n\n  render: function() {\n    var classes = 'notice-component alert';\n    if (!this.state.open) {\n      classes += ' hide';\n    }\n    if (this.props.notice.type) {\n      var type = this.props.notice.type;\n      if (type === 'error') type = 'danger';\n      classes += ' alert-' + type;\n    } else {\n      classes += ' alert-info';\n    }\n\n    var icon;\n    if (this.props.notice.icon) {\n      icon = <span className={\"icon glyphicon glyphicon-\" + this.props.notice.icon}></span>\n    }\n\n    var closeBtn;\n    if (this.props.closable) {\n      closeBtn = <button className=\"close\" onClick={this.close}>&times;</button>;\n    }\n\n    return (\n      <div className={classes} key=\"notice\" ref=\"notice\">\n        {closeBtn}\n        <p>{icon} <strong>{this.props.notice.text || ''}</strong></p>\n      </div>\n    );\n  }\n\n});\n\nexport default NoticeComponent;\n","import _ from 'lodash';\nimport AppDispatcher from '../dispatcher/AppDispatcher';\nimport ProjectConstants from '../constants/ProjectConstants';\nimport ProjectStore from '../stores/ProjectStore';\nimport ProjectUtils from '../utils/ProjectUtils';\nimport ExplorerUtils from '../utils/ExplorerUtils';\nimport FormatUtils from '../utils/FormatUtils';\n\nconst ProjectActions = {\n\n  create: function(attrs) {\n    AppDispatcher.dispatch({\n      actionType: ProjectConstants.PROJECT_CREATE,\n      attrs: attrs\n    });\n  },\n\n  update: function(id, updates) {\n    var project = ProjectStore.getProject();\n\n    AppDispatcher.dispatch({\n      actionType: ProjectConstants.PROJECT_UPDATE,\n      id: project.id,\n      updates: updates\n    });\n  },\n\n  fetchProjectCollections: function(client) {\n    var project = ProjectStore.getProject();\n    if (!project) console.error(\"Cannot fetchProjectCollections: No project model has been created yet.\");\n    var authKey = client.masterKey() || client.readKey();\n\n    return client\n      .get({\n        url: client.url('projectId'),\n        api_key: authKey\n      })\n      .then(function(res){\n        var schema = _.assign({}, project.schema);\n        _.each(res.events, function(collection) {\n          schema[collection.name] = _.assign(collection, {\n            properties: {},\n            sortedProperties: [],\n            loading: false,\n            recentEvents: null\n          });\n        });\n        ProjectActions.update(project.id, {\n          schema: schema,\n          eventCollections: FormatUtils.sortItems(_.keys(schema)),\n          loading: false\n        });\n      })\n      .catch(function(err){\n        console.error('Error fetching project collections: ', err.stack);\n      });\n  },\n\n  fetchCollectionSchema: function(client, collectionName) {\n    var project = ProjectStore.getProject();\n    if (project.eventCollections.indexOf(collectionName) < 0) {\n      return false;\n    }\n    ProjectActions.updateEventCollection(collectionName, {\n      loading: true\n    });\n    return client\n      .get({\n        url: client.url('events', encodeURIComponent(collectionName)),\n        api_key: client.masterKey()\n      })\n      .then(function(res) {\n        ProjectActions.updateEventCollection(collectionName, {\n          properties: res.properties,\n          sortedProperties: FormatUtils.sortItems(_.keys(res.properties)),\n          loading: false\n        });\n      })\n      .catch(function(err){\n        console.error('Error fetching project collections: ', err.stack);\n      });\n  },\n\n  updateEventCollection: function(collectionName, updates) {\n    var project = ProjectStore.getProject();\n    AppDispatcher.dispatch({\n      actionType: ProjectConstants.PROJECT_UPDATE_EVENT_COLLECTION,\n      id: project.id,\n      collectionName: collectionName,\n      updates: updates\n    });\n  },\n\n  fetchRecentEventsForCollection: function(client, eventCollection) {\n    var project = ProjectStore.getProject();\n    ProjectActions.updateEventCollection(eventCollection, {\n      loading: true\n    });\n    ExplorerUtils.runQuery({\n      client: client,\n      query: {\n        event_collection: eventCollection,\n        analysis_type: 'extraction',\n        latest: 10\n      },\n      success: function(res) {\n        ProjectActions.updateEventCollection(eventCollection, {\n          recentEvents: res.result\n        });\n      },\n      error: function(err) {\n        console.error(\"Error requesting latest events for event collection: \" + eventCollection, err.stack);\n      },\n      complete: function() {\n        ProjectActions.updateEventCollection(eventCollection, {\n          loading: false\n        });\n      }\n    });\n  }\n\n};\n\nexport default ProjectActions;\n","import React from 'react';\nimport _ from 'lodash';\n\nconst LoaderComponent = React.createClass({\n\n  toggle: function(visible) {\n    this.props.visible = visible;\n    this.forceUpdate();\n  },\n\n  // React Methods\n\n  getDefaultProps: function() {\n    return {\n      visible: false,\n      additionalClasses: false\n    };\n  },\n\n  render: function() {\n    var classes = \"explorer-loader\";\n    if (!this.props.visible) classes += \" hide\";\n    if (this.props.additionalClasses) classes += \" \" + this.props.additionalClasses;\n\n    return (\n      <div className={classes}>\n        <div className=\"msg\">\n          <div className=\"explorer-spinner\">\n            <div className=\"rect1\"></div>\n            <div className=\"rect2\"></div>\n            <div className=\"rect3\"></div>\n            <div className=\"rect4\"></div>\n            <div className=\"rect5\"></div>\n          </div>\n          Loading...\n        </div>\n      </div>\n    );\n  }\n\n});\n\nexport default LoaderComponent;\n","import _ from 'lodash';\nimport FormatUtils from '../utils/FormatUtils';\n\nfunction isGeoCoercionType(model) {\n  return model.coercion_type === 'Geo';\n}\n\nexport default {\n\n  property_name: {\n\n    msg: 'Choose a property name',\n\n    validate: function(model) {\n      return (typeof model.property_name === 'string' && model.property_name.length > 0);\n    }\n\n  },\n\n  operator: {\n\n    msg: 'Choose an operator',\n\n    validate: function(model) {\n      return (typeof model.operator === 'string' && model.operator.length > 0);\n    }\n\n  },\n\n  property_value: {\n\n    msg: 'Choose a property value.',\n\n    shouldRun: function(model) {\n      return !isGeoCoercionType(model);\n    },\n\n    validate: function(model) {\n      var value = model.property_value;\n      var coercionType = model.coercion_type;\n\n      if (coercionType == 'List') {\n        return FormatUtils.parseList(value) ? true : false;\n      } else if (coercionType === 'Null' || coercionType === 'Boolean') {\n        return true;\n      } else if (coercionType === 'Number') {\n        return _.isNumber(value);\n      } else if (coercionType === 'String') {\n        return true;\n      } else {\n        return value ? true : false;\n      }\n    }\n\n  },\n\n  coercion_type: {\n\n    msg: 'Choose a coercion type',\n\n    validate: function(model) {\n      return (typeof model.coercion_type ==='string' && model.coercion_type.length > 0);\n    }\n\n  },\n\n  coordinates: {\n\n    msg: 'Provide all coordinates.',\n\n    shouldRun: isGeoCoercionType,\n\n    validate: function(model) {\n      var value = model.property_value.coordinates;\n      var valid = _.isArray(value) && value.length === 2;\n      if (!valid) return valid;\n\n      for(var i=0; i<value.length; i++) {\n        if (!valid) break;\n        valid = _.isNumber(value[i]);\n      }\n      return valid;\n    }\n\n  },\n\n  max_distance_miles: {\n\n    msg: 'Provide a max distance in miles.',\n\n    shouldRun: isGeoCoercionType,\n\n    validate: function(model) {\n      var value = model.property_value.max_distance_miles;\n      return value && _.isNumber(value);\n    }\n\n  }\n\n};\n","import Qs from 'qs';\nimport _ from 'lodash';\n\nexport default {\n\n  getSearchString: function() {\n    return window.location.search;\n  },\n\n  updateSearchString: function(queryStringData) {\n    var urlPath;\n    if (_.keys(queryStringData).length) {\n      urlPath = '?' + Qs.stringify(queryStringData);\n    } else {\n      urlPath = window.location.origin + window.location.pathname\n    }\n    window.history.pushState({ model: queryStringData }, \"\", urlPath);\n  },\n\n  getQueryAttributes: function() {\n    return Qs.parse(this.getSearchString().replace('?', ''), { depth: 7 });\n  }\n\n};\n","import _ from 'lodash';\nimport React from 'react';\nimport Filter from './filter.js';\nimport Modal from './modal.js';\nimport ProjectUtils from '../../utils/ProjectUtils';\nimport FilterUtils from '../../utils/FilterUtils';\n\nconst FilterManager = React.createClass({\n\n  propTypes: {\n    eventCollection:  React.PropTypes.string,\n    propertyNames:    React.PropTypes.array,\n    filters:          React.PropTypes.array,\n    addFilter:        React.PropTypes.func.isRequired,\n    removeFilter:     React.PropTypes.func.isRequired,\n    handleChange:     React.PropTypes.func.isRequired,\n    getPropertyType:  React.PropTypes.func.isRequired\n  },\n\n  open: function() {\n    this.refs.modal.open();\n  },\n\n  close: function() {\n    this.refs.modal.close();\n  },\n\n  addFilter: function(e) {\n    e.preventDefault();\n    this.props.addFilter();\n  },\n\n  removeFilter: function(index) {\n    this.props.removeFilter(index);\n  },\n\n  handleChange: function(index, name, value, callback) {\n    var updates = _.cloneDeep(this.props.filters[index]);\n\n    if (!_.isNull(name.match('coordinates'))) {\n      var coordinateIndex = parseInt(name.split('.')[1]);\n      updates.property_value.coordinates[coordinateIndex] = FilterUtils.coerceGeoValue(value);\n    } else if (name === 'max_distance_miles' && updates.coercion_type === 'Geo') {\n      updates.property_value[name] = FilterUtils.coerceGeoValue(value);\n    } else {\n      updates[name] = value;\n    }\n\n    this.props.handleChange(index, updates);\n\n    if (callback){\n      callback();\n    }\n  },\n\n  buildFilterNodes: function() {\n    var filterNodes = this.props.filters.map(function(filter, index) {\n      return(\n        <Filter key={index}\n                index={index}\n                filter={filter}\n                propertyType={this.props.getPropertyType(this.props.eventCollection, filter.property_name)}\n                eventCollection={this.props.eventCollection}\n                propertyNames={this.props.propertyNames}\n                handleChange={this.handleChange}\n                onPressEnter={this.close}\n                removeFilter={this.removeFilter}\n                filterOperators={ProjectUtils.getConstant('FILTER_OPERATORS')} />\n      );\n    }.bind(this));\n\n    return (\n      <div>\n        {filterNodes}\n        <div className=\"filter-buttons\">\n          <a href=\"#\" className=\"add-filter btn btn-primary\" onClick={this.addFilter}>\n            <i className=\"icon glyphicon glyphicon-plus margin-right-tiny\"></i>\n            Add another filter\n          </a>\n        </div>\n      </div>\n    )\n  },\n\n  noFiltersMarkup: function() {\n    return (\n      <div className=\"row\">\n        <div className=\"col-md-10 col-md-offset-1\">\n          <div className=\"no-filters-msg callout\">\n            <p className=\"lead\">\n              <i className=\"icon glyphicon glyphicon-info-sign margin-right-tiny\"></i>\n              Please select an Event Collection before making a filter.\n            </p>\n          </div>\n        </div>\n      </div>\n    );\n  },\n\n  render: function() {\n    var filterContent = this.props.eventCollection ? this.buildFilterNodes() : this.noFiltersMarkup();\n\n    return (\n      <Modal ref=\"modal\"\n             title=\"Filters\"\n             size=\"large\"\n             onClose={this.modalClosed}\n             modalClasses=\"filters-modal\"\n             footerBtns={[\n              {\n                text: 'Done',\n                classes: 'btn-success',\n                iconName: 'ok-circle'\n              }\n            ]}>\n        <div className=\"filters\">\n          {filterContent}\n        </div>\n      </Modal>\n    );\n  }\n});\n\nexport default FilterManager;\n","import _ from 'lodash';\nimport React from 'react';\nimport ReactSelect from './react_select.js';\n\nconst premadeTimes = [\n  '12:00 AM',\n  '12:15 AM',\n  '12:30 AM',\n  '12:45 AM',\n  '01:00 AM',\n  '01:15 AM',\n  '01:30 AM',\n  '01:45 AM',\n  '02:00 AM',\n  '02:15 AM',\n  '02:30 AM',\n  '02:45 AM',\n  '03:00 AM',\n  '03:15 AM',\n  '03:30 AM',\n  '03:45 AM',\n  '04:00 AM',\n  '04:15 AM',\n  '04:30 AM',\n  '04:45 AM',\n  '05:00 AM',\n  '05:15 AM',\n  '05:30 AM',\n  '05:45 AM',\n  '06:00 AM',\n  '06:15 AM',\n  '06:30 AM',\n  '06:45 AM',\n  '07:00 AM',\n  '07:15 AM',\n  '07:30 AM',\n  '07:45 AM',\n  '08:00 AM',\n  '08:15 AM',\n  '08:30 AM',\n  '08:45 AM',\n  '09:00 AM',\n  '09:15 AM',\n  '09:30 AM',\n  '09:45 AM',\n  '10:00 AM',\n  '10:15 AM',\n  '10:30 AM',\n  '10:45 AM',\n  '11:00 AM',\n  '11:15 AM',\n  '11:30 AM',\n  '11:45 AM',\n  '12:00 PM',\n  '12:15 PM',\n  '12:30 PM',\n  '12:45 PM',\n  '01:00 PM',\n  '01:15 PM',\n  '01:30 PM',\n  '01:45 PM',\n  '02:00 PM',\n  '02:15 PM',\n  '02:30 PM',\n  '02:45 PM',\n  '03:00 PM',\n  '03:15 PM',\n  '03:30 PM',\n  '03:45 PM',\n  '04:00 PM',\n  '04:15 PM',\n  '04:30 PM',\n  '04:45 PM',\n  '05:00 PM',\n  '05:15 PM',\n  '05:30 PM',\n  '05:45 PM',\n  '06:00 PM',\n  '06:15 PM',\n  '06:30 PM',\n  '06:45 PM',\n  '07:00 PM',\n  '07:15 PM',\n  '07:30 PM',\n  '07:45 PM',\n  '08:00 PM',\n  '08:15 PM',\n  '08:30 PM',\n  '08:45 PM',\n  '09:00 PM',\n  '09:15 PM',\n  '09:30 PM',\n  '09:45 PM',\n  '10:00 PM',\n  '10:15 PM',\n  '10:30 PM',\n  '10:45 PM',\n  '11:00 PM',\n  '11:15 PM',\n  '11:30 PM',\n  '11:45 PM',\n];\n\nfunction parseTime(timeStr, dt) {\n  if (!dt) {\n    dt = new Date();\n  }\n\n  var time = timeStr.match(/(\\d+)(?::(\\d\\d))?\\s*(p?)/i);\n  if (!time) {\n    return NaN;\n  }\n  var hours = parseInt(time[1], 10);\n  if (hours == 12 && !time[3]) {\n    hours = 0;\n  }\n  else {\n    hours += (hours < 12 && time[3]) ? 12 : 0;\n  }\n\n  dt.setHours(hours);\n  dt.setMinutes(parseInt(time[2], 10) || 0);\n  dt.setSeconds(0, 0);\n  return dt;\n}\n\nvar Timepicker = React.createClass({\n\n  validateTime: function(value) {\n    var parsed = parseTime(value);\n    if (parsed instanceof Date) {\n      this.setState({ errorMsg: false });\n      return true;\n    } else {\n      this.setState({ errorMsg: 'Invalid time' });\n      return false;\n    }\n  },\n\n  handleBlur: function(event) {\n    if (this.validateTime(event.target.value)) {\n      this.props.handleBlur(event.target.name, parseTime(event.target.value).getTime());\n    }\n  },\n\n  handleSelection: function(name, selection) {\n    if (this.validateTime(selection)) {\n      this.props.handleSelection(name, parseTime(selection).getTime());\n    }\n  },\n\n  handleChange: function(name, value) {\n    this.setState({ value: value });\n    this.props.handleChange(name, value);\n  },\n\n  // React methods\n\n  getInitialState: function() {\n    return {\n      errorMsg: false,\n      value: this.props.value\n    };\n  },\n\n  getDefaultProps: function () {\n    return {\n      refValue: 'timepicker',\n      label: false,\n      handleBlur: function(){},\n      handleChange: function(){},\n      handleSelection: function(){},\n      placeholder: '',\n      classes: 'timepicker-wrapper form-group'\n    };\n  },\n\n  componentWillReceiveProps: function(nextProps) {\n    if (nextProps.value != this.state.value) {\n      this.setState({ value: nextProps.value });\n    }\n  },\n\n  render: function() {\n    var label = this.props.label ? <label htmlFor={this.props.name}>{this.props.label}</label> : null;\n    var errorMsg = this.state.errorMsg ? <p>{this.state.errorMsg}</p> : null;\n\n    return (\n      <div className={this.props.classes}>\n        {label}\n        <ReactSelect ref={this.props.refValue}\n                     name={this.props.name}\n                     inputClasses=\"form-control\"\n                     items={premadeTimes}\n                     handleBlur={this.handleBlur}\n                     handleChange={this.handleChange}\n                     handleSelection={this.handleSelection}\n                     value={this.state.value}\n                     title={this.props.name}\n                     sort={true} />\n        {errorMsg}\n      </div>\n    );\n  }\n});\n\nexport default Timepicker;\n","import _ from 'lodash';\nimport React from 'react';\nimport moment from 'moment';\n\nimport pickadate from '../../../vendor/picker.js';\nimport '../../../vendor/picker.date.js';\nimport '../../../vendor/picker.time.js';\n\nconst Datepicker = React.createClass({\n\n  handleOnBlur: function(event) {\n    this.destroyPicker();\n    var value = event.target.value;\n    var isValid = moment(new Date(value)).isValid();\n\n    if (isValid) {\n      this.props.onBlur(event);\n      this.setState({ errorMsg: false });\n    } else if (value && !isValid) {\n      this.setState({ errorMsg: 'Invalid' });\n    }\n  },\n\n  onFocus: function() {\n    var minimum = this.props.minimum;\n    $(this.refs[this.props.refValue]).pickadate({\n      format: 'mmm d, yyyy',\n      editable: true,\n      min: minimum,\n      onSet: _.bind(function(args) {\n        this.props.onSet(this.props.name, new Date(this.refs.datepicker.value));\n      }, this)\n    });\n  },\n\n  destroyPicker: function() {\n    var picker = $(this.refs[this.props.refValue]).pickadate('picker');\n    if (picker) picker.stop();\n  },\n\n  // React methods\n\n  getInitialState: function() {\n    return {\n      errorMsg: false\n    };\n  },\n\n  getDefaultProps: function () {\n    return {\n      refValue: 'datepicker',\n      label: false,\n      onChange: function(){},\n      placeholder: '',\n      classes: 'datepicker-wrapper form-group',\n      onSet: function(){}\n    };\n  },\n\n  render: function() {\n    var label = this.props.label ? <label htmlFor={this.props.name}>{this.props.label}</label> : null;\n    var errorMsg = this.state.errorMsg ? <p>{this.state.errorMsg}</p> : '';\n\n    return (\n      <div className={this.props.classes}>\n        {label}\n        <input type=\"text\"\n               ref={this.props.refValue}\n               name={this.props.name}\n               className=\"form-control\"\n               value={this.props.value}\n               onChange={this.props.onChange}\n               onBlur={this.handleOnBlur}\n               onFocus={this.onFocus}\n               placeholder={this.props.placeholder}\n               autoComplete=\"off\" />\n        {errorMsg}\n      </div>\n    );\n  }\n});\n\nexport default Datepicker;\n","import _ from 'lodash';\nimport moment from 'moment';\nimport React from 'react';\nimport AbsolutePicker from './absolute_picker.js';\nimport RelativePicker from './relative_picker.js';\nimport FieldsToggle from './fields_toggle.js';\nimport ReactSelect from './react_select.js';\nimport Timezone from './timezone.js';\nimport ExplorerActions from '../../actions/ExplorerActions';\nimport TimeframeUtils from '../../utils/TimeframeUtils';\nimport ProjectUtils from '../../utils/ProjectUtils';\n\nfunction relativeDefaults() {\n  return {\n    relativity: 'this',\n    amount: '14',\n    sub_timeframe: 'days'\n  };\n}\n\nfunction absoluteDefaults() {\n  return {\n    start: new Date(moment().subtract(1, 'days').startOf('day').format()),\n    end: new Date(moment().startOf('day').format())\n  };\n}\n\nvar Timeframe = React.createClass({\n\n  toggleTimeframeType: function(event) {\n    event.preventDefault();\n    var type = event.currentTarget.dataset.type;\n\n    this.props.handleChange('time', (type === 'absolute') ? absoluteDefaults() : relativeDefaults());\n  },\n\n  isAbsolute: function() {\n    return TimeframeUtils.timeframeType(this.props.time) === 'absolute';\n  },\n\n  isRelative: function() {\n    return TimeframeUtils.timeframeType(this.props.time) === 'relative';\n  },\n\n  // React Methods\n\n  render: function() {\n    var timezone = this.props.timezone || ProjectUtils.getConstant('DEFAULT_TIMEZONE');\n\n    if (this.isAbsolute()) {\n      var timeframePicker = <AbsolutePicker time={this.props.time}\n                            handleChange={this.props.handleChange} />;\n    } else {\n      var timeframePicker = <RelativePicker relativeIntervalTypes={ProjectUtils.getConstant('RELATIVE_INTERVAL_TYPES')}\n                                            time={this.props.time}\n                                            handleChange={this.props.handleChange} />;\n    }\n\n    return (\n      <div className=\"timeframe\">\n        <div className=\"field-component\">\n          <label>Timeframe</label>\n          <ul className=\"nav nav-pills\" role=\"tablist\">\n            <li className={this.isRelative() ? 'active' : ''}>\n              <a href=\"#\" className=\"relative-tab\" data-type=\"relative\" onClick={this.toggleTimeframeType}>Relative</a>\n            </li>\n            <li className={this.isAbsolute() ? 'active' : ''}>\n              <a href=\"#\" className=\"absolute-tab\" data-type=\"absolute\" onClick={this.toggleTimeframeType}>Absolute</a>\n            </li>\n          </ul>\n          {timeframePicker}\n          <Timezone timezone={this.props.timezone}\n                    timeframe_type={TimeframeUtils.timeframeType(this.props.time)}\n                    handleChange={this.props.handleChange} />\n        </div>\n      </div>\n    );\n  }\n});\n\nexport default Timeframe;\n","import React from 'react';\nimport _ from 'lodash';\n\n// Components\nimport ReactSelect from '../../common/react_select.js';\n\nconst SelectField = React.createClass({\n\n  getDefaultProps: function() {\n    return {\n      sort: false,\n      inputClasses: []\n    }\n  },\n\n  buildBrowseEventsLink: function() {\n    if (this.props.onBrowseEvents) {\n      return (\n        <button className=\"btn btn-link field-secondary-control\" title=\"Browse event collections\" type=\"button\" onClick={this.props.onBrowseEvents} id=\"browse-event-collections\">\n          <span className=\"icon glyphicon glyphicon-search\"></span> Preview collections\n        </button>\n      );\n    }\n  },\n\n  // React methods\n\n  render: function() {\n    var requiredNote = (this.props.requiredLabel) ? <small>(required)</small> : null;\n\n    return (\n      <div className=\"field-component\">\n        <label htmlFor={this.props.name}>{this.props.label} {requiredNote}</label>\n        <ReactSelect ref=\"select\"\n                     name={this.props.name}\n                     inputClasses={this.props.inputClasses.join(' ') + ' form-control'}\n                     items={this.props.options}\n                     handleChange={this.props.handleChange}\n                     value={this.props.value}\n                     sort={this.props.sort} />\n        {this.buildBrowseEventsLink()}\n      </div>\n    );\n  }\n\n});\n\nexport default SelectField;\n","import keyMirror from 'keymirror';\n\nexport default keyMirror({\n  NOTICE_CREATE: null,\n  NOTICE_CLEAR_ALL: null\n});\n","import _ from 'lodash';\nimport FormatUtils from '../utils/FormatUtils';\nimport SharedValidators from './SharedValidators';\n\nexport default {\n\n  event_collection: {\n\n    msg: 'Choose an Event Collection.',\n\n    validate: function(model) {\n      return (typeof model.event_collection ==='string' && model.event_collection.length > 0);\n    }\n\n  },\n\n  actor_property: {\n\n    msg: 'You must select an actor property',\n\n    validate: function(model) {\n      return (typeof model.actor_property ==='string' && model.actor_property.length > 0);\n    },\n\n  },\n\n  time: {\n\n    validate: function(model) {\n      return SharedValidators.time(model.time);\n    }\n\n  },\n\n  filters: {\n\n    msg: 'One of your filters is invalid.',\n\n    validate: function(model) {\n      return SharedValidators.filters(model.filters);\n    }\n\n  },\n\n\n  optional: {\n\n    msg: 'You must select whether this step is optional.',\n\n    validate: function(model) {\n      if (FormatUtils.isNullOrUndefined(model.optional)) return false;\n      return typeof model.optional === 'boolean';\n    }\n\n  },\n\n  inverted: {\n\n    msg: 'You must select whether this step is inverted.',\n\n    validate: function(model) {\n      if (FormatUtils.isNullOrUndefined(model.inverted)) return false;\n      return typeof model.inverted === 'boolean';\n    }\n\n  },\n\n  with_actors: {\n\n    msg: '\"with_actors\" must be set to either true or false',\n\n    validate: function(model) {\n      if (FormatUtils.isNullOrUndefined(model.with_actors)) return false;\n      return typeof model.with_actors === 'boolean';\n    }\n\n  },\n\n};\n","import _ from 'lodash';\nimport RunValidations from '../utils/RunValidations';\nimport FilterValidations from '../validations/FilterValidations';\nimport TimeframeUtils from '../utils/TimeframeUtils';\nimport FilterUtils from '../utils/FilterUtils';\n\nexport default {\n\n  filters: function(filters) {\n    if (!filters || (_.isArray(filters) && !filters.length)) return true;\n    var isValid = true\n    for (var i=0; i<filters.length; i++) {\n      if (!FilterUtils.isComplete(filters[i])) continue;\n      RunValidations.run(FilterValidations, filters[i]);\n      if (!filters[i].isValid) isValid = false\n    }\n    return isValid;\n  },\n\n  time: function(time) {\n    var defaultError = \"You must provide a timeframe.\";\n\n    if (!time) return defaultError;\n    if (TimeframeUtils.timeframeType(time) === 'relative') {\n      if (time.relativity && time.amount && time.sub_timeframe) return true;\n      return \"You must choose all 3 options for relative timeframes.\";\n    }\n    if (TimeframeUtils.timeframeType(time) === 'absolute') {\n      if (time.start && time.end) return true;\n      return \"You must provide a start and end time for absolute timeframes.\";\n    }\n\n    return defaultError;\n  }\n\n};\n","var moment = module.exports = require(\"./moment-timezone\");\nmoment.tz.load(require('./data/packed/latest.json'));\n","module.exports = __WEBPACK_EXTERNAL_MODULE__41__;","import React from 'react';\nimport _ from 'lodash';\nimport classNames from 'classnames';\n\nconst Modal = React.createClass({\n\n  closeClick: function(event) {\n    event.preventDefault();\n    this.close();\n  },\n\n  backdropClick: function(event) {\n    if (!$(event.target).closest('.modal-dialog').length) {\n      this.close();\n    }\n  },\n\n  close: function(){\n    if (this.state.open) {\n      this.removeBackdrop();\n      this.setState({ open: false });\n      this.props.onClose();\n    }\n  },\n\n  open: function() {\n    if (!this.state.open) {\n      this.addBackdrop();\n      this.setState({ open: true });\n      this.props.onOpen();\n    }\n  },\n\n  setLoading: function(value) {\n    if (typeof value === \"boolean\") {\n      this.setState({ loading: value });\n    }\n  },\n\n  addBackdrop: function() {\n    $('body').addClass('modal-open');\n\n    var backdropEl = document.createElement('div');\n    backdropEl.id = 'modal-backdrop';\n    backdropEl.className = 'modal-backdrop in';\n    document.body.appendChild(backdropEl);\n  },\n\n  removeBackdrop: function(){\n    $('body').removeClass('modal-open');\n    $('.modal-backdrop').remove();\n  },\n\n  buildFooter: function() {\n    if (this.props.footerBtns.length) {\n      var footerBtns = _.map(this.props.footerBtns, _.bind(function(btnConfig, index){\n        var text = btnConfig.text;\n\n        var classes = 'btn';\n        if (btnConfig.classes) {\n          classes = classes + ' ' + btnConfig.classes;\n        } else {\n          classes = classes + ' btn-default';\n        }\n\n        var icon;\n        if (btnConfig.iconName) {\n          var iconClass = 'icon glyphicon glyphicon-' + btnConfig.iconName;\n          var icon = (<span className={iconClass}></span>);\n        }\n\n        return (\n          <button type=\"button\" ref={btnConfig.ref || ''} className={classes} onClick={btnConfig.onClick || this.close} key={index}>\n            {icon}\n            {text}\n          </button>\n        );\n      }, this));\n\n      return (\n        <div className=\"modal-footer\">\n          {footerBtns}\n        </div>\n      );\n    }\n  },\n\n  // Lifecycle hooks\n\n  getInitialState: function() {\n    return {\n      open: false,\n      loading: false\n    };\n  },\n\n  getDefaultProps: function() {\n    return {\n      size: 'small',\n      modalClasses: '',\n      footerBtns: [],\n      onOpen: function(){},\n      onClose: function(){}\n    };\n  },\n\n  componentDidMount: function() {\n    $(document).on('click', '.modal.block', _.bind(this.backdropClick, this));\n    $(document).on('keyup', _.bind(function(e) {\n      // Escapism?\n      if (e.keyCode === 27 && e.target.className.indexOf('react-select-input') < 0) {\n        this.close();\n      }\n    }, this));\n  },\n\n  componentWillUnmount: function() {\n    $(document).off('click', '.modal-backdrop');\n  },\n\n  render: function() {\n    var modalClasses = this.props.modalClasses + ' modal';\n    if (this.state.open) {\n      modalClasses += ' block';\n    }\n    var modalDialogClasses = classNames({\n      'modal-dialog': true,\n      'modal-lg': this.props.size === 'large'\n    });\n\n    var titleIcon;\n    if (this.props.titleIcon) {\n      var titleIconClasses = \"icon glyphicon glyphicon-\" + this.props.titleIcon;\n      if (!this.props.title) titleIconClasses += \" big no-margin\";\n      if (this.props.iconClasses) titleIconClasses = titleIconClasses + \" \" + this.props.iconClasses;\n      titleIcon = <span className={titleIconClasses}></span>\n    }\n\n    return (\n      <div className={modalClasses}>\n        <div className={modalDialogClasses}>\n          <div className=\"modal-content\">\n            <div className=\"modal-header\">\n              <button type=\"button\" className=\"close\" onClick={this.closeClick}>\n                <span aria-hidden=\"true\">&times;</span>\n                <span className=\"sr-only\">Close</span>\n              </button>\n              <h3 className=\"modal-title\">\n                {titleIcon}\n                {this.props.title}\n              </h3>\n            </div>\n            <div className=\"modal-body\">\n              {this.props.children}\n            </div>\n            {this.buildFooter()}\n          </div>\n        </div>\n      </div>\n    );\n  }\n});\n\nexport default Modal;\n","import keyMirror from 'keymirror';\n\nexport default keyMirror({\n  APP_STATE_UPDATE: null,\n  APP_STATE_RESET: null\n});\n","import _ from 'lodash';\nimport AppDispatcher from '../dispatcher/AppDispatcher';\nimport { EventEmitter } from 'events';\nimport AppStateConstants from '../constants/AppStateConstants';\n\nconst CHANGE_EVENT = 'change';\n\nfunction defaultState() {\n  return {\n    fetchingPersistedExplorers: false,\n    codeSampleHidden: true,\n    ready: false\n  };\n}\n\nvar _appState = defaultState();\n\nfunction _update(updates) {\n  _appState = _.assign({}, _appState, updates);\n}\n\nfunction _reset() {\n  _appState = defaultState();\n}\n\nvar AppStateStore = _.assign({}, EventEmitter.prototype, {\n  unregisterWithDispatcher: function() {\n    AppDispatcher.unregister(this.dispatchToken);\n  },\n\n  getState: function() {\n    return _appState;\n  },\n\n  reset: function() {\n    _reset();\n  },\n\n  emitChange: function() {\n    this.emit(CHANGE_EVENT);\n  },\n\n  addChangeListener: function(callback) {\n    this.on(CHANGE_EVENT, callback);\n  },\n\n  removeChangeListener: function(callback) {\n    this.removeListener(CHANGE_EVENT, callback);\n  }\n});\n\n// Register callback to handle all updates\nAppStateStore.dispatchToken = AppDispatcher.register(function(action) {\n  switch(action.actionType) {\n    case AppStateConstants.APP_STATE_UPDATE:\n      _update(action.updates);\n      AppStateStore.emitChange();\n      break;\n\n    case AppStateConstants.APP_STATE_RESET:\n      _reset();\n      AppStateStore.emitChange();\n      break;\n\n    default:\n      // no op\n  }\n\n  return true;\n});\n\nexport default AppStateStore;\n","import keyMirror from 'keymirror';\n\nexport default keyMirror({\n  PROJECT_CREATE: null,\n  PROJECT_UPDATE: null,\n  PROJECT_UPDATE_EVENT_COLLECTION: null\n});\n","module.exports = __WEBPACK_EXTERNAL_MODULE__46__;","module.exports = __WEBPACK_EXTERNAL_MODULE__47__;","import _ from 'lodash';\nimport AppDispatcher from '../dispatcher/AppDispatcher';\nimport { EventEmitter } from 'events';\nimport NoticeConstants from '../constants/NoticeConstants';\nimport ExplorerConstants from '../constants/ExplorerConstants';\nimport ExplorerStore from '../stores/ExplorerStore';\n\nconst CHANGE_EVENT = 'change';\n\nlet _notices = {};\n\nfunction defaultAttrs() {\n  return {\n    location: 'global',\n    text: null,\n    type: null\n  };\n}\n\nfunction _removeGlobalNotices() {\n  _.each(_notices, function(val, key) {\n    if (val.location === 'global') delete _notices[key];\n  });\n}\n\nfunction _removeStepNotices() {\n  _.each(_notices, function(val, key) {\n    if (val.location === 'step') delete _notices[key];\n  });\n}\n\nfunction _create(attrs) {\n  if (!attrs.location || attrs.location === 'global') {\n    _removeGlobalNotices();\n  }\n  var tempId = \"TEMP-\" + (+new Date() + Math.floor(Math.random() * 999999)).toString(36);\n  _notices[tempId] = _.assign(defaultAttrs(), attrs);\n}\n\nfunction _clearAll() {\n  _notices = {};\n}\n\nvar NoticeStore = _.assign({}, EventEmitter.prototype, {\n  unregisterWithDispatcher: function() {\n    AppDispatcher.unregister(this.dispatchToken);\n  },\n\n  getGlobalNotice: function() {\n    return _.find(_notices, { location: 'global' });\n  },\n\n  getStepNotices: function() {\n    return _.filter(_notices, function(notice) {\n      if (notice.location === 'step') return notice;\n    });\n  },\n\n  clearAll: function() {\n    _clearAll();\n  },\n\n  emitChange: function() {\n    this.emit(CHANGE_EVENT);\n  },\n\n  addChangeListener: function(callback) {\n    this.on(CHANGE_EVENT, callback);\n  },\n\n  removeChangeListener: function(callback) {\n    this.removeListener(CHANGE_EVENT, callback);\n  }\n});\n\n// Register callback to handle all updates\nNoticeStore.dispatchToken = AppDispatcher.register(function(action) {\n  AppDispatcher.waitFor([ExplorerStore.dispatchToken]);\n\n  switch(action.actionType) {\n    case NoticeConstants.NOTICE_CREATE:\n      _create(action.attrs);\n      NoticeStore.emitChange();\n      break;\n\n    case NoticeConstants.NOTICE_CLEAR_ALL:\n      _clearAll();\n      NoticeStore.emitChange();\n      break;\n\n    case ExplorerConstants.EXPLORER_SAVING:\n      var text = action.saveType === 'save' ? 'Saving query...' : 'Updating query...';\n      _create({\n        type: 'info',\n        text: text,\n        icon: 'info-sign'\n      });\n      NoticeStore.emitChange();\n      break;\n\n    case ExplorerConstants.EXPLORER_SAVE_SUCCESS:\n      var text = action.saveType === 'save' ? 'Query saved' : 'Query updated';\n      _create({\n        type: 'success',\n        text: text + '.',\n        icon: 'ok'\n      });\n      NoticeStore.emitChange();\n      break;\n\n    case ExplorerConstants.EXPLORER_SAVE_FAIL:\n      var msg;\n      var text = action.saveType === 'save' ? 'saving' : 'updating';\n      if (action.errorMsg) {\n        msg = 'Problem ' + text + ': ' + action.errorMsg;\n      } else if (action.errorResp && JSON.parse(action.errorResp.text).error_code === \"OverCachedQueryLimitError\") {\n        msg = 'Oops! Looks like you’ve reached your caching limit. Need more cached queries? Contact us at team@keen.io';\n      } else if (action.errorResp) {\n        msg = 'Problem ' + text + ': ' + JSON.parse(action.errorResp.text).message;\n      }\n      _create({\n        type: 'error',\n        text: msg,\n        icon: 'remove-sign'\n      });\n      NoticeStore.emitChange();\n      break;\n\n    case ExplorerConstants.EXPLORER_DESTROYING:\n      _create({\n        type: 'info',\n        text: 'Deleting query...',\n        icon: 'info-sign'\n      });\n      NoticeStore.emitChange();\n      break;\n\n    case ExplorerConstants.EXPLORER_DESTROY_SUCCESS:\n      _create({\n        type: 'success',\n        text: 'Query deleted.',\n        icon: 'ok'\n      });\n      NoticeStore.emitChange();\n      break;\n\n    case ExplorerConstants.EXPLORER_DESTROY_FAIL:\n      _create({\n        type: 'error',\n        text: 'There was a problem deleting your query: ' + action.errorMsg,\n        icon: 'remove-sign'\n      });\n      NoticeStore.emitChange();\n      break;\n\n    case ExplorerConstants.EXPLORER_FOUND_INVALID:\n      var explorer = ExplorerStore.get(action.id);\n      _create({\n        text: 'There was a problem: ' + explorer.errors[0].msg,\n        type: 'error',\n        icon: 'remove-sign'\n      });\n      if (explorer.query.analysis_type === 'funnel') {\n        _removeStepNotices();\n        explorer.query.steps.forEach(function(step, index) {\n          if (!step.isValid) {\n            _create({\n              id: explorer.id,\n              location: 'step',\n              stepIndex: index,\n              text: step.errors[0].msg,\n              type: 'error',\n              icon: 'remove-sign',\n            });\n          }\n        });\n      }\n      NoticeStore.emitChange();\n      break;\n\n    default:\n      // no op\n  }\n\n  return true;\n});\n\nexport default NoticeStore;\n","import React from 'react';\nimport classNames from 'classnames';\nimport _ from 'lodash';\nimport ExplorerUtils from '../../utils/ExplorerUtils';\n\nconst QueryActions = React.createClass({\n\n  runBtnStates: {\n    default: {\n      inactive: 'Run Query',\n      active: 'Running...'\n    },\n    immediateExtraction: {\n      inactive: 'Run Extraction',\n      active: 'Running...'\n    },\n    emailExtraction: {\n      inactive: 'Send Email Extraction',\n      active: 'Sending...'\n    }\n  },\n\n  runButtonText: function() {\n    var btnStates = this.runBtnStates.default;\n\n    if (ExplorerUtils.isEmailExtraction(this.props.model)) {\n      btnStates = this.runBtnStates.emailExtraction;\n    } else if (ExplorerUtils.isImmediateExtraction(this.props.model)) {\n      btnStates = this.runBtnStates.immediateExtraction;\n    }\n\n    return this.props.model.loading ? btnStates.active : btnStates.inactive;\n  },\n\n  render: function() {\n    var saveMsg,\n        saveBtn,\n        cloneBtn,\n        deleteBtn,\n        actionsSupported = true,\n        runButtonClasses = classNames({\n          'disabled': this.props.model.loading,\n          'btn btn-primary run-query': true\n        }),\n        codeSampleBtnClasses = classNames({\n          'btn btn-default code-sample-toggle pull-right': true,\n          'open': !this.props.codeSampleHidden\n        });\n\n    var isEmailExtraction = ExplorerUtils.isEmailExtraction(this.props.model);\n    var isPersisted = ExplorerUtils.isPersisted(this.props.model);\n    var isFunnel = this.props.model.query.analysis_type === 'funnel';\n\n    if (this.props.persistence) {\n      if (isEmailExtraction) {\n        actionsSupported = false;\n        saveMsg = (\n          <p className=\"no-margin margin-top-tiny\">\n            <small>The Keen API currently does not support saving email extraction.</small>\n          </p>\n        );\n      }\n      saveBtn = (\n        <button type=\"button\" className=\"btn btn-success save-query\" onClick={actionsSupported ? this.props.saveQueryClick : function(){}} role=\"save-query\" disabled={this.props.model.loading || !actionsSupported}>\n          {isPersisted ? 'Update' : 'Save'}\n        </button>\n      );\n      deleteBtn = (\n        <button type=\"button\" role=\"delete-query\" className=\"btn btn-link\" onClick={actionsSupported ? this.props.removeClick : function(){}} disabled={!actionsSupported}>\n          Delete\n        </button>\n      );\n      if (isPersisted) {\n        cloneBtn = (\n          <button type=\"button\" className=\"btn btn-default\" onClick={actionsSupported ? this.props.cloneQueryClick : function(){}} role=\"clone-query\" disabled={this.props.model.loading || !actionsSupported}>\n            Clone\n          </button>\n        );\n      }\n    }\n\n    return (\n      <div className=\"query-actions clearfix\">\n        <div className=\"row\">\n          <div className=\"col-md-10 clearfix\">\n            <div className=\"run-group pull-left\">\n              <button type=\"submit\" role=\"run-query\" className={runButtonClasses} id=\"run-query\" onClick={this.props.handleQuerySubmit}>\n                {this.runButtonText()}\n              </button>\n            </div>\n            <div className=\"manage-group pull-left\">\n              {saveBtn}\n              {cloneBtn}\n              {deleteBtn}\n            </div>\n          </div>\n          <div className=\"col-md-2\">\n            <button className={codeSampleBtnClasses} role=\"toggle-code-sample\" onClick={this.props.toggleCodeSample}>\n              <span>&lt;/&gt; Embed</span>\n            </button>\n          </div>\n        </div>\n        {saveMsg}\n      </div>\n    );\n  }\n\n});\n\nexport default QueryActions;\n","import React from 'react';\nimport _ from 'lodash';\nimport classNames from 'classnames';\nimport moment from 'moment';\n\nimport ExplorerActions from '../../actions/ExplorerActions';\nconst refreshRateMultiplier = 60 * 60;\n\nconst CacheToggle = React.createClass({\n\n  setCached: function(event) {\n    var updates = _.clone(this.props.model);\n    if (this._isCached()) {\n      updates.refresh_rate = 0;\n    }\n    else {\n      updates.refresh_rate = 14400;\n    }\n\n    ExplorerActions.update(this.props.model.id, updates);\n    this.setState({\n      settingsOpen: updates.refresh_rate == 0 ? false : this.state.settingsOpen\n    });\n  },\n\n  setSettingsOpen: function(event) {\n    event.preventDefault();\n    this.setState({ settingsOpen: !this.state.settingsOpen });\n  },\n\n  setRefreshRate: function(event) {\n    this.setState({ refresh_rate: event.target.value });\n  },\n\n  setRefreshRateBlur: function(event) {\n    var refresh_rate = Math.round(event.target.value*refreshRateMultiplier);\n    var updates = _.clone(this.props.model);\n    updates.refresh_rate = refresh_rate;\n\n    ExplorerActions.update(this.props.model.id, updates);\n    this.forceUpdate();\n  },\n\n  getInitialState: function() {\n    return {\n      refresh_rate: this._refreshRateInHours(this.props.model),\n      cached: false,\n      settingsOpen: false\n    };\n  },\n\n  componentWillReceiveProps: function(nextProps) {\n    this.setState({ refresh_rate: this._refreshRateInHours(nextProps.model) });\n  },\n\n  render: function() {\n    var isCached = this._isCached();\n    var parentClasses = classNames({\n      'cache-toggle': true,\n      'inactive': !isCached\n    });\n    var cacheDetailsClasses = classNames({\n      \"cache-details\": true,\n      \"hide\": !isCached\n    });\n    var cacheSettingsClasses = classNames({\n      \"cache-settings\": true,\n      \"hide\": !this.state.settingsOpen\n    });\n\n    var cacheToggleLabel = isCached? 'Caching enabled' : 'Enable caching';\n\n    return (\n      <div className={parentClasses}>\n\n        <label htmlFor=\"cache\">\n          <input type=\"checkbox\" name=\"cache\" id=\"cache\"\n            onChange={this.setCached} checked={isCached} />\n          {cacheToggleLabel}\n          <a href=\"https://keen.io/docs/api/#saved-queries\" target=\"_blank\">\n            <i className=\"icon glyphicon glyphicon-question-sign\"></i>\n          </a>\n        </label>\n\n        <span className={cacheDetailsClasses}>\n          {this._minutesAgo()}\n          <a href=\"#\" onClick={this.setSettingsOpen} className=\"margin-left-tiny\">\n            <span className=\"icon icon-cog glyphicon-cog glyphicon\"></span>\n          </a>\n        </span>\n\n        <span className={cacheSettingsClasses}>\n          Refresh every <input type=\"text\"\n                               name=\"refresh_rate\"\n                               value={this.state.refresh_rate}\n                               className=\"form-control\"\n                               onChange={this.setRefreshRate}\n                               onBlur={this.setRefreshRateBlur} /> hours ({\"min 4 / max 24\"})\n        </span>\n      </div>\n    );\n  },\n\n  _isCached: function() {\n    return this.props.model.refresh_rate != 0;\n  },\n\n  _minutesAgo: function() {\n    var runInformation = this.props.model.run_information;\n\n    if (runInformation != null && runInformation.last_run_status == 200) {\n      var lastRun = moment(runInformation.last_run_date).utcOffset(0);\n      var duration = moment.duration(lastRun.diff(moment())).humanize();\n      return 'Last updated ' + duration +\n          ' ago.';\n    }\n  },\n\n  _refreshRateInHours: function(model) {\n    return (model.refresh_rate/refreshRateMultiplier) * 100 / 100;\n  }\n\n});\n\nexport default CacheToggle;\n","import React from 'react';\nimport _ from 'lodash';\nimport moment from 'moment';\n\nfunction dateForItem(item) {\n  if (item.created_date) {\n    var datetime = moment(new Date(item.created_date.replace(' ', 'T')));\n    return datetime.isValid() ? datetime.format('ll h:mm A') : null;\n  }\n}\n\nconst BrowseQueries = React.createClass({\n\n  clickCallback: function(event) {\n    this.props.clickCallback(event);\n  },\n\n  buildList: function() {\n    var listElements = this.props.listItems.map(_.bind(function(listItem, index) {\n      var isSelected = (this.props.selectedIndex === index) ? true : false;\n      var classes;\n      if (isSelected) classes = 'active';\n      var createdAt;\n      var datetime = dateForItem(listItem);\n      if (datetime) {\n        createdAt = (\n          <p className=\"date pull-right\">\n            <span className=\"icon glyphicon glyphicon-time\"></span>\n            {datetime}\n          </p>\n        );\n      }\n      var isCachedText = listItem.refresh_rate > 0 ? 'Cached' : '';\n\n      var displayName = null;\n      if (listItem.metadata && listItem.metadata.display_name) {\n        displayName = listItem.metadata.display_name;\n      } else if (listItem.query_name) {\n        displayName = listItem.query_name;\n      } else {\n        displayName = 'Query not named';\n      }\n\n      return (\n        <li className={classes} key={index} data-id={listItem.id} onClick={this.clickCallback}>\n          <h5 className=\"name\">{displayName}</h5>\n          <div className=\"metadata clearfix\">\n            <p className=\"date pull-left\">{isCachedText}</p>\n            {createdAt}\n          </div>\n        </li>\n      );\n    }, this));\n    return (\n      <ul ref=\"list\" className=\"interactive-list\">\n        {listElements}\n      </ul>\n    );\n  },\n\n  fieldChanged: function(event) {\n    var newState = {};\n    newState[event.target.name] = event.target.value;\n    this.setState(newState);\n  },\n\n  getDefaultProps: function() {\n    return {\n      listItems: [],\n      clickCallback: null,\n      selectedIndex: null,\n      notice: null,\n      emptyContent: null\n    };\n  },\n\n  render: function() {\n    var emptyContent = this.props.listItems.length ? null: this.props.emptyContent;\n    var listItems = this.buildList();\n\n    return (\n      <section className=\"query-pane-section browse-queries\">\n        {this.props.notice}\n        {listItems}\n        {emptyContent}\n      </section>\n    );\n  }\n\n});\n\nexport default BrowseQueries;\n","import React from 'react';\n\nconst ApiUrl = React.createClass({\n\n  getInitialState: function(){\n    return {\n      active: false\n    }\n  },\n\n  handleClick: function(){\n    var self = this;\n    self.setState({ active: !self.state.active });\n    if (!self.state.active) {\n      setTimeout(function(){\n        self.refs['input'].focus();\n      }, 50);\n    }\n  },\n\n  handleInputSelect: function(e){\n    e.target.setSelectionRange(0, 9999);\n  },\n\n  handleInputChange: function(e){\n    e.preventDefault();\n  },\n\n  render: function(){\n    return (\n      <div className=\"explorer-api-url\">\n        <button className=\"btn btn-link field-secondary-control\" title=\"API URL\" type=\"button\" onClick={this.handleClick}>\n          <span className={\"icon glyphicon glyphicon-chevron-\" + (this.state.active ? \"down\" : \"right\") + \" icon-chevron-\" + (this.state.active ? \"down\" : \"right\")}></span> API Query URL\n        </button>\n        <div className={this.state.active ? \"show\" : \"hide\"}>\n          <input\n            ref=\"input\"\n            name=\"api-query\"\n            className=\"form-control input-sm\"\n            placeholder=\"API Query URL will appear here...\"\n            value={this.props.isValid ? this.props.url : \"\"}\n            onClick={this.handleInputSelect}\n            onFocus={this.handleInputSelect}\n            onChange={this.handleInputChange} />\n        </div>\n      </div>\n    );\n  }\n\n});\n\nexport default ApiUrl;\n","import _ from 'lodash';\nimport moment from 'moment';\nimport React from 'react';\n\nimport Select from './select.js';\nimport Input from './input.js';\nimport FieldsToggle from './fields_toggle.js';\nimport ExplorerActions from '../../actions/ExplorerActions';\nimport ExplorerUtils from '../../utils/ExplorerUtils';\nimport ProjectUtils from '../../utils/ProjectUtils';\n\nclass Interval extends React.Component {\n\n  constructor(props) {\n    super(props);\n    this.state = {\n      tab: this.getTab()\n    }\n  }\n\n  setInterval(event) {\n    const value = event.target.value || null;\n    this.props.handleChange('interval', value);\n  }\n\n  intervalFieldsToggled(toggleState){\n    if (toggleState && !this.props.interval) {\n      this.props.handleChange('interval', 'daily');\n    }\n  }\n\n  intervalUpdateFn(updates) {\n    this.props.handleChange('interval', updates['interval']);\n  }\n\n  intervalGetFn(attr) {\n    if (attr === 'interval') {\n      return this.props.interval;\n    } else {\n      throw new Error(\"Interval component is only aware of interval attributes\")\n    }\n  }\n\n  getTab() {\n    if (!this.props.interval || this.props.interval.indexOf('every') === -1) {\n      return 'absolute';\n    }\n    return 'custom';\n  }\n\n  getCustomInterval(interval = '', index = 1) {\n    if (!interval) return;\n    const intervalSplitted = interval.split('_');\n    return intervalSplitted[index];\n  }\n\n  updateCustomInterval({\n    value = this.getCustomInterval(this.props.interval, 1),\n    units = this.getCustomInterval(this.props.interval, 2)\n  }) {\n    const customIntervalValue = `every_${value}_${units}`;\n    this.props.handleChange('interval', customIntervalValue);\n  }\n\n  setCustomValue(e) {\n    this.updateCustomInterval({ value: e.target.value });\n  }\n\n  setCustomUnits(e) {\n    this.updateCustomInterval({ units: e.target.value });\n  }\n\n  // React Methods\n\n  render() {\n    return (\n      <div className=\"field-component timeframe interval-margin-top\">\n        <FieldsToggle ref=\"interval-toggle\"\n                      name=\"Interval\"\n                      initialOpenState={this.props.interval}\n                      attrsToStore={'interval'}\n                      getFn={(x) => this.intervalGetFn(x)}\n                      updateFn={(x) => this.intervalUpdateFn(x)}\n                      toggleCallback={(x) => this.intervalFieldsToggled(x)}>\n\n          <ul className=\"nav nav-pills\" role=\"tablist\">\n            <li className={this.state.tab === 'absolute' ? 'active' : ''}>\n              <a href=\"#\" className=\"relative-tab\" data-type=\"absolute\"\n                onClick={(event) => {\n                  this.setState({ tab: 'absolute' });\n                  event.preventDefault();\n                }}>Absolute</a>\n            </li>\n            <li className={this.state.tab === 'custom' ? 'active' : ''}>\n              <a href=\"#\" className=\"absolute-tab\" data-type=\"custom\"\n                onClick={(event) => {\n                  this.setState({ tab: 'custom' });\n                  event.preventDefault();\n                }}>Custom</a>\n            </li>\n          </ul>\n\n          {\n            this.state.tab === 'absolute' &&\n            <Select label={false}\n                    name=\"interval\"\n                    classes=\"interval-type\"\n                    options={ProjectUtils.getConstant('ABSOLUTE_INTERVAL_TYPES')}\n                    emptyOption={true}\n                    handleSelection={(e) => this.setInterval(e)}\n                    selectedOption={this.props.interval}\n                    sort={false} />\n          }\n\n          {\n            this.state.tab === 'custom' &&\n            <div className=\"flex row flex-row\">\n              <div className=\"label-small col-xs-4\">\n                Every\n              </div>\n              <Input label={false}\n                     name=\"interval-custom-value\"\n                     classes=\"form-collapse-left form-collapse-right col-xs-4\"\n                     type=\"number\"\n                     onChange={(e) => this.setCustomValue(e)}\n                     placeholder=\"e.g. 1\"\n                     value={this.getCustomInterval(this.props.interval, 1) || \"\"}\n                     autoComplete=\"off\" />\n              <Select label={false}\n                name=\"interval-custom\"\n                classes=\"col-xs-4 interval-type form-collapse-left form-collapse-right\"\n                options={ProjectUtils.getConstant('RELATIVE_INTERVAL_TYPES')}\n                emptyOption={true}\n                handleSelection={(e) => this.setCustomUnits(e)}\n                selectedOption={this.getCustomInterval(this.props.interval, 2)}\n                sort={false} />\n             </div>\n           }\n\n        </FieldsToggle>\n      </div>\n    );\n  }\n}\n\nexport default Interval;\n","import _ from 'lodash';\nimport React from 'react';\n\nconst Geo = React.createClass({\n\n  // Note: Keen API standard is Longitude followed by Latitude.\n  render: function() {\n    return (\n      <div>\n        <div className=\"col-md-12\">\n          <label htmlFor=\"amount\">Longitude</label>\n          <input type=\"text\"\n                 name=\"coordinates.0\"\n                 className=\"form-control\"\n                 value={this.props.filter.property_value.coordinates[0] || \"\"}\n                 onChange={this.props.handleChange}\n                 autoComplete=\"off\" />\n        </div>\n        <div className=\"col-md-12\">\n          <label htmlFor=\"amount\">Latitude</label>\n          <input type=\"text\"\n                 name=\"coordinates.1\"\n                 className=\"form-control\"\n                 value={this.props.filter.property_value.coordinates[1] || \"\"}\n                 onChange={this.props.handleChange}\n                 autoComplete=\"off\" />\n        </div>\n        <div className=\"col-md-12\">\n          <label htmlFor=\"amount\">Radius in Miles</label>\n          <input type=\"text\"\n                 name=\"max_distance_miles\"\n                 className=\"form-control\"\n                 value={this.props.filter.property_value.max_distance_miles || \"\"}\n                 onChange={this.props.handleChange}\n                 autoComplete=\"off\" />\n        </div>\n      </div>\n    );\n  }\n});\n\nexport default Geo;\n","import _ from 'lodash';\nimport moment from 'moment';\nimport React from 'react';\nimport Select from './select.js';\nimport Datepicker from './datepicker.js';\nimport Timepicker from './timepicker.js';\nimport Geo from './geo.js';\nimport FormatUtils from '../../utils/FormatUtils';\nimport FilterUtils from '../../utils/FilterUtils';\n\nconst dateFormat = 'll';\nconst timeFormat = 'h:mm A';\n\nfunction pasrseIntoDate(dateString, timeString) {\n  var date = moment(new Date(dateString)).format(dateFormat);\n  var time = moment(new Date(timeString)).format(timeFormat);\n  return new Date(date + \" \" + time).toString();\n}\n\nconst FilterValueFields = React.createClass({\n\n  handleChangeWithEvent: function(event) {\n    this.props.handleChange(event.target.name, event.target.value);\n  },\n\n  setValueState: function(event) {\n    var updates = {};\n    updates[event.target.name] = event.target.value;\n    this.setState(updates);\n  },\n\n  setDate: function(name, value) {\n    this.props.handleChange(name, pasrseIntoDate(value, this.props.filter.property_value));\n  },\n\n  setTime: function(name, value) {\n    this.props.handleChange(name, pasrseIntoDate(this.props.filter.property_value, value));\n  },\n\n  handleDateBlur: function (event) {\n    this.setDate(event.target.name, event.target.value);\n  },\n\n  handleChange: function(event) {\n    this.props.handleChange(event.target.name, event.target.value);\n  },\n\n  handleKeyPress: function(event) {\n    if(event.key === 'Enter' && this.props.onPressEnter){\n      this.props.handleChange(event.target.name, event.target.value, this.props.onPressEnter);\n    }\n  },\n\n  getCoercionOptions: function() {\n    var operator = this.props.filter.operator;\n    return operator ? _.find(this.props.filterOperators, { value: operator }).canBeCoeredTo : [];\n  },\n\n  getInputPlaceholder: function() {\n    var type = this.props.filter.coercion_type;\n    return type === 'List' ? 'Comma sep list' : type;\n  },\n\n  // React methods\n\n  getInitialState: function() {\n    return {\n      property_value: this.props.filter.property_value\n    };\n  },\n\n  componentWillReceiveProps: function(newProps) {\n    this.setState({ property_value: newProps.filter.property_value });\n  },\n\n  render: function() {\n    var valueInput;\n    if (this.propertyType === 'geo' || this.props.filter.operator === 'within') {\n      valueInput = (\n        <Geo handleChange={this.handleChangeWithEvent}\n             filter={this.props.filter}/>\n      );\n    } else if (this.props.filter.operator === 'exists' || this.props.filter.coercion_type === 'Boolean') {\n      valueInput = (\n        <Select name=\"property_value\"\n                classes=\"property-value\"\n                ref=\"boolean-value-set\"\n                options={['true', 'false']}\n                handleBlur={this.handleChangeWithEvent}\n                handleSelection={this.setValueState}\n                selectedOption={FormatUtils.booleanMap(this.state.property_value) || 'true'}\n                emptyOption={false} />\n      );\n    } else if (this.props.filter.coercion_type === 'Datetime') {\n      valueInput = (\n        <div className=\"row property-value\">\n          <div className=\"col-md-6 form-collapse-right\">\n            <Datepicker ref=\"date-value-input\"\n                        value={moment(new Date(this.state.property_value)).format(dateFormat)}\n                        label={false}\n                        name=\"property_value\"\n                        placeholder=\"Date\"\n                        classes=\"datepicker-wrapper\"\n                        onSet={this.setDate}\n                        onBlur={this.handleDateBlur} />\n          </div>\n          <div className=\"col-md-6 form-collapse-left\">\n            <Timepicker ref=\"time-value-input\"\n                        value={moment(new Date(this.state.property_value)).format(timeFormat)}\n                        label={false}\n                        name=\"property_value\"\n                        placeholder=\"Time\"\n                        classes=\"timepicker-wrapper\"\n                        handleSelection={this.setTime}\n                        handleBlur={this.setTime} />\n          </div>\n        </div>\n      );\n    } else {\n      valueInput = (\n        <input type=\"text\"\n               ref=\"value-input\"\n               name=\"property_value\"\n               className=\"form-control property-value\"\n               value={this.state.property_value || ''}\n               onChange={this.setValueState}\n               onBlur={this.handleChangeWithEvent}\n               onKeyPress={this.handleKeyPress}\n               placeholder={this.getInputPlaceholder()}\n               readOnly={this.props.filter.coercion_type === 'Null'}\n               autoComplete=\"off\" />\n      );\n    }\n\n    return (\n      <div className=\"row\">\n        <div className=\"col-md-3 form-collapse-right\">\n          <Select label={false}\n                  ref=\"type-set\"\n                  name=\"coercion_type\"\n                  classes=\"coercion-type\"\n                  sort={false}\n                  options={this.getCoercionOptions()}\n                  handleSelection={this.handleChangeWithEvent}\n                  selectedOption={this.props.filter.coercion_type}\n                  emptyOption={false} />\n        </div>\n        <div className=\"col-md-9 form-collapse-left\">\n          {valueInput}\n        </div>\n      </div>\n    );\n  }\n});\n\nexport default FilterValueFields;\n","import _ from 'lodash';\nimport React from 'react';\nimport Select from './select.js';\nimport classNames from 'classnames';\nimport ReactSelect from './react_select.js';\nimport FilterValueFields from './filter_value_fields.js';\nimport FilterUtils from '../../utils/FilterUtils';\n\nconst Filter = React.createClass({\n\n  removeFilter: function(e) {\n    e.preventDefault();\n    this.props.removeFilter(this.props.index);\n  },\n\n  handleChange: function(name, value, callback) {\n    this.props.handleChange(this.props.index, name, value, callback);\n  },\n\n  handleChangeWithEvent: function(e) {\n    this.props.handleChange(this.props.index, e.target.name, e.target.value);\n  },\n\n  buildValueFormGroup: function() {\n    return (\n      <FilterValueFields filter={this.props.filter}\n                         filterOperators={this.props.filterOperators}\n                         handleChange={this.handleChange}\n                         onPressEnter={this.props.onPressEnter} />\n    );\n  },\n\n  buildOperatorSelect: function() {\n    return (\n      <Select label={false}\n              name=\"operator\"\n              classes=\"operator\"\n              options={this.props.filterOperators}\n              emptyOption={false}\n              sort={false}\n              handleSelection={this.handleChangeWithEvent}\n              selectedOption={this.props.filter.operator} />\n    );\n  },\n\n  buildPropertyNameSelect: function() {\n    return (\n      <ReactSelect name=\"property_name\"\n                   inputClasses=\"property-name form-control\"\n                   items={this.props.propertyNames}\n                   handleChange={this.handleChange}\n                   placeholder=\"Select a property name\"\n                   value={this.props.filter.property_name}\n                   sort={true} />\n    )\n  },\n\n  getListSyntaxInfo: function() {\n    if (this.props.filter.coercion_type === 'List') {\n      return (\n        <p className=\"filter-instructions help-block\">\n          Wrap strings in <b>double</b> quotes &amp; numbers in <b>single</b> quotes.\n        </p>\n      );\n    }\n  },\n\n  buildValidationError: function() {\n    if (this.filterCompleteAndInvalid()) {\n      return (\n        <div className=\"row\">\n          <div className=\"col-md-12\">\n            <p className=\"invalid\">Invalid: {this.props.filter.errors[0].msg}</p>\n          </div>\n        </div>\n      );\n    }\n  },\n\n  filterCompleteAndInvalid: function() {\n    var complete = FilterUtils.isComplete(this.props.filter);\n    var valid = this.props.filter.isValid;\n    return complete && !valid;\n  },\n\n  // React functions\n\n  render: function() {\n    var filterClasses = classNames({\n      'filter-row': true,\n      'filter-complete': !FilterUtils.isComplete(this.props.filter) || this.props.filter.isValid,\n      'filter-incomplete': this.filterCompleteAndInvalid()\n    });\n\n    return (\n      <div className={filterClasses}>\n        <div className=\"row\">\n          <div className=\"col-md-4 filter-property-col\">\n            {this.buildPropertyNameSelect()}\n          </div>\n          <div className=\"col-md-2 filter-operator-col\">\n            {this.buildOperatorSelect()}\n          </div>\n          <div className=\"col-md-5 filter-value-col\">\n            {this.buildValueFormGroup()}\n            {this.getListSyntaxInfo()}\n          </div>\n          <div className=\"col-md-1 filter-close-col\">\n            <a href=\"#\" className=\"remove-filter\" onClick={this.removeFilter} data-index={this.props.index}>\n              <span className=\"icon no-margin\">&times;</span>\n            </a>\n          </div>\n        </div>\n        {this.buildValidationError()}\n      </div>\n    );\n  }\n});\n\nexport default Filter;\n","import _ from 'lodash';\nimport React from 'react';\nimport ReactSelect from './react_select.js';\nimport ProjectUtils from '../../utils/ProjectUtils';\nimport ExplorerActions from '../../actions/ExplorerActions';\n\nconst Timezone = React.createClass({\n\n  handleTimezoneBlur: function() {\n    this.setState({ active: false });\n    this.refs['timezone-display'].focus();\n  },\n\n  handleTimezoneActivated: function(){\n    var self = this;\n    this.setState({ active: true });\n    setTimeout(function(){\n      self.refs['timezone'].refs['input'].focus();\n      self.refs['timezone'].setState({ visible: true });\n    }, 100);\n  },\n\n  handleTimezoneChange: function(name, value) {\n    var timezones = ProjectUtils.getConstant('TIMEZONES');\n    var timezone = timezones.filter(z => z.name === value)[0];\n    this.props.handleChange('timezone', timezone ? timezone.name : value);\n  },\n\n  // React methods\n\n  getInitialState: function(){\n    return { active: false };\n  },\n\n  componentDidMount: function() {\n    if (!this.props.timezone) {\n      this.props.handleChange('timezone', ProjectUtils.getConstant('DEFAULT_TIMEZONE'));\n    }\n    this.refs['timezone'].setState({ visible: false });\n  },\n\n  render: function(){\n    return (\n      <div className={\"timezone-toggle\" + (this.state.active ? \" active\" : \"\")}>\n        <div className=\"toggle-display\">\n          <button ref=\"timezone-display\"\n                  className=\"btn btn-link field-secondary-control\"\n                  title={\"Selectd timezone: \" + this.props.timezone}\n                  type=\"button\"\n                  onClick={this.handleTimezoneActivated}>\n            <span className=\"icon glyphicon glyphicon-globe\"></span> Timezone: {this.props.timezone}\n          </button>\n        </div>\n        <div className=\"toggle-options\">\n          <ReactSelect ref=\"timezone\"\n                       name=\"timezone\"\n                       classes=\"timezone form-control\"\n                       value={this.props.timezone}\n                       items={ProjectUtils.getConstant('TIMEZONES').map((z) => z.name)}\n                       handleChange={this.handleTimezoneChange}\n                       handleBlur={this.handleTimezoneBlur} />\n        </div>\n      </div>\n    );\n  }\n\n});\n\nexport default Timezone;\n","import React from 'react';\nimport _ from 'lodash';\nimport Input from './input.js';\nimport Select from './select.js';\n\nconst RELATIVE_TIMEFRAMES = ['this', 'previous'];\n\nimport ExplorerUtils from '../../utils/ExplorerUtils';\nimport ExplorerActions from '../../actions/ExplorerActions';\nimport FormatUtils from '../../utils/FormatUtils';\n\nfunction hasRelativeTimeframe(time) {\n  time = time || {};\n  return time.relativity && time.amount && time.sub_timeframe;\n}\n\nconst RelativePicker = React.createClass({\n\n  setRelativeTime: function(event) {\n    var name = event.target.name;\n    var value = event.target.value;\n\n    var updates = _.cloneDeep(this.props.time);\n    updates[name] = value\n    this.props.handleChange('time', updates)\n  },\n\n  buildDescriptionCopy: function() {\n    var time = this.props.time;\n\n    if (hasRelativeTimeframe(this.props.time)) {\n      var subIntervalCopy = FormatUtils.singularize(time.sub_timeframe, time.amount);\n      var timeAmountPluralSuffix = time.amount > 1 ? 's' : '';\n      var relativityCopy = time.relativity == 'this' ? 'including' : 'excluding';\n      var singularCurrentInterval = FormatUtils.singularize(subIntervalCopy);\n\n      return (<p className=\"help-block\">The last {time.amount} {subIntervalCopy}{timeAmountPluralSuffix} <b>{relativityCopy}</b> the current {singularCurrentInterval}.</p>);\n    }\n  },\n\n  // React Methods\n\n  render: function() {\n    var descriptionCopy = this.buildDescriptionCopy();\n\n    return (\n      <div className=\"relative-timeframe-picker\">\n        <div className=\"row\">\n          <div className=\"col-xs-4 form-collapse-right\" id=\"relative-type\">\n            <div className=\"btn-group width-100\">\n              <Select label={false}\n                      name=\"relativity\"\n                      classes=\"relativity width-100\"\n                      options={RELATIVE_TIMEFRAMES}\n                      emptyOption={false}\n                      handleSelection={this.setRelativeTime}\n                      selectedOption={this.props.time.relativity} />\n            </div>\n          </div>\n          <div className=\"col-xs-3 form-collapse-left form-collapse-right\" id=\"interval-amount\">\n            <Input label={false}\n                   name=\"amount\"\n                   classes=\"amount\"\n                   type=\"number\"\n                   onChange={this.setRelativeTime}\n                   placeholder=\"e.g. 1\"\n                   value={this.props.time.amount || \"\"}\n                   autoComplete=\"off\" />\n          </div>\n          <div className=\"col-xs-5 form-collapse-left\" id=\"sub-interval-type\">\n            <Select label={false}\n                    name=\"sub_timeframe\"\n                    classes=\"sub-timeframe\"\n                    options={this.props.relativeIntervalTypes}\n                    emptyOption={false}\n                    handleSelection={this.setRelativeTime}\n                    selectedOption={this.props.time.sub_timeframe}\n                    sort={false} />\n          </div>\n        </div>\n        {descriptionCopy}\n      </div>\n    );\n  }\n});\n\nexport default RelativePicker;\n","\n/*!\n * Time picker for pickadate.js v3.5.4\n * http://amsul.github.io/pickadate.js/time.htm\n */\n\n(function ( factory ) {\n\n    // AMD.\n    if ( typeof define == 'function' && define.amd )\n        define( ['picker','jquery'], factory )\n\n    // Node.js/browserify.\n    else if ( typeof exports == 'object' )\n        module.exports = factory( require('./picker.js'), require('jquery') )\n\n    // Browser globals.\n    else factory( Picker, jQuery )\n\n}(function( Picker, $ ) {\n\n\n/**\n * Globals and constants\n */\nvar HOURS_IN_DAY = 24,\n    MINUTES_IN_HOUR = 60,\n    HOURS_TO_NOON = 12,\n    MINUTES_IN_DAY = HOURS_IN_DAY * MINUTES_IN_HOUR,\n    _ = Picker._\n\n\n\n/**\n * The time picker constructor\n */\nfunction TimePicker( picker, settings ) {\n\n    var clock = this,\n        elementValue = picker.$node[ 0 ].value,\n        elementDataValue = picker.$node.data( 'value' ),\n        valueString = elementDataValue || elementValue,\n        formatString = elementDataValue ? settings.formatSubmit : settings.format\n\n    clock.settings = settings\n    clock.$node = picker.$node\n\n    // The queue of methods that will be used to build item objects.\n    clock.queue = {\n        interval: 'i',\n        min: 'measure create',\n        max: 'measure create',\n        now: 'now create',\n        select: 'parse create validate',\n        highlight: 'parse create validate',\n        view: 'parse create validate',\n        disable: 'deactivate',\n        enable: 'activate'\n    }\n\n    // The component's item object.\n    clock.item = {}\n\n    clock.item.clear = null\n    clock.item.interval = settings.interval || 30\n    clock.item.disable = ( settings.disable || [] ).slice( 0 )\n    clock.item.enable = -(function( collectionDisabled ) {\n        return collectionDisabled[ 0 ] === true ? collectionDisabled.shift() : -1\n    })( clock.item.disable )\n\n    clock.\n        set( 'min', settings.min ).\n        set( 'max', settings.max ).\n        set( 'now' )\n\n    // When there’s a value, set the `select`, which in turn\n    // also sets the `highlight` and `view`.\n    if ( valueString ) {\n        clock.set( 'select', valueString, {\n            format: formatString,\n            fromValue: !!elementValue\n        })\n    }\n\n    // If there’s no value, default to highlighting “today”.\n    else {\n        clock.\n            set( 'select', null ).\n            set( 'highlight', clock.item.now )\n    }\n\n    // The keycode to movement mapping.\n    clock.key = {\n        40: 1, // Down\n        38: -1, // Up\n        39: 1, // Right\n        37: -1, // Left\n        go: function( timeChange ) {\n            clock.set(\n                'highlight',\n                clock.item.highlight.pick + timeChange * clock.item.interval,\n                { interval: timeChange * clock.item.interval }\n            )\n            this.render()\n        }\n    }\n\n\n    // Bind some picker events.\n    picker.\n        on( 'render', function() {\n            var $pickerHolder = picker.$root.children(),\n                $viewset = $pickerHolder.find( '.' + settings.klass.viewset ),\n                vendors = function( prop ) {\n                    return ['webkit', 'moz', 'ms', 'o', ''].map(function( vendor ) {\n                        return ( vendor ? '-' + vendor + '-' : '' ) + prop\n                    })\n                },\n                animations = function( $el, state ) {\n                    vendors( 'transform' ).map(function( prop ) {\n                        $el.css( prop, state )\n                    })\n                    vendors( 'transition' ).map(function( prop ) {\n                        $el.css( prop, state )\n                    })\n                }\n            if ( $viewset.length ) {\n                animations( $pickerHolder, 'none' )\n                $pickerHolder[ 0 ].scrollTop = ~~$viewset.position().top - ( $viewset[ 0 ].clientHeight * 2 )\n                animations( $pickerHolder, '' )\n            }\n        }, 1 ).\n        on( 'open', function() {\n            picker.$root.find( 'button' ).attr( 'disabled', false )\n        }, 1 ).\n        on( 'close', function() {\n            picker.$root.find( 'button' ).attr( 'disabled', true )\n        }, 1 )\n\n} //TimePicker\n\n\n/**\n * Set a timepicker item object.\n */\nTimePicker.prototype.set = function( type, value, options ) {\n\n    var clock = this,\n        clockItem = clock.item\n\n    // If the value is `null` just set it immediately.\n    if ( value === null ) {\n        if ( type == 'clear' ) type = 'select'\n        clockItem[ type ] = value\n        return clock\n    }\n\n    // Otherwise go through the queue of methods, and invoke the functions.\n    // Update this as the time unit, and set the final value as this item.\n    // * In the case of `enable`, keep the queue but set `disable` instead.\n    //   And in the case of `flip`, keep the queue but set `enable` instead.\n    clockItem[ ( type == 'enable' ? 'disable' : type == 'flip' ? 'enable' : type ) ] = clock.queue[ type ].split( ' ' ).map( function( method ) {\n        value = clock[ method ]( type, value, options )\n        return value\n    }).pop()\n\n    // Check if we need to cascade through more updates.\n    if ( type == 'select' ) {\n        clock.set( 'highlight', clockItem.select, options )\n    }\n    else if ( type == 'highlight' ) {\n        clock.set( 'view', clockItem.highlight, options )\n    }\n    else if ( type == 'interval' ) {\n        clock.\n            set( 'min', clockItem.min, options ).\n            set( 'max', clockItem.max, options )\n    }\n    else if ( type.match( /^(flip|min|max|disable|enable)$/ ) ) {\n        if ( type == 'min' ) {\n            clock.set( 'max', clockItem.max, options )\n        }\n        if ( clockItem.select && clock.disabled( clockItem.select ) ) {\n            clock.set( 'select', clockItem.select, options )\n        }\n        if ( clockItem.highlight && clock.disabled( clockItem.highlight ) ) {\n            clock.set( 'highlight', clockItem.highlight, options )\n        }\n    }\n\n    return clock\n} //TimePicker.prototype.set\n\n\n/**\n * Get a timepicker item object.\n */\nTimePicker.prototype.get = function( type ) {\n    return this.item[ type ]\n} //TimePicker.prototype.get\n\n\n/**\n * Create a picker time object.\n */\nTimePicker.prototype.create = function( type, value, options ) {\n\n    var clock = this\n\n    // If there’s no value, use the type as the value.\n    value = value === undefined ? type : value\n\n    // If it’s a date object, convert it into an array.\n    if ( _.isDate( value ) ) {\n        value = [ value.getHours(), value.getMinutes() ]\n    }\n\n    // If it’s an object, use the “pick” value.\n    if ( $.isPlainObject( value ) && _.isInteger( value.pick ) ) {\n        value = value.pick\n    }\n\n    // If it’s an array, convert it into minutes.\n    else if ( $.isArray( value ) ) {\n        value = +value[ 0 ] * MINUTES_IN_HOUR + (+value[ 1 ])\n    }\n\n    // If no valid value is passed, set it to “now”.\n    else if ( !_.isInteger( value ) ) {\n        value = clock.now( type, value, options )\n    }\n\n    // If we’re setting the max, make sure it’s greater than the min.\n    if ( type == 'max' && value < clock.item.min.pick ) {\n        value += MINUTES_IN_DAY\n    }\n\n    // If the value doesn’t fall directly on the interval,\n    // add one interval to indicate it as “passed”.\n    if ( type != 'min' && type != 'max' && (value - clock.item.min.pick) % clock.item.interval !== 0 ) {\n        value += clock.item.interval\n    }\n\n    // Normalize it into a “reachable” interval.\n    value = clock.normalize( type, value, options )\n\n    // Return the compiled object.\n    return {\n\n        // Divide to get hours from minutes.\n        hour: ~~( HOURS_IN_DAY + value / MINUTES_IN_HOUR ) % HOURS_IN_DAY,\n\n        // The remainder is the minutes.\n        mins: ( MINUTES_IN_HOUR + value % MINUTES_IN_HOUR ) % MINUTES_IN_HOUR,\n\n        // The time in total minutes.\n        time: ( MINUTES_IN_DAY + value ) % MINUTES_IN_DAY,\n\n        // Reference to the “relative” value to pick.\n        pick: value\n    }\n} //TimePicker.prototype.create\n\n\n/**\n * Create a range limit object using an array, date object,\n * literal “true”, or integer relative to another time.\n */\nTimePicker.prototype.createRange = function( from, to ) {\n\n    var clock = this,\n        createTime = function( time ) {\n            if ( time === true || $.isArray( time ) || _.isDate( time ) ) {\n                return clock.create( time )\n            }\n            return time\n        }\n\n    // Create objects if possible.\n    if ( !_.isInteger( from ) ) {\n        from = createTime( from )\n    }\n    if ( !_.isInteger( to ) ) {\n        to = createTime( to )\n    }\n\n    // Create relative times.\n    if ( _.isInteger( from ) && $.isPlainObject( to ) ) {\n        from = [ to.hour, to.mins + ( from * clock.settings.interval ) ];\n    }\n    else if ( _.isInteger( to ) && $.isPlainObject( from ) ) {\n        to = [ from.hour, from.mins + ( to * clock.settings.interval ) ];\n    }\n\n    return {\n        from: createTime( from ),\n        to: createTime( to )\n    }\n} //TimePicker.prototype.createRange\n\n\n/**\n * Check if a time unit falls within a time range object.\n */\nTimePicker.prototype.withinRange = function( range, timeUnit ) {\n    range = this.createRange(range.from, range.to)\n    return timeUnit.pick >= range.from.pick && timeUnit.pick <= range.to.pick\n}\n\n\n/**\n * Check if two time range objects overlap.\n */\nTimePicker.prototype.overlapRanges = function( one, two ) {\n\n    var clock = this\n\n    // Convert the ranges into comparable times.\n    one = clock.createRange( one.from, one.to )\n    two = clock.createRange( two.from, two.to )\n\n    return clock.withinRange( one, two.from ) || clock.withinRange( one, two.to ) ||\n        clock.withinRange( two, one.from ) || clock.withinRange( two, one.to )\n}\n\n\n/**\n * Get the time relative to now.\n */\nTimePicker.prototype.now = function( type, value/*, options*/ ) {\n\n    var interval = this.item.interval,\n        date = new Date(),\n        nowMinutes = date.getHours() * MINUTES_IN_HOUR + date.getMinutes(),\n        isValueInteger = _.isInteger( value ),\n        isBelowInterval\n\n    // Make sure “now” falls within the interval range.\n    nowMinutes -= nowMinutes % interval\n\n    // Check if the difference is less than the interval itself.\n    isBelowInterval = value < 0 && interval * value + nowMinutes <= -interval\n\n    // Add an interval because the time has “passed”.\n    nowMinutes += type == 'min' && isBelowInterval ? 0 : interval\n\n    // If the value is a number, adjust by that many intervals.\n    if ( isValueInteger ) {\n        nowMinutes += interval * (\n            isBelowInterval && type != 'max' ?\n                value + 1 :\n                value\n            )\n    }\n\n    // Return the final calculation.\n    return nowMinutes\n} //TimePicker.prototype.now\n\n\n/**\n * Normalize minutes to be “reachable” based on the min and interval.\n */\nTimePicker.prototype.normalize = function( type, value/*, options*/ ) {\n\n    var interval = this.item.interval,\n        minTime = this.item.min && this.item.min.pick || 0\n\n    // If setting min time, don’t shift anything.\n    // Otherwise get the value and min difference and then\n    // normalize the difference with the interval.\n    value -= type == 'min' ? 0 : ( value - minTime ) % interval\n\n    // Return the adjusted value.\n    return value\n} //TimePicker.prototype.normalize\n\n\n/**\n * Measure the range of minutes.\n */\nTimePicker.prototype.measure = function( type, value, options ) {\n\n    var clock = this\n\n    // If it’s anything false-y, set it to the default.\n    if ( !value ) {\n        value = type == 'min' ? [ 0, 0 ] : [ HOURS_IN_DAY - 1, MINUTES_IN_HOUR - 1 ]\n    }\n\n    // If it’s a string, parse it.\n    if ( typeof value == 'string' ) {\n        value = clock.parse( type, value )\n    }\n\n    // If it’s a literal true, or an integer, make it relative to now.\n    else if ( value === true || _.isInteger( value ) ) {\n        value = clock.now( type, value, options )\n    }\n\n    // If it’s an object already, just normalize it.\n    else if ( $.isPlainObject( value ) && _.isInteger( value.pick ) ) {\n        value = clock.normalize( type, value.pick, options )\n    }\n\n    return value\n} ///TimePicker.prototype.measure\n\n\n/**\n * Validate an object as enabled.\n */\nTimePicker.prototype.validate = function( type, timeObject, options ) {\n\n    var clock = this,\n        interval = options && options.interval ? options.interval : clock.item.interval\n\n    // Check if the object is disabled.\n    if ( clock.disabled( timeObject ) ) {\n\n        // Shift with the interval until we reach an enabled time.\n        timeObject = clock.shift( timeObject, interval )\n    }\n\n    // Scope the object into range.\n    timeObject = clock.scope( timeObject )\n\n    // Do a second check to see if we landed on a disabled min/max.\n    // In that case, shift using the opposite interval as before.\n    if ( clock.disabled( timeObject ) ) {\n        timeObject = clock.shift( timeObject, interval * -1 )\n    }\n\n    // Return the final object.\n    return timeObject\n} //TimePicker.prototype.validate\n\n\n/**\n * Check if an object is disabled.\n */\nTimePicker.prototype.disabled = function( timeToVerify ) {\n\n    var clock = this,\n\n        // Filter through the disabled times to check if this is one.\n        isDisabledMatch = clock.item.disable.filter( function( timeToDisable ) {\n\n            // If the time is a number, match the hours.\n            if ( _.isInteger( timeToDisable ) ) {\n                return timeToVerify.hour == timeToDisable\n            }\n\n            // If it’s an array, create the object and match the times.\n            if ( $.isArray( timeToDisable ) || _.isDate( timeToDisable ) ) {\n                return timeToVerify.pick == clock.create( timeToDisable ).pick\n            }\n\n            // If it’s an object, match a time within the “from” and “to” range.\n            if ( $.isPlainObject( timeToDisable ) ) {\n                return clock.withinRange( timeToDisable, timeToVerify )\n            }\n        })\n\n    // If this time matches a disabled time, confirm it’s not inverted.\n    isDisabledMatch = isDisabledMatch.length && !isDisabledMatch.filter(function( timeToDisable ) {\n        return $.isArray( timeToDisable ) && timeToDisable[2] == 'inverted' ||\n            $.isPlainObject( timeToDisable ) && timeToDisable.inverted\n    }).length\n\n    // If the clock is \"enabled\" flag is flipped, flip the condition.\n    return clock.item.enable === -1 ? !isDisabledMatch : isDisabledMatch ||\n        timeToVerify.pick < clock.item.min.pick ||\n        timeToVerify.pick > clock.item.max.pick\n} //TimePicker.prototype.disabled\n\n\n/**\n * Shift an object by an interval until we reach an enabled object.\n */\nTimePicker.prototype.shift = function( timeObject, interval ) {\n\n    var clock = this,\n        minLimit = clock.item.min.pick,\n        maxLimit = clock.item.max.pick/*,\n        safety = 1000*/\n\n    interval = interval || clock.item.interval\n\n    // Keep looping as long as the time is disabled.\n    while ( /*safety &&*/ clock.disabled( timeObject ) ) {\n\n        /*safety -= 1\n        if ( !safety ) {\n            throw 'Fell into an infinite loop while shifting to ' + timeObject.hour + ':' + timeObject.mins + '.'\n        }*/\n\n        // Increase/decrease the time by the interval and keep looping.\n        timeObject = clock.create( timeObject.pick += interval )\n\n        // If we've looped beyond the limits, break out of the loop.\n        if ( timeObject.pick <= minLimit || timeObject.pick >= maxLimit ) {\n            break\n        }\n    }\n\n    // Return the final object.\n    return timeObject\n} //TimePicker.prototype.shift\n\n\n/**\n * Scope an object to be within range of min and max.\n */\nTimePicker.prototype.scope = function( timeObject ) {\n    var minLimit = this.item.min.pick,\n        maxLimit = this.item.max.pick\n    return this.create( timeObject.pick > maxLimit ? maxLimit : timeObject.pick < minLimit ? minLimit : timeObject )\n} //TimePicker.prototype.scope\n\n\n/**\n * Parse a string into a usable type.\n */\nTimePicker.prototype.parse = function( type, value, options ) {\n\n    var hour, minutes, isPM, item, parseValue,\n        clock = this,\n        parsingObject = {}\n\n    // If it’s already parsed, we’re good.\n    if ( !value || typeof value != 'string' ) {\n        return value\n    }\n\n    // We need a `.format` to parse the value with.\n    if ( !( options && options.format ) ) {\n        options = options || {}\n        options.format = clock.settings.format\n    }\n\n    // Convert the format into an array and then map through it.\n    clock.formats.toArray( options.format ).map( function( label ) {\n\n        var\n            substring,\n\n            // Grab the formatting label.\n            formattingLabel = clock.formats[ label ],\n\n            // The format length is from the formatting label function or the\n            // label length without the escaping exclamation (!) mark.\n            formatLength = formattingLabel ?\n                _.trigger( formattingLabel, clock, [ value, parsingObject ] ) :\n                label.replace( /^!/, '' ).length\n\n        // If there's a format label, split the value up to the format length.\n        // Then add it to the parsing object with appropriate label.\n        if ( formattingLabel ) {\n            substring = value.substr( 0, formatLength )\n            parsingObject[ label ] = substring.match(/^\\d+$/) ? +substring : substring\n        }\n\n        // Update the time value as the substring from format length to end.\n        value = value.substr( formatLength )\n    })\n\n    // Grab the hour and minutes from the parsing object.\n    for ( item in parsingObject ) {\n        parseValue = parsingObject[item]\n        if ( _.isInteger(parseValue) ) {\n            if ( item.match(/^(h|hh)$/i) ) {\n                hour = parseValue\n                if ( item == 'h' || item == 'hh' ) {\n                    hour %= 12\n                }\n            }\n            else if ( item == 'i' ) {\n                minutes = parseValue\n            }\n        }\n        else if ( item.match(/^a$/i) && parseValue.match(/^p/i) && ('h' in parsingObject || 'hh' in parsingObject) ) {\n            isPM = true\n        }\n    }\n\n    // Calculate it in minutes and return.\n    return (isPM ? hour + 12 : hour) * MINUTES_IN_HOUR + minutes\n} //TimePicker.prototype.parse\n\n\n/**\n * Various formats to display the object in.\n */\nTimePicker.prototype.formats = {\n\n    h: function( string, timeObject ) {\n\n        // If there's string, then get the digits length.\n        // Otherwise return the selected hour in \"standard\" format.\n        return string ? _.digits( string ) : timeObject.hour % HOURS_TO_NOON || HOURS_TO_NOON\n    },\n    hh: function( string, timeObject ) {\n\n        // If there's a string, then the length is always 2.\n        // Otherwise return the selected hour in \"standard\" format with a leading zero.\n        return string ? 2 : _.lead( timeObject.hour % HOURS_TO_NOON || HOURS_TO_NOON )\n    },\n    H: function( string, timeObject ) {\n\n        // If there's string, then get the digits length.\n        // Otherwise return the selected hour in \"military\" format as a string.\n        return string ? _.digits( string ) : '' + ( timeObject.hour % 24 )\n    },\n    HH: function( string, timeObject ) {\n\n        // If there's string, then get the digits length.\n        // Otherwise return the selected hour in \"military\" format with a leading zero.\n        return string ? _.digits( string ) : _.lead( timeObject.hour % 24 )\n    },\n    i: function( string, timeObject ) {\n\n        // If there's a string, then the length is always 2.\n        // Otherwise return the selected minutes.\n        return string ? 2 : _.lead( timeObject.mins )\n    },\n    a: function( string, timeObject ) {\n\n        // If there's a string, then the length is always 4.\n        // Otherwise check if it's more than \"noon\" and return either am/pm.\n        return string ? 4 : MINUTES_IN_DAY / 2 > timeObject.time % MINUTES_IN_DAY ? 'a.m.' : 'p.m.'\n    },\n    A: function( string, timeObject ) {\n\n        // If there's a string, then the length is always 2.\n        // Otherwise check if it's more than \"noon\" and return either am/pm.\n        return string ? 2 : MINUTES_IN_DAY / 2 > timeObject.time % MINUTES_IN_DAY ? 'AM' : 'PM'\n    },\n\n    // Create an array by splitting the formatting string passed.\n    toArray: function( formatString ) { return formatString.split( /(h{1,2}|H{1,2}|i|a|A|!.)/g ) },\n\n    // Format an object into a string using the formatting options.\n    toString: function ( formatString, itemObject ) {\n        var clock = this\n        return clock.formats.toArray( formatString ).map( function( label ) {\n            return _.trigger( clock.formats[ label ], clock, [ 0, itemObject ] ) || label.replace( /^!/, '' )\n        }).join( '' )\n    }\n} //TimePicker.prototype.formats\n\n\n\n\n/**\n * Check if two time units are the exact.\n */\nTimePicker.prototype.isTimeExact = function( one, two ) {\n\n    var clock = this\n\n    // When we’re working with minutes, do a direct comparison.\n    if (\n        ( _.isInteger( one ) && _.isInteger( two ) ) ||\n        ( typeof one == 'boolean' && typeof two == 'boolean' )\n     ) {\n        return one === two\n    }\n\n    // When we’re working with time representations, compare the “pick” value.\n    if (\n        ( _.isDate( one ) || $.isArray( one ) ) &&\n        ( _.isDate( two ) || $.isArray( two ) )\n    ) {\n        return clock.create( one ).pick === clock.create( two ).pick\n    }\n\n    // When we’re working with range objects, compare the “from” and “to”.\n    if ( $.isPlainObject( one ) && $.isPlainObject( two ) ) {\n        return clock.isTimeExact( one.from, two.from ) && clock.isTimeExact( one.to, two.to )\n    }\n\n    return false\n}\n\n\n/**\n * Check if two time units overlap.\n */\nTimePicker.prototype.isTimeOverlap = function( one, two ) {\n\n    var clock = this\n\n    // When we’re working with an integer, compare the hours.\n    if ( _.isInteger( one ) && ( _.isDate( two ) || $.isArray( two ) ) ) {\n        return one === clock.create( two ).hour\n    }\n    if ( _.isInteger( two ) && ( _.isDate( one ) || $.isArray( one ) ) ) {\n        return two === clock.create( one ).hour\n    }\n\n    // When we’re working with range objects, check if the ranges overlap.\n    if ( $.isPlainObject( one ) && $.isPlainObject( two ) ) {\n        return clock.overlapRanges( one, two )\n    }\n\n    return false\n}\n\n\n/**\n * Flip the “enabled” state.\n */\nTimePicker.prototype.flipEnable = function(val) {\n    var itemObject = this.item\n    itemObject.enable = val || (itemObject.enable == -1 ? 1 : -1)\n}\n\n\n/**\n * Mark a collection of times as “disabled”.\n */\nTimePicker.prototype.deactivate = function( type, timesToDisable ) {\n\n    var clock = this,\n        disabledItems = clock.item.disable.slice(0)\n\n\n    // If we’re flipping, that’s all we need to do.\n    if ( timesToDisable == 'flip' ) {\n        clock.flipEnable()\n    }\n\n    else if ( timesToDisable === false ) {\n        clock.flipEnable(1)\n        disabledItems = []\n    }\n\n    else if ( timesToDisable === true ) {\n        clock.flipEnable(-1)\n        disabledItems = []\n    }\n\n    // Otherwise go through the times to disable.\n    else {\n\n        timesToDisable.map(function( unitToDisable ) {\n\n            var matchFound\n\n            // When we have disabled items, check for matches.\n            // If something is matched, immediately break out.\n            for ( var index = 0; index < disabledItems.length; index += 1 ) {\n                if ( clock.isTimeExact( unitToDisable, disabledItems[index] ) ) {\n                    matchFound = true\n                    break\n                }\n            }\n\n            // If nothing was found, add the validated unit to the collection.\n            if ( !matchFound ) {\n                if (\n                    _.isInteger( unitToDisable ) ||\n                    _.isDate( unitToDisable ) ||\n                    $.isArray( unitToDisable ) ||\n                    ( $.isPlainObject( unitToDisable ) && unitToDisable.from && unitToDisable.to )\n                ) {\n                    disabledItems.push( unitToDisable )\n                }\n            }\n        })\n    }\n\n    // Return the updated collection.\n    return disabledItems\n} //TimePicker.prototype.deactivate\n\n\n/**\n * Mark a collection of times as “enabled”.\n */\nTimePicker.prototype.activate = function( type, timesToEnable ) {\n\n    var clock = this,\n        disabledItems = clock.item.disable,\n        disabledItemsCount = disabledItems.length\n\n    // If we’re flipping, that’s all we need to do.\n    if ( timesToEnable == 'flip' ) {\n        clock.flipEnable()\n    }\n\n    else if ( timesToEnable === true ) {\n        clock.flipEnable(1)\n        disabledItems = []\n    }\n\n    else if ( timesToEnable === false ) {\n        clock.flipEnable(-1)\n        disabledItems = []\n    }\n\n    // Otherwise go through the disabled times.\n    else {\n\n        timesToEnable.map(function( unitToEnable ) {\n\n            var matchFound,\n                disabledUnit,\n                index,\n                isRangeMatched\n\n            // Go through the disabled items and try to find a match.\n            for ( index = 0; index < disabledItemsCount; index += 1 ) {\n\n                disabledUnit = disabledItems[index]\n\n                // When an exact match is found, remove it from the collection.\n                if ( clock.isTimeExact( disabledUnit, unitToEnable ) ) {\n                    matchFound = disabledItems[index] = null\n                    isRangeMatched = true\n                    break\n                }\n\n                // When an overlapped match is found, add the “inverted” state to it.\n                else if ( clock.isTimeOverlap( disabledUnit, unitToEnable ) ) {\n                    if ( $.isPlainObject( unitToEnable ) ) {\n                        unitToEnable.inverted = true\n                        matchFound = unitToEnable\n                    }\n                    else if ( $.isArray( unitToEnable ) ) {\n                        matchFound = unitToEnable\n                        if ( !matchFound[2] ) matchFound.push( 'inverted' )\n                    }\n                    else if ( _.isDate( unitToEnable ) ) {\n                        matchFound = [ unitToEnable.getFullYear(), unitToEnable.getMonth(), unitToEnable.getDate(), 'inverted' ]\n                    }\n                    break\n                }\n            }\n\n            // If a match was found, remove a previous duplicate entry.\n            if ( matchFound ) for ( index = 0; index < disabledItemsCount; index += 1 ) {\n                if ( clock.isTimeExact( disabledItems[index], unitToEnable ) ) {\n                    disabledItems[index] = null\n                    break\n                }\n            }\n\n            // In the event that we’re dealing with an overlap of range times,\n            // make sure there are no “inverted” times because of it.\n            if ( isRangeMatched ) for ( index = 0; index < disabledItemsCount; index += 1 ) {\n                if ( clock.isTimeOverlap( disabledItems[index], unitToEnable ) ) {\n                    disabledItems[index] = null\n                    break\n                }\n            }\n\n            // If something is still matched, add it into the collection.\n            if ( matchFound ) {\n                disabledItems.push( matchFound )\n            }\n        })\n    }\n\n    // Return the updated collection.\n    return disabledItems.filter(function( val ) { return val != null })\n} //TimePicker.prototype.activate\n\n\n/**\n * The division to use for the range intervals.\n */\nTimePicker.prototype.i = function( type, value/*, options*/ ) {\n    return _.isInteger( value ) && value > 0 ? value : this.item.interval\n}\n\n\n/**\n * Create a string for the nodes in the picker.\n */\nTimePicker.prototype.nodes = function( isOpen ) {\n\n    var\n        clock = this,\n        settings = clock.settings,\n        selectedObject = clock.item.select,\n        highlightedObject = clock.item.highlight,\n        viewsetObject = clock.item.view,\n        disabledCollection = clock.item.disable\n\n    return _.node(\n        'ul',\n        _.group({\n            min: clock.item.min.pick,\n            max: clock.item.max.pick,\n            i: clock.item.interval,\n            node: 'li',\n            item: function( loopedTime ) {\n                loopedTime = clock.create( loopedTime )\n                var timeMinutes = loopedTime.pick,\n                    isSelected = selectedObject && selectedObject.pick == timeMinutes,\n                    isHighlighted = highlightedObject && highlightedObject.pick == timeMinutes,\n                    isDisabled = disabledCollection && clock.disabled( loopedTime )\n                return [\n                    _.trigger( clock.formats.toString, clock, [ _.trigger( settings.formatLabel, clock, [ loopedTime ] ) || settings.format, loopedTime ] ),\n                    (function( klasses ) {\n\n                        if ( isSelected ) {\n                            klasses.push( settings.klass.selected )\n                        }\n\n                        if ( isHighlighted ) {\n                            klasses.push( settings.klass.highlighted )\n                        }\n\n                        if ( viewsetObject && viewsetObject.pick == timeMinutes ) {\n                            klasses.push( settings.klass.viewset )\n                        }\n\n                        if ( isDisabled ) {\n                            klasses.push( settings.klass.disabled )\n                        }\n\n                        return klasses.join( ' ' )\n                    })( [ settings.klass.listItem ] ),\n                    'data-pick=' + loopedTime.pick + ' ' + _.ariaAttr({\n                        role: 'option',\n                        selected: isSelected && clock.$node.val() === _.trigger(\n                                clock.formats.toString,\n                                clock,\n                                [ settings.format, loopedTime ]\n                            ) ? true : null,\n                        activedescendant: isHighlighted ? true : null,\n                        disabled: isDisabled ? true : null\n                    })\n                ]\n            }\n        }) +\n\n        // * For Firefox forms to submit, make sure to set the button’s `type` attribute as “button”.\n        _.node(\n            'li',\n            _.node(\n                'button',\n                settings.clear,\n                settings.klass.buttonClear,\n                'type=button data-clear=1' + ( isOpen ? '' : ' disabled' ) + ' ' +\n                _.ariaAttr({ controls: clock.$node[0].id })\n            ),\n            '', _.ariaAttr({ role: 'presentation' })\n        ),\n        settings.klass.list,\n        _.ariaAttr({ role: 'listbox', controls: clock.$node[0].id })\n    )\n} //TimePicker.prototype.nodes\n\n\n\n\n\n\n\n/* ==========================================================================\n   Extend the picker to add the component with the defaults.\n   ========================================================================== */\n\nTimePicker.defaults = (function( prefix ) {\n\n    return {\n\n        // Clear\n        clear: 'Clear',\n\n        // The format to show on the `input` element\n        format: 'h:i A',\n\n        // The interval between each time\n        interval: 30,\n\n        // Classes\n        klass: {\n\n            picker: prefix + ' ' + prefix + '--time',\n            holder: prefix + '__holder',\n\n            list: prefix + '__list',\n            listItem: prefix + '__list-item',\n\n            disabled: prefix + '__list-item--disabled',\n            selected: prefix + '__list-item--selected',\n            highlighted: prefix + '__list-item--highlighted',\n            viewset: prefix + '__list-item--viewset',\n            now: prefix + '__list-item--now',\n\n            buttonClear: prefix + '__button--clear'\n        }\n    }\n})( Picker.klasses().picker )\n\n\n\n\n\n/**\n * Extend the picker to add the time picker.\n */\nPicker.extend( 'pickatime', TimePicker )\n\n\n}));\n","\n/*!\n * Date picker for pickadate.js v3.5.4\n * http://amsul.github.io/pickadate.js/date.htm\n */\n\n(function ( factory ) {\n\n    // AMD.\n    if ( typeof define == 'function' && define.amd )\n        define( ['picker','jquery'], factory )\n\n    // Node.js/browserify.\n    else if ( typeof exports == 'object' )\n        module.exports = factory( require('./picker.js'), require('jquery') )\n\n    // Browser globals.\n    else factory( Picker, jQuery )\n\n}(function( Picker, $ ) {\n\n\n/**\n * Globals and constants\n */\nvar DAYS_IN_WEEK = 7,\n    WEEKS_IN_CALENDAR = 6,\n    _ = Picker._\n\n\n\n/**\n * The date picker constructor\n */\nfunction DatePicker( picker, settings ) {\n\n    var calendar = this,\n        element = picker.$node[ 0 ],\n        elementValue = element.value,\n        elementDataValue = picker.$node.data( 'value' ),\n        valueString = elementDataValue || elementValue,\n        formatString = elementDataValue ? settings.formatSubmit : settings.format,\n        isRTL = function() {\n\n            return element.currentStyle ?\n\n                // For IE.\n                element.currentStyle.direction == 'rtl' :\n\n                // For normal browsers.\n                getComputedStyle( picker.$root[0] ).direction == 'rtl'\n        }\n\n    calendar.settings = settings\n    calendar.$node = picker.$node\n\n    // The queue of methods that will be used to build item objects.\n    calendar.queue = {\n        min: 'measure create',\n        max: 'measure create',\n        now: 'now create',\n        select: 'parse create validate',\n        highlight: 'parse navigate create validate',\n        view: 'parse create validate viewset',\n        disable: 'deactivate',\n        enable: 'activate'\n    }\n\n    // The component's item object.\n    calendar.item = {}\n\n    calendar.item.clear = null\n    calendar.item.disable = ( settings.disable || [] ).slice( 0 )\n    calendar.item.enable = -(function( collectionDisabled ) {\n        return collectionDisabled[ 0 ] === true ? collectionDisabled.shift() : -1\n    })( calendar.item.disable )\n\n    calendar.\n        set( 'min', settings.min ).\n        set( 'max', settings.max ).\n        set( 'now' )\n\n    // When there’s a value, set the `select`, which in turn\n    // also sets the `highlight` and `view`.\n    if ( valueString ) {\n        calendar.set( 'select', valueString, { format: formatString })\n    }\n\n    // If there’s no value, default to highlighting “today”.\n    else {\n        calendar.\n            set( 'select', null ).\n            set( 'highlight', calendar.item.now )\n    }\n\n\n    // The keycode to movement mapping.\n    calendar.key = {\n        40: 7, // Down\n        38: -7, // Up\n        39: function() { return isRTL() ? -1 : 1 }, // Right\n        37: function() { return isRTL() ? 1 : -1 }, // Left\n        go: function( timeChange ) {\n            var highlightedObject = calendar.item.highlight,\n                targetDate = new Date( Date.UTC(highlightedObject.year, highlightedObject.month, highlightedObject.date + timeChange) )\n            calendar.set(\n                'highlight',\n                targetDate,\n                { interval: timeChange }\n            )\n            this.render()\n        }\n    }\n\n\n    // Bind some picker events.\n    picker.\n        on( 'render', function() {\n            picker.$root.find( '.' + settings.klass.selectMonth ).on( 'change', function() {\n                var value = this.value\n                if ( value ) {\n                    picker.set( 'highlight', [ picker.get( 'view' ).year, value, picker.get( 'highlight' ).date ] )\n                    picker.$root.find( '.' + settings.klass.selectMonth ).trigger( 'focus' )\n                }\n            })\n            picker.$root.find( '.' + settings.klass.selectYear ).on( 'change', function() {\n                var value = this.value\n                if ( value ) {\n                    picker.set( 'highlight', [ value, picker.get( 'view' ).month, picker.get( 'highlight' ).date ] )\n                    picker.$root.find( '.' + settings.klass.selectYear ).trigger( 'focus' )\n                }\n            })\n        }, 1 ).\n        on( 'open', function() {\n            var includeToday = ''\n            if ( calendar.disabled( calendar.get('now') ) ) {\n                includeToday = ':not(.' + settings.klass.buttonToday + ')'\n            }\n            picker.$root.find( 'button' + includeToday + ', select' ).attr( 'disabled', false )\n        }, 1 ).\n        on( 'close', function() {\n            picker.$root.find( 'button, select' ).attr( 'disabled', true )\n        }, 1 )\n\n} //DatePicker\n\n\n/**\n * Set a datepicker item object.\n */\nDatePicker.prototype.set = function( type, value, options ) {\n\n    var calendar = this,\n        calendarItem = calendar.item\n\n    // If the value is `null` just set it immediately.\n    if ( value === null ) {\n        if ( type == 'clear' ) type = 'select'\n        calendarItem[ type ] = value\n        return calendar\n    }\n\n    // Otherwise go through the queue of methods, and invoke the functions.\n    // Update this as the time unit, and set the final value as this item.\n    // * In the case of `enable`, keep the queue but set `disable` instead.\n    //   And in the case of `flip`, keep the queue but set `enable` instead.\n    calendarItem[ ( type == 'enable' ? 'disable' : type == 'flip' ? 'enable' : type ) ] = calendar.queue[ type ].split( ' ' ).map( function( method ) {\n        value = calendar[ method ]( type, value, options )\n        return value\n    }).pop()\n\n    // Check if we need to cascade through more updates.\n    if ( type == 'select' ) {\n        calendar.set( 'highlight', calendarItem.select, options )\n    }\n    else if ( type == 'highlight' ) {\n        calendar.set( 'view', calendarItem.highlight, options )\n    }\n    else if ( type.match( /^(flip|min|max|disable|enable)$/ ) ) {\n        if ( calendarItem.select && calendar.disabled( calendarItem.select ) ) {\n            calendar.set( 'select', calendarItem.select, options )\n        }\n        if ( calendarItem.highlight && calendar.disabled( calendarItem.highlight ) ) {\n            calendar.set( 'highlight', calendarItem.highlight, options )\n        }\n    }\n\n    return calendar\n} //DatePicker.prototype.set\n\n\n/**\n * Get a datepicker item object.\n */\nDatePicker.prototype.get = function( type ) {\n    return this.item[ type ]\n} //DatePicker.prototype.get\n\n\n/**\n * Create a picker date object.\n */\nDatePicker.prototype.create = function( type, value, options ) {\n\n    var isInfiniteValue,\n        calendar = this\n\n    // If there’s no value, use the type as the value.\n    value = value === undefined ? type : value\n\n\n    // If it’s infinity, update the value.\n    if ( value == -Infinity || value == Infinity ) {\n        isInfiniteValue = value\n    }\n\n    // If it’s an object, use the native date object.\n    else if ( $.isPlainObject( value ) && _.isInteger( value.pick ) ) {\n        value = value.obj\n    }\n\n    // If it’s an array, convert it into a date and make sure\n    // that it’s a valid date – otherwise default to today.\n    else if ( $.isArray( value ) ) {\n        value = new Date(Date.UTC(value[ 0 ], value[ 1 ], value[ 2 ] ))\n        value = _.isDate( value ) ? value : calendar.create().obj\n    }\n\n    // If it’s a number, make a normalized date.\n    else if ( _.isInteger( value ) ) {\n        value = calendar.normalize( new Date( value ), options )\n    }\n\n    // If it’s a date object, make a normalized date.\n    else if ( _.isDate( value ) ) {\n        value = calendar.normalize( value, options )\n    }\n\n    // If it’s a literal true or any other case, set it to now.\n    else /*if ( value === true )*/ {\n        value = calendar.now( type, value, options )\n    }\n\n    // Return the compiled object.\n    return {\n        year: isInfiniteValue || value.getUTCFullYear(),\n        month: isInfiniteValue || value.getUTCMonth(),\n        date: isInfiniteValue || value.getUTCDate(),\n        day: isInfiniteValue || value.getUTCDay(),\n        obj: isInfiniteValue || value,\n        pick: isInfiniteValue || value.getTime()\n    }\n} //DatePicker.prototype.create\n\n\n/**\n * Create a range limit object using an array, date object,\n * literal “true”, or integer relative to another time.\n */\nDatePicker.prototype.createRange = function( from, to ) {\n\n    var calendar = this,\n        createDate = function( date ) {\n            if ( date === true || $.isArray( date ) || _.isDate( date ) ) {\n                return calendar.create( date )\n            }\n            return date\n        }\n\n    // Create objects if possible.\n    if ( !_.isInteger( from ) ) {\n        from = createDate( from )\n    }\n    if ( !_.isInteger( to ) ) {\n        to = createDate( to )\n    }\n\n    // Create relative dates.\n    if ( _.isInteger( from ) && $.isPlainObject( to ) ) {\n        from = [ to.year, to.month, to.date + from ];\n    }\n    else if ( _.isInteger( to ) && $.isPlainObject( from ) ) {\n        to = [ from.year, from.month, from.date + to ];\n    }\n\n    return {\n        from: createDate( from ),\n        to: createDate( to )\n    }\n} //DatePicker.prototype.createRange\n\n\n/**\n * Check if a date unit falls within a date range object.\n */\nDatePicker.prototype.withinRange = function( range, dateUnit ) {\n    range = this.createRange(range.from, range.to)\n    return dateUnit.pick >= range.from.pick && dateUnit.pick <= range.to.pick\n}\n\n\n/**\n * Check if two date range objects overlap.\n */\nDatePicker.prototype.overlapRanges = function( one, two ) {\n\n    var calendar = this\n\n    // Convert the ranges into comparable dates.\n    one = calendar.createRange( one.from, one.to )\n    two = calendar.createRange( two.from, two.to )\n\n    return calendar.withinRange( one, two.from ) || calendar.withinRange( one, two.to ) ||\n        calendar.withinRange( two, one.from ) || calendar.withinRange( two, one.to )\n}\n\n\n/**\n * Get the date today.\n */\nDatePicker.prototype.now = function( type, value, options ) {\n    value = new Date()\n    if ( options && options.rel ) {\n        value.setUTCDate( value.getUTCDate() + options.rel )\n    }\n    return this.normalize( value, options )\n}\n\n\n/**\n * Navigate to next/prev month.\n */\nDatePicker.prototype.navigate = function( type, value, options ) {\n\n    var targetDateObject,\n        targetYear,\n        targetMonth,\n        targetDate,\n        isTargetArray = $.isArray( value ),\n        isTargetObject = $.isPlainObject( value ),\n        viewsetObject = this.item.view/*,\n        safety = 100*/\n\n\n    if ( isTargetArray || isTargetObject ) {\n\n        if ( isTargetObject ) {\n            targetYear = value.year\n            targetMonth = value.month\n            targetDate = value.date\n        }\n        else {\n            targetYear = +value[0]\n            targetMonth = +value[1]\n            targetDate = +value[2]\n        }\n\n        // If we’re navigating months but the view is in a different\n        // month, navigate to the view’s year and month.\n        if ( options && options.nav && viewsetObject && viewsetObject.month !== targetMonth ) {\n            targetYear = viewsetObject.year\n            targetMonth = viewsetObject.month\n        }\n\n        // Figure out the expected target year and month.\n        targetDateObject = new Date( Date.UTC( targetYear, targetMonth + ( options && options.nav ? options.nav : 0 ), 1 ) )\n        targetYear = targetDateObject.getUTCFullYear()\n        targetMonth = targetDateObject.getUTCMonth()\n\n        // If the month we’re going to doesn’t have enough days,\n        // keep decreasing the date until we reach the month’s last date.\n        while ( /*safety &&*/ new Date( Date.UTC( targetYear, targetMonth, targetDate ) ).getUTCMonth() !== targetMonth ) {\n            targetDate -= 1\n            /*safety -= 1\n            if ( !safety ) {\n                throw 'Fell into an infinite loop while navigating to ' + new Date( targetYear, targetMonth, targetDate ) + '.'\n            }*/\n        }\n\n        value = [ targetYear, targetMonth, targetDate ]\n    }\n\n    return value\n} //DatePicker.prototype.navigate\n\n\n/**\n * Normalize a date by setting the hours to midnight.\n */\nDatePicker.prototype.normalize = function( value/*, options*/ ) {\n    value.setUTCHours( 0, 0, 0, 0 )\n    return value\n}\n\n\n/**\n * Measure the range of dates.\n */\nDatePicker.prototype.measure = function( type, value/*, options*/ ) {\n\n    var calendar = this\n\n    // If it’s anything false-y, remove the limits.\n    if ( !value ) {\n        value = type == 'min' ? -Infinity : Infinity\n    }\n\n    // If it’s a string, parse it.\n    else if ( typeof value == 'string' ) {\n        value = calendar.parse( type, value )\n    }\n\n    // If it's an integer, get a date relative to today.\n    else if ( _.isInteger( value ) ) {\n        value = calendar.now( type, value, { rel: value } )\n    }\n\n    return value\n} ///DatePicker.prototype.measure\n\n\n/**\n * Create a viewset object based on navigation.\n */\nDatePicker.prototype.viewset = function( type, dateObject/*, options*/ ) {\n    return this.create([ dateObject.year, dateObject.month, 1 ])\n}\n\n\n/**\n * Validate a date as enabled and shift if needed.\n */\nDatePicker.prototype.validate = function( type, dateObject, options ) {\n\n    var calendar = this,\n\n        // Keep a reference to the original date.\n        originalDateObject = dateObject,\n\n        // Make sure we have an interval.\n        interval = options && options.interval ? options.interval : 1,\n\n        // Check if the calendar enabled dates are inverted.\n        isFlippedBase = calendar.item.enable === -1,\n\n        // Check if we have any enabled dates after/before now.\n        hasEnabledBeforeTarget, hasEnabledAfterTarget,\n\n        // The min & max limits.\n        minLimitObject = calendar.item.min,\n        maxLimitObject = calendar.item.max,\n\n        // Check if we’ve reached the limit during shifting.\n        reachedMin, reachedMax,\n\n        // Check if the calendar is inverted and at least one weekday is enabled.\n        hasEnabledWeekdays = isFlippedBase && calendar.item.disable.filter( function( value ) {\n\n            // If there’s a date, check where it is relative to the target.\n            if ( $.isArray( value ) ) {\n                var dateTime = calendar.create( value ).pick\n                if ( dateTime < dateObject.pick ) hasEnabledBeforeTarget = true\n                else if ( dateTime > dateObject.pick ) hasEnabledAfterTarget = true\n            }\n\n            // Return only integers for enabled weekdays.\n            return _.isInteger( value )\n        }).length/*,\n\n        safety = 100*/\n\n\n\n    // Cases to validate for:\n    // [1] Not inverted and date disabled.\n    // [2] Inverted and some dates enabled.\n    // [3] Not inverted and out of range.\n    //\n    // Cases to **not** validate for:\n    // • Navigating months.\n    // • Not inverted and date enabled.\n    // • Inverted and all dates disabled.\n    // • ..and anything else.\n    if ( !options || !options.nav ) if (\n        /* 1 */ ( !isFlippedBase && calendar.disabled( dateObject ) ) ||\n        /* 2 */ ( isFlippedBase && calendar.disabled( dateObject ) && ( hasEnabledWeekdays || hasEnabledBeforeTarget || hasEnabledAfterTarget ) ) ||\n        /* 3 */ ( !isFlippedBase && (dateObject.pick <= minLimitObject.pick || dateObject.pick >= maxLimitObject.pick) )\n    ) {\n\n\n        // When inverted, flip the direction if there aren’t any enabled weekdays\n        // and there are no enabled dates in the direction of the interval.\n        if ( isFlippedBase && !hasEnabledWeekdays && ( ( !hasEnabledAfterTarget && interval > 0 ) || ( !hasEnabledBeforeTarget && interval < 0 ) ) ) {\n            interval *= -1\n        }\n\n\n        // Keep looping until we reach an enabled date.\n        while ( /*safety &&*/ calendar.disabled( dateObject ) ) {\n\n            /*safety -= 1\n            if ( !safety ) {\n                throw 'Fell into an infinite loop while validating ' + dateObject.obj + '.'\n            }*/\n\n\n            // If we’ve looped into the next/prev month with a large interval, return to the original date and flatten the interval.\n            if ( Math.abs( interval ) > 1 && ( dateObject.month < originalDateObject.month || dateObject.month > originalDateObject.month ) ) {\n                dateObject = originalDateObject\n                interval = interval > 0 ? 1 : -1\n            }\n\n\n            // If we’ve reached the min/max limit, reverse the direction, flatten the interval and set it to the limit.\n            if ( dateObject.pick <= minLimitObject.pick ) {\n                reachedMin = true\n                interval = 1\n                dateObject = calendar.create([\n                    minLimitObject.year,\n                    minLimitObject.month,\n                    minLimitObject.date + (dateObject.pick === minLimitObject.pick ? 0 : -1)\n                ])\n            }\n            else if ( dateObject.pick >= maxLimitObject.pick ) {\n                reachedMax = true\n                interval = -1\n                dateObject = calendar.create([\n                    maxLimitObject.year,\n                    maxLimitObject.month,\n                    maxLimitObject.date + (dateObject.pick === maxLimitObject.pick ? 0 : 1)\n                ])\n            }\n\n\n            // If we’ve reached both limits, just break out of the loop.\n            if ( reachedMin && reachedMax ) {\n                break\n            }\n\n\n            // Finally, create the shifted date using the interval and keep looping.\n            dateObject = calendar.create([ dateObject.year, dateObject.month, dateObject.date + interval ])\n        }\n\n    } //endif\n\n\n    // Return the date object settled on.\n    return dateObject\n} //DatePicker.prototype.validate\n\n\n/**\n * Check if a date is disabled.\n */\nDatePicker.prototype.disabled = function( dateToVerify ) {\n\n    var\n        calendar = this,\n\n        // Filter through the disabled dates to check if this is one.\n        isDisabledMatch = calendar.item.disable.filter( function( dateToDisable ) {\n\n            // If the date is a number, match the weekday with 0index and `firstDay` check.\n            if ( _.isInteger( dateToDisable ) ) {\n                return dateToVerify.day === ( calendar.settings.firstDay ? dateToDisable : dateToDisable - 1 ) % 7\n            }\n\n            // If it’s an array or a native JS date, create and match the exact date.\n            if ( $.isArray( dateToDisable ) || _.isDate( dateToDisable ) ) {\n                return dateToVerify.pick === calendar.create( dateToDisable ).pick\n            }\n\n            // If it’s an object, match a date within the “from” and “to” range.\n            if ( $.isPlainObject( dateToDisable ) ) {\n                return calendar.withinRange( dateToDisable, dateToVerify )\n            }\n        })\n\n    // If this date matches a disabled date, confirm it’s not inverted.\n    isDisabledMatch = isDisabledMatch.length && !isDisabledMatch.filter(function( dateToDisable ) {\n        return $.isArray( dateToDisable ) && dateToDisable[3] == 'inverted' ||\n            $.isPlainObject( dateToDisable ) && dateToDisable.inverted\n    }).length\n\n    // Check the calendar “enabled” flag and respectively flip the\n    // disabled state. Then also check if it’s beyond the min/max limits.\n    return calendar.item.enable === -1 ? !isDisabledMatch : isDisabledMatch ||\n        dateToVerify.pick < calendar.item.min.pick ||\n        dateToVerify.pick > calendar.item.max.pick\n\n} //DatePicker.prototype.disabled\n\n\n/**\n * Parse a string into a usable type.\n */\nDatePicker.prototype.parse = function( type, value, options ) {\n\n    var calendar = this,\n        parsingObject = {}\n\n    // If it’s already parsed, we’re good.\n    if ( !value || typeof value != 'string' ) {\n        return value\n    }\n\n    // We need a `.format` to parse the value with.\n    if ( !( options && options.format ) ) {\n        options = options || {}\n        options.format = calendar.settings.format\n    }\n\n    // Convert the format into an array and then map through it.\n    calendar.formats.toArray( options.format ).map( function( label ) {\n\n        var\n            // Grab the formatting label.\n            formattingLabel = calendar.formats[ label ],\n\n            // The format length is from the formatting label function or the\n            // label length without the escaping exclamation (!) mark.\n            formatLength = formattingLabel ? _.trigger( formattingLabel, calendar, [ value, parsingObject ] ) : label.replace( /^!/, '' ).length\n\n        // If there's a format label, split the value up to the format length.\n        // Then add it to the parsing object with appropriate label.\n        if ( formattingLabel ) {\n            parsingObject[ label ] = value.substr( 0, formatLength )\n        }\n\n        // Update the value as the substring from format length to end.\n        value = value.substr( formatLength )\n    })\n\n    // Compensate for month 0index.\n    return [\n        parsingObject.yyyy || parsingObject.yy,\n        +( parsingObject.mm || parsingObject.m ) - 1,\n        parsingObject.dd || parsingObject.d\n    ]\n} //DatePicker.prototype.parse\n\n\n/**\n * Various formats to display the object in.\n */\nDatePicker.prototype.formats = (function() {\n\n    // Return the length of the first word in a collection.\n    function getWordLengthFromCollection( string, collection, dateObject ) {\n\n        // Grab the first word from the string.\n        var word = string.match( /\\w+/ )[ 0 ]\n\n        // If there's no month index, add it to the date object\n        if ( !dateObject.mm && !dateObject.m ) {\n            dateObject.m = collection.indexOf( word ) + 1\n        }\n\n        // Return the length of the word.\n        return word.length\n    }\n\n    // Get the length of the first word in a string.\n    function getFirstWordLength( string ) {\n        return string.match( /\\w+/ )[ 0 ].length\n    }\n\n    return {\n\n        d: function( string, dateObject ) {\n\n            // If there's string, then get the digits length.\n            // Otherwise return the selected date.\n            return string ? _.digits( string ) : dateObject.date\n        },\n        dd: function( string, dateObject ) {\n\n            // If there's a string, then the length is always 2.\n            // Otherwise return the selected date with a leading zero.\n            return string ? 2 : _.lead( dateObject.date )\n        },\n        ddd: function( string, dateObject ) {\n\n            // If there's a string, then get the length of the first word.\n            // Otherwise return the short selected weekday.\n            return string ? getFirstWordLength( string ) : this.settings.weekdaysShort[ dateObject.day ]\n        },\n        dddd: function( string, dateObject ) {\n\n            // If there's a string, then get the length of the first word.\n            // Otherwise return the full selected weekday.\n            return string ? getFirstWordLength( string ) : this.settings.weekdaysFull[ dateObject.day ]\n        },\n        m: function( string, dateObject ) {\n\n            // If there's a string, then get the length of the digits\n            // Otherwise return the selected month with 0index compensation.\n            return string ? _.digits( string ) : dateObject.month + 1\n        },\n        mm: function( string, dateObject ) {\n\n            // If there's a string, then the length is always 2.\n            // Otherwise return the selected month with 0index and leading zero.\n            return string ? 2 : _.lead( dateObject.month + 1 )\n        },\n        mmm: function( string, dateObject ) {\n\n            var collection = this.settings.monthsShort\n\n            // If there's a string, get length of the relevant month from the short\n            // months collection. Otherwise return the selected month from that collection.\n            return string ? getWordLengthFromCollection( string, collection, dateObject ) : collection[ dateObject.month ]\n        },\n        mmmm: function( string, dateObject ) {\n\n            var collection = this.settings.monthsFull\n\n            // If there's a string, get length of the relevant month from the full\n            // months collection. Otherwise return the selected month from that collection.\n            return string ? getWordLengthFromCollection( string, collection, dateObject ) : collection[ dateObject.month ]\n        },\n        yy: function( string, dateObject ) {\n\n            // If there's a string, then the length is always 2.\n            // Otherwise return the selected year by slicing out the first 2 digits.\n            return string ? 2 : ( '' + dateObject.year ).slice( 2 )\n        },\n        yyyy: function( string, dateObject ) {\n\n            // If there's a string, then the length is always 4.\n            // Otherwise return the selected year.\n            return string ? 4 : dateObject.year\n        },\n\n        // Create an array by splitting the formatting string passed.\n        toArray: function( formatString ) { return formatString.split( /(d{1,4}|m{1,4}|y{4}|yy|!.)/g ) },\n\n        // Format an object into a string using the formatting options.\n        toString: function ( formatString, itemObject ) {\n            var calendar = this\n            return calendar.formats.toArray( formatString ).map( function( label ) {\n                return _.trigger( calendar.formats[ label ], calendar, [ 0, itemObject ] ) || label.replace( /^!/, '' )\n            }).join( '' )\n        }\n    }\n})() //DatePicker.prototype.formats\n\n\n\n\n/**\n * Check if two date units are the exact.\n */\nDatePicker.prototype.isDateExact = function( one, two ) {\n\n    var calendar = this\n\n    // When we’re working with weekdays, do a direct comparison.\n    if (\n        ( _.isInteger( one ) && _.isInteger( two ) ) ||\n        ( typeof one == 'boolean' && typeof two == 'boolean' )\n     ) {\n        return one === two\n    }\n\n    // When we’re working with date representations, compare the “pick” value.\n    if (\n        ( _.isDate( one ) || $.isArray( one ) ) &&\n        ( _.isDate( two ) || $.isArray( two ) )\n    ) {\n        return calendar.create( one ).pick === calendar.create( two ).pick\n    }\n\n    // When we’re working with range objects, compare the “from” and “to”.\n    if ( $.isPlainObject( one ) && $.isPlainObject( two ) ) {\n        return calendar.isDateExact( one.from, two.from ) && calendar.isDateExact( one.to, two.to )\n    }\n\n    return false\n}\n\n\n/**\n * Check if two date units overlap.\n */\nDatePicker.prototype.isDateOverlap = function( one, two ) {\n\n    var calendar = this,\n        firstDay = calendar.settings.firstDay ? 1 : 0\n\n    // When we’re working with a weekday index, compare the days.\n    if ( _.isInteger( one ) && ( _.isDate( two ) || $.isArray( two ) ) ) {\n        one = one % 7 + firstDay\n        return one === calendar.create( two ).day + 1\n    }\n    if ( _.isInteger( two ) && ( _.isDate( one ) || $.isArray( one ) ) ) {\n        two = two % 7 + firstDay\n        return two === calendar.create( one ).day + 1\n    }\n\n    // When we’re working with range objects, check if the ranges overlap.\n    if ( $.isPlainObject( one ) && $.isPlainObject( two ) ) {\n        return calendar.overlapRanges( one, two )\n    }\n\n    return false\n}\n\n\n/**\n * Flip the “enabled” state.\n */\nDatePicker.prototype.flipEnable = function(val) {\n    var itemObject = this.item\n    itemObject.enable = val || (itemObject.enable == -1 ? 1 : -1)\n}\n\n\n/**\n * Mark a collection of dates as “disabled”.\n */\nDatePicker.prototype.deactivate = function( type, datesToDisable ) {\n\n    var calendar = this,\n        disabledItems = calendar.item.disable.slice(0)\n\n\n    // If we’re flipping, that’s all we need to do.\n    if ( datesToDisable == 'flip' ) {\n        calendar.flipEnable()\n    }\n\n    else if ( datesToDisable === false ) {\n        calendar.flipEnable(1)\n        disabledItems = []\n    }\n\n    else if ( datesToDisable === true ) {\n        calendar.flipEnable(-1)\n        disabledItems = []\n    }\n\n    // Otherwise go through the dates to disable.\n    else {\n\n        datesToDisable.map(function( unitToDisable ) {\n\n            var matchFound\n\n            // When we have disabled items, check for matches.\n            // If something is matched, immediately break out.\n            for ( var index = 0; index < disabledItems.length; index += 1 ) {\n                if ( calendar.isDateExact( unitToDisable, disabledItems[index] ) ) {\n                    matchFound = true\n                    break\n                }\n            }\n\n            // If nothing was found, add the validated unit to the collection.\n            if ( !matchFound ) {\n                if (\n                    _.isInteger( unitToDisable ) ||\n                    _.isDate( unitToDisable ) ||\n                    $.isArray( unitToDisable ) ||\n                    ( $.isPlainObject( unitToDisable ) && unitToDisable.from && unitToDisable.to )\n                ) {\n                    disabledItems.push( unitToDisable )\n                }\n            }\n        })\n    }\n\n    // Return the updated collection.\n    return disabledItems\n} //DatePicker.prototype.deactivate\n\n\n/**\n * Mark a collection of dates as “enabled”.\n */\nDatePicker.prototype.activate = function( type, datesToEnable ) {\n\n    var calendar = this,\n        disabledItems = calendar.item.disable,\n        disabledItemsCount = disabledItems.length\n\n    // If we’re flipping, that’s all we need to do.\n    if ( datesToEnable == 'flip' ) {\n        calendar.flipEnable()\n    }\n\n    else if ( datesToEnable === true ) {\n        calendar.flipEnable(1)\n        disabledItems = []\n    }\n\n    else if ( datesToEnable === false ) {\n        calendar.flipEnable(-1)\n        disabledItems = []\n    }\n\n    // Otherwise go through the disabled dates.\n    else {\n\n        datesToEnable.map(function( unitToEnable ) {\n\n            var matchFound,\n                disabledUnit,\n                index,\n                isExactRange\n\n            // Go through the disabled items and try to find a match.\n            for ( index = 0; index < disabledItemsCount; index += 1 ) {\n\n                disabledUnit = disabledItems[index]\n\n                // When an exact match is found, remove it from the collection.\n                if ( calendar.isDateExact( disabledUnit, unitToEnable ) ) {\n                    matchFound = disabledItems[index] = null\n                    isExactRange = true\n                    break\n                }\n\n                // When an overlapped match is found, add the “inverted” state to it.\n                else if ( calendar.isDateOverlap( disabledUnit, unitToEnable ) ) {\n                    if ( $.isPlainObject( unitToEnable ) ) {\n                        unitToEnable.inverted = true\n                        matchFound = unitToEnable\n                    }\n                    else if ( $.isArray( unitToEnable ) ) {\n                        matchFound = unitToEnable\n                        if ( !matchFound[3] ) matchFound.push( 'inverted' )\n                    }\n                    else if ( _.isDate( unitToEnable ) ) {\n                        matchFound = [ unitToEnable.getUTCFullYear(), unitToEnable.getUTCMonth(), unitToEnable.getUTCDate(), 'inverted' ]\n                    }\n                    break\n                }\n            }\n\n            // If a match was found, remove a previous duplicate entry.\n            if ( matchFound ) for ( index = 0; index < disabledItemsCount; index += 1 ) {\n                if ( calendar.isDateExact( disabledItems[index], unitToEnable ) ) {\n                    disabledItems[index] = null\n                    break\n                }\n            }\n\n            // In the event that we’re dealing with an exact range of dates,\n            // make sure there are no “inverted” dates because of it.\n            if ( isExactRange ) for ( index = 0; index < disabledItemsCount; index += 1 ) {\n                if ( calendar.isDateOverlap( disabledItems[index], unitToEnable ) ) {\n                    disabledItems[index] = null\n                    break\n                }\n            }\n\n            // If something is still matched, add it into the collection.\n            if ( matchFound ) {\n                disabledItems.push( matchFound )\n            }\n        })\n    }\n\n    // Return the updated collection.\n    return disabledItems.filter(function( val ) { return val != null })\n} //DatePicker.prototype.activate\n\n\n/**\n * Create a string for the nodes in the picker.\n */\nDatePicker.prototype.nodes = function( isOpen ) {\n\n    var\n        calendar = this,\n        settings = calendar.settings,\n        calendarItem = calendar.item,\n        nowObject = calendarItem.now,\n        selectedObject = calendarItem.select,\n        highlightedObject = calendarItem.highlight,\n        viewsetObject = calendarItem.view,\n        disabledCollection = calendarItem.disable,\n        minLimitObject = calendarItem.min,\n        maxLimitObject = calendarItem.max,\n\n\n        // Create the calendar table head using a copy of weekday labels collection.\n        // * We do a copy so we don't mutate the original array.\n        tableHead = (function( collection, fullCollection ) {\n\n            // If the first day should be Monday, move Sunday to the end.\n            if ( settings.firstDay ) {\n                collection.push( collection.shift() )\n                fullCollection.push( fullCollection.shift() )\n            }\n\n            // Create and return the table head group.\n            return _.node(\n                'thead',\n                _.node(\n                    'tr',\n                    _.group({\n                        min: 0,\n                        max: DAYS_IN_WEEK - 1,\n                        i: 1,\n                        node: 'th',\n                        item: function( counter ) {\n                            return [\n                                collection[ counter ],\n                                settings.klass.weekdays,\n                                'scope=col title=\"' + fullCollection[ counter ] + '\"'\n                            ]\n                        }\n                    })\n                )\n            ) //endreturn\n        })( ( settings.showWeekdaysFull ? settings.weekdaysFull : settings.weekdaysShort ).slice( 0 ), settings.weekdaysFull.slice( 0 ) ), //tableHead\n\n\n        // Create the nav for next/prev month.\n        createMonthNav = function( next ) {\n\n            // Otherwise, return the created month tag.\n            return _.node(\n                'div',\n                ' ',\n                settings.klass[ 'nav' + ( next ? 'Next' : 'Prev' ) ] + (\n\n                    // If the focused month is outside the range, disabled the button.\n                    ( next && viewsetObject.year >= maxLimitObject.year && viewsetObject.month >= maxLimitObject.month ) ||\n                    ( !next && viewsetObject.year <= minLimitObject.year && viewsetObject.month <= minLimitObject.month ) ?\n                    ' ' + settings.klass.navDisabled : ''\n                ),\n                'data-nav=' + ( next || -1 ) + ' ' +\n                _.ariaAttr({\n                    role: 'button',\n                    controls: calendar.$node[0].id + '_table'\n                }) + ' ' +\n                'title=\"' + (next ? settings.labelMonthNext : settings.labelMonthPrev ) + '\"'\n            ) //endreturn\n        }, //createMonthNav\n\n\n        // Create the month label.\n        createMonthLabel = function() {\n\n            var monthsCollection = settings.showMonthsShort ? settings.monthsShort : settings.monthsFull\n\n            // If there are months to select, add a dropdown menu.\n            if ( settings.selectMonths ) {\n\n                return _.node( 'select',\n                    _.group({\n                        min: 0,\n                        max: 11,\n                        i: 1,\n                        node: 'option',\n                        item: function( loopedMonth ) {\n\n                            return [\n\n                                // The looped month and no classes.\n                                monthsCollection[ loopedMonth ], 0,\n\n                                // Set the value and selected index.\n                                'value=' + loopedMonth +\n                                ( viewsetObject.month == loopedMonth ? ' selected' : '' ) +\n                                (\n                                    (\n                                        ( viewsetObject.year == minLimitObject.year && loopedMonth < minLimitObject.month ) ||\n                                        ( viewsetObject.year == maxLimitObject.year && loopedMonth > maxLimitObject.month )\n                                    ) ?\n                                    ' disabled' : ''\n                                )\n                            ]\n                        }\n                    }),\n                    settings.klass.selectMonth,\n                    ( isOpen ? '' : 'disabled' ) + ' ' +\n                    _.ariaAttr({ controls: calendar.$node[0].id + '_table' }) + ' ' +\n                    'title=\"' + settings.labelMonthSelect + '\"'\n                )\n            }\n\n            // If there's a need for a month selector\n            return _.node( 'div', monthsCollection[ viewsetObject.month ], settings.klass.month )\n        }, //createMonthLabel\n\n\n        // Create the year label.\n        createYearLabel = function() {\n\n            var focusedYear = viewsetObject.year,\n\n            // If years selector is set to a literal \"true\", set it to 5. Otherwise\n            // divide in half to get half before and half after focused year.\n            numberYears = settings.selectYears === true ? 5 : ~~( settings.selectYears / 2 )\n\n            // If there are years to select, add a dropdown menu.\n            if ( numberYears ) {\n\n                var\n                    minYear = minLimitObject.year,\n                    maxYear = maxLimitObject.year,\n                    lowestYear = focusedYear - numberYears,\n                    highestYear = focusedYear + numberYears\n\n                // If the min year is greater than the lowest year, increase the highest year\n                // by the difference and set the lowest year to the min year.\n                if ( minYear > lowestYear ) {\n                    highestYear += minYear - lowestYear\n                    lowestYear = minYear\n                }\n\n                // If the max year is less than the highest year, decrease the lowest year\n                // by the lower of the two: available and needed years. Then set the\n                // highest year to the max year.\n                if ( maxYear < highestYear ) {\n\n                    var availableYears = lowestYear - minYear,\n                        neededYears = highestYear - maxYear\n\n                    lowestYear -= availableYears > neededYears ? neededYears : availableYears\n                    highestYear = maxYear\n                }\n\n                return _.node( 'select',\n                    _.group({\n                        min: lowestYear,\n                        max: highestYear,\n                        i: 1,\n                        node: 'option',\n                        item: function( loopedYear ) {\n                            return [\n\n                                // The looped year and no classes.\n                                loopedYear, 0,\n\n                                // Set the value and selected index.\n                                'value=' + loopedYear + ( focusedYear == loopedYear ? ' selected' : '' )\n                            ]\n                        }\n                    }),\n                    settings.klass.selectYear,\n                    ( isOpen ? '' : 'disabled' ) + ' ' + _.ariaAttr({ controls: calendar.$node[0].id + '_table' }) + ' ' +\n                    'title=\"' + settings.labelYearSelect + '\"'\n                )\n            }\n\n            // Otherwise just return the year focused\n            return _.node( 'div', focusedYear, settings.klass.year )\n        } //createYearLabel\n\n\n    // Create and return the entire calendar.\n    return _.node(\n        'div',\n        ( settings.selectYears ? createYearLabel() + createMonthLabel() : createMonthLabel() + createYearLabel() ) +\n        createMonthNav() + createMonthNav( 1 ),\n        settings.klass.header\n    ) + _.node(\n        'table',\n        tableHead +\n        _.node(\n            'tbody',\n            _.group({\n                min: 0,\n                max: WEEKS_IN_CALENDAR - 1,\n                i: 1,\n                node: 'tr',\n                item: function( rowCounter ) {\n\n                    // If Monday is the first day and the month starts on Sunday, shift the date back a week.\n                    var shiftDateBy = settings.firstDay && calendar.create([ viewsetObject.year, viewsetObject.month, 1 ]).day === 0 ? -7 : 0\n\n                    return [\n                        _.group({\n                            min: DAYS_IN_WEEK * rowCounter - viewsetObject.day + shiftDateBy + 1, // Add 1 for weekday 0index\n                            max: function() {\n                                return this.min + DAYS_IN_WEEK - 1\n                            },\n                            i: 1,\n                            node: 'td',\n                            item: function( targetDate ) {\n\n                                // Convert the time date from a relative date to a target date.\n                                targetDate = calendar.create([ viewsetObject.year, viewsetObject.month, targetDate + ( settings.firstDay ? 1 : 0 ) ])\n\n                                var isSelected = selectedObject && selectedObject.pick == targetDate.pick,\n                                    isHighlighted = highlightedObject && highlightedObject.pick == targetDate.pick,\n                                    isDisabled = disabledCollection && calendar.disabled( targetDate ) || targetDate.pick < minLimitObject.pick || targetDate.pick > maxLimitObject.pick\n\n                                return [\n                                    _.node(\n                                        'div',\n                                        targetDate.date,\n                                        (function( klasses ) {\n\n                                            // Add the `infocus` or `outfocus` classes based on month in view.\n                                            klasses.push( viewsetObject.month == targetDate.month ? settings.klass.infocus : settings.klass.outfocus )\n\n                                            // Add the `today` class if needed.\n                                            if ( nowObject.pick == targetDate.pick ) {\n                                                klasses.push( settings.klass.now )\n                                            }\n\n                                            // Add the `selected` class if something's selected and the time matches.\n                                            if ( isSelected ) {\n                                                klasses.push( settings.klass.selected )\n                                            }\n\n                                            // Add the `highlighted` class if something's highlighted and the time matches.\n                                            if ( isHighlighted ) {\n                                                klasses.push( settings.klass.highlighted )\n                                            }\n\n                                            // Add the `disabled` class if something's disabled and the object matches.\n                                            if ( isDisabled ) {\n                                                klasses.push( settings.klass.disabled )\n                                            }\n\n                                            return klasses.join( ' ' )\n                                        })([ settings.klass.day ]),\n                                        'data-pick=' + targetDate.pick + ' ' + _.ariaAttr({\n                                            role: 'gridcell',\n                                            selected: isSelected && calendar.$node.val() === _.trigger(\n                                                    calendar.formats.toString,\n                                                    calendar,\n                                                    [ settings.format, targetDate ]\n                                                ) ? true : null,\n                                            activedescendant: isHighlighted ? true : null,\n                                            disabled: isDisabled ? true : null\n                                        })\n                                    ),\n                                    '',\n                                    _.ariaAttr({ role: 'presentation' })\n                                ] //endreturn\n                            }\n                        })\n                    ] //endreturn\n                }\n            })\n        ),\n        settings.klass.table,\n        'id=\"' + calendar.$node[0].id + '_table' + '\" ' + _.ariaAttr({\n            role: 'grid',\n            controls: calendar.$node[0].id,\n            readonly: true\n        })\n    ) +\n\n    // * For Firefox forms to submit, make sure to set the buttons’ `type` attributes as “button”.\n    _.node(\n        'div',\n        _.node( 'button', settings.today, settings.klass.buttonToday,\n            'type=button data-pick=' + nowObject.pick +\n            ( isOpen && !calendar.disabled(nowObject) ? '' : ' disabled' ) + ' ' +\n            _.ariaAttr({ controls: calendar.$node[0].id }) ) +\n        _.node( 'button', settings.clear, settings.klass.buttonClear,\n            'type=button data-clear=1' +\n            ( isOpen ? '' : ' disabled' ) + ' ' +\n            _.ariaAttr({ controls: calendar.$node[0].id }) ) +\n        _.node('button', settings.close, settings.klass.buttonClose,\n            'type=button data-close=true ' +\n            ( isOpen ? '' : ' disabled' ) + ' ' +\n            _.ariaAttr({ controls: calendar.$node[0].id }) ),\n        settings.klass.footer\n    ) //endreturn\n} //DatePicker.prototype.nodes\n\n\n\n\n/**\n * The date picker defaults.\n */\nDatePicker.defaults = (function( prefix ) {\n\n    return {\n\n        // The title label to use for the month nav buttons\n        labelMonthNext: 'Next month',\n        labelMonthPrev: 'Previous month',\n\n        // The title label to use for the dropdown selectors\n        labelMonthSelect: 'Select a month',\n        labelYearSelect: 'Select a year',\n\n        // Months and weekdays\n        monthsFull: [ 'January', 'February', 'March', 'April', 'May', 'June', 'July', 'August', 'September', 'October', 'November', 'December' ],\n        monthsShort: [ 'Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun', 'Jul', 'Aug', 'Sep', 'Oct', 'Nov', 'Dec' ],\n        weekdaysFull: [ 'Sunday', 'Monday', 'Tuesday', 'Wednesday', 'Thursday', 'Friday', 'Saturday' ],\n        weekdaysShort: [ 'Sun', 'Mon', 'Tue', 'Wed', 'Thu', 'Fri', 'Sat' ],\n\n        // Today and clear\n        today: 'Today',\n        clear: 'Clear',\n        close: 'Close',\n\n        // The format to show on the `input` element\n        format: 'd mmmm, yyyy',\n\n        // Classes\n        klass: {\n\n            table: prefix + 'table',\n\n            header: prefix + 'header',\n\n            navPrev: prefix + 'nav--prev',\n            navNext: prefix + 'nav--next',\n            navDisabled: prefix + 'nav--disabled',\n\n            month: prefix + 'month',\n            year: prefix + 'year',\n\n            selectMonth: prefix + 'select--month',\n            selectYear: prefix + 'select--year',\n\n            weekdays: prefix + 'weekday',\n\n            day: prefix + 'day',\n            disabled: prefix + 'day--disabled',\n            selected: prefix + 'day--selected',\n            highlighted: prefix + 'day--highlighted',\n            now: prefix + 'day--today',\n            infocus: prefix + 'day--infocus',\n            outfocus: prefix + 'day--outfocus',\n\n            footer: prefix + 'footer',\n\n            buttonClear: prefix + 'button--clear',\n            buttonToday: prefix + 'button--today',\n            buttonClose: prefix + 'button--close'\n        }\n    }\n})( Picker.klasses().picker + '__' )\n\n\n\n\n\n/**\n * Extend the picker to add the date picker.\n */\nPicker.extend( 'pickadate', DatePicker )\n\n\n}));\n","import React from 'react';\nimport _ from 'lodash';\nimport moment from 'moment';\nimport Datepicker from './datepicker.js';\nimport Timepicker from './timepicker.js';\n\nimport ExplorerUtils from '../../utils/ExplorerUtils';\nimport ExplorerActions from '../../actions/ExplorerActions';\n\nconst dateFormat = 'll';\nconst timeFormat = 'h:mm A';\n\nconst AbsolutePicker = React.createClass({\n\n  setDate: function(name, value) {\n    var time = this.props.time;\n    var endValue = new Date(time.end);\n\n    var updates = _.cloneDeep(time);\n    if (name === 'start_date' && value > endValue) {\n      updates.end = '';\n    }\n    updates[name] = new Date(moment(new Date(value)).format(dateFormat) + \" \" + moment(time[name]).format(timeFormat));\n    this.props.handleChange('time', updates);\n  },\n\n  handleDateBlur: function (event) {\n    var name = event.target.name;\n    var value = event.target.value;\n    this.setDate(name, value);\n  },\n\n  setTime: function(name, value) {\n    var time = this.props.time;\n    var updates = _.cloneDeep(time);\n    updates[name] = new Date(moment(time[name]).format(dateFormat) + \" \" + moment(new Date(value)).format(timeFormat));\n    this.props.handleChange('time', updates);\n  },\n\n  // React methods\n\n  render: function() {\n    var time = this.props.time;\n\n    return (\n      <div className=\"absolute-timeframe-picker\">\n        <div className=\"row\">\n          <div className=\"col-xs-2\">\n            <label>Start</label>\n          </div>\n          <div className=\"col-xs-5 form-collapse-right\">\n            <Datepicker ref=\"start-date\"\n                        value={moment(time.start).format(dateFormat)}\n                        name=\"start\"\n                        placeholder=\"Date\"\n                        onBlur={this.handleDateBlur}\n                        onSet={this.setDate} />\n          </div>\n          <div className=\"col-xs-5 form-collapse-left\">\n            <Timepicker ref=\"start-time\"\n                        value={moment(time.start).format(timeFormat)}\n                        name=\"start\"\n                        placeholder=\"Time\"\n                        handleBlur={this.setTime}\n                        handleSelection={this.setTime} />\n          </div>\n        </div>\n        <div className=\"row\">\n          <div className=\"col-xs-2\">\n            <label>End</label>\n          </div>\n          <div className=\"col-xs-5 form-collapse-right\">\n            <Datepicker ref=\"end-date\"\n                        value={moment(time.end).format(dateFormat)}\n                        minimum={moment(time.start).format(dateFormat)}\n                        name=\"end\"\n                        placeholder=\"Date\"\n                        onBlur={this.handleDateBlur}\n                        onSet={this.setDate} />\n          </div>\n          <div className=\"col-xs-5 form-collapse-left\">\n            <Timepicker ref=\"end-time\"\n                        value={moment(time.end).format(timeFormat)}\n                        name=\"end\"\n                        placeholder=\"Time\"\n                        handleBlur={this.setTime}\n                        handleSelection={this.setTime} />\n          </div>\n        </div>\n      </div>\n    );\n  }\n\n});\n\nexport default AbsolutePicker;\n","import React from 'react';\nimport _ from 'lodash';\nimport SelectField from '../select_field.js';\nimport Timeframe from '../../../common/timeframe.js';\nimport FieldsToggle from '../../../common/fields_toggle.js';\nimport Notice from '../../../common/notice.js';\nimport FilterManager from '../../../common/filter_manager.js';\nimport FilterUtils from '../../../../utils/FilterUtils.js';\nimport classNames from 'classnames';\n\nconst FunnelStep = React.createClass({\n\n  propTypes: {\n    index:                React.PropTypes.number.isRequired,\n    step:                 React.PropTypes.object.isRequired,\n    eventCollections:     React.PropTypes.array.isRequired,\n    propertyNames:        React.PropTypes.array.isRequired,\n    onBrowseEvents:       React.PropTypes.func.isRequired,\n    getPropertyType:      React.PropTypes.func.isRequired,\n    moveStep:             React.PropTypes.func.isRequired,\n    removeStep:           React.PropTypes.func.isRequired,\n    handleChange:         React.PropTypes.func.isRequired,\n    toggleStepActive:     React.PropTypes.func.isRequired,\n    handleFilterChange:   React.PropTypes.func.isRequired,\n    handleAddFilter:      React.PropTypes.func.isRequired,\n    handleRemoveFilter:   React.PropTypes.func.isRequired\n  },\n\n  removeStep: function(e) {\n    e.preventDefault();\n    if (this.props.canRemove && confirm(\"Are you sure you want to delete this funnel step?\")) {\n      this.props.removeStep(this.props.index);\n    }\n  },\n\n  handleChange: function(name, value) {\n    this.props.handleChange(this.props.index, name, value);\n  },\n\n  handleChangeWithEvent: function(e) {\n    e.preventDefault();\n    this.props.handleChange(this.props.index, e.target.name, e.target.value);\n  },\n\n  handleCheckboxChange: function(e) {\n    this.props.handleChange(this.props.index, e.target.name, e.target.checked);\n  },\n\n  toggleStepActive: function(e) {\n    this.props.toggleStepActive(this.props.index, !this.props.step.active);\n  },\n\n  handleFiltersToggle: function() {\n    this.refs['filter-manager'].open();\n  },\n\n  handleAddFilter: function() {\n    this.props.handleAddFilter(this.props.index);\n  },\n\n  handleRemoveFilter: function(filterIndex) {\n    this.props.handleRemoveFilter(this.props.index, filterIndex);\n  },\n\n  handleFilterChange: function(filterIndex, updates) {\n    this.props.handleFilterChange(this.props.index, filterIndex, updates);\n  },\n\n  moveStepUp: function(e) {\n    e.preventDefault();\n    e.stopPropagation();\n    this.props.moveStep(this.props.index, 'up');\n  },\n\n  moveStepDown: function(e) {\n    e.preventDefault();\n    e.stopPropagation();\n    this.props.moveStep(this.props.index, 'down');\n  },\n\n  buildStepBody: function() {\n    var remove, notice;\n\n    if (this.props.canRemove) {\n      remove = (\n        <a href=\"#\" className=\"remove-step\" onClick={this.removeStep}>\n          <i className=\"icon glyphicon glyphicon-remove-circle margin-right-tiny\"></i>\n          Remove Step\n        </a>\n      );\n    }\n    if (this.props.notice) {\n      notice = (<Notice notice={this.props.notice} closable={false} />);\n    }\n\n    if (this.props.step.active === true) {\n      return (\n        <div className=\"step-body margin-top-small margin-bottom-small\">\n          {notice}\n          <SelectField name=\"event_collection\"\n                       label=\"Event Collection\"\n                       value={this.props.step.event_collection}\n                       options={this.props.eventCollections}\n                       requiredLabel={true}\n                       onBrowseEvents={this.props.onBrowseEvents}\n                       handleChange={this.handleChange} />\n          <SelectField name=\"actor_property\"\n                       label=\"Actor Property\"\n                       value={this.props.step.actor_property}\n                       options={this.props.propertyNames}\n                       requiredLabel={true}\n                       handleChange={this.handleChange} />\n          <Timeframe ref=\"timeframe\"\n                     time={this.props.step.time}\n                     timezone={this.props.step.timezone}\n                     handleChange={this.handleChange}/>\n          <div className=\"field-component\">\n            <FieldsToggle ref=\"filters-fields-toggle\"\n                          name=\"Filters\"\n                          toggleCallback={this.handleFiltersToggle}\n                          fieldsCount={FilterUtils.validFilters(this.props.step.filters).length} />\n          </div>\n          <FilterManager ref=\"filter-manager\"\n                         eventCollection={this.props.step.event_collection}\n                         filters={this.props.step.filters}\n                         handleChange={this.handleFilterChange}\n                         removeFilter={this.handleRemoveFilter}\n                         addFilter={this.handleAddFilter}\n                         getPropertyType={this.props.getPropertyType}\n                         propertyNames={this.props.propertyNames} />\n          <label className=\"block-label margin-top-small\">\n            <input name=\"optional\" type=\"checkbox\" checked={this.props.step.optional} onChange={this.handleCheckboxChange} /> Optional Step\n          </label>\n          <label className=\"block-label\">\n            <input name=\"inverted\" type=\"checkbox\" checked={this.props.step.inverted} onChange={this.handleCheckboxChange} /> Inverted Step\n          </label>\n          <label className=\"block-label\">\n            <input name=\"with_actors\" type=\"checkbox\" checked={this.props.step.with_actors} onChange={this.handleCheckboxChange} /> With Actors\n          </label>\n\n          <hr />\n          {remove}\n        </div>\n      );\n    }\n  },\n\n  render: function() {\n    var stepWrapperClasses = classNames({\n      'funnel-step': true,\n      'active': this.props.step.active\n    });\n    return (\n      <div className={stepWrapperClasses}>\n        <div className=\"step-header clearfix\" onClick={this.toggleStepActive} role=\"step-header\">\n          <div className=\"step-move-btns\">\n            <a href=\"#\" className=\"up\" onClick={this.moveStepUp} role=\"move-step\">\n              <span className=\"arrow\"></span>\n            </a>\n            <a href=\"#\" className=\"down\" onClick={this.moveStepDown} role=\"move-step\">\n              <span className=\"arrow\"></span>\n            </a>\n          </div>\n          <div className=\"step-number\">\n            {this.props.index + 1}\n          </div>\n          <div className=\"step-name\">\n            Step {this.props.index + 1}\n          </div>\n        </div>\n        {this.buildStepBody()}\n      </div>\n    );\n  }\n\n});\n\nexport default FunnelStep;\n","import React from 'react';\nimport _ from 'lodash';\nimport FunnelStep from './funnel_step.js';\nimport ExplorerActions from '../../../../actions/ExplorerActions.js';\n\nconst FunnelsBuilder = React.createClass({\n\n  propTypes: {\n    modelId:               React.PropTypes.string.isRequired,\n    eventCollections:      React.PropTypes.array.isRequired,\n    steps:                 React.PropTypes.array.isRequired,\n    stepNotices:           React.PropTypes.array.isRequired,\n    onBrowseEvents:        React.PropTypes.func.isRequired,\n    getEventPropertyNames: React.PropTypes.func.isRequired,\n    getPropertyType:       React.PropTypes.func.isRequired\n  },\n\n  handleChange: function(index, name, value) {\n    var updates = {}\n    updates[name] = value;\n    ExplorerActions.updateStep(this.props.modelId, index, updates);\n  },\n\n  addStep: function(e) {\n    e.preventDefault();\n    ExplorerActions.addStep(this.props.modelId);\n  },\n\n  removeStep: function(index) {\n    ExplorerActions.removeStep(this.props.modelId, index);\n  },\n\n  handleAddFilter: function(index) {\n    ExplorerActions.addStepFilter(this.props.modelId, index);\n  },\n\n  handleRemoveFilter: function(stepIndex, filterIndex) {\n    ExplorerActions.removeStepFilter(this.props.modelId, stepIndex, filterIndex);\n  },\n\n  handleFilterChange: function(stepIndex, filterIndex, updates) {\n    ExplorerActions.updateStepFilter(this.props.modelId, stepIndex, filterIndex, updates);\n  },\n\n  toggleStepActive: function(index, active) {\n    if (active) {\n      ExplorerActions.setStepActive(this.props.modelId, index);\n    } else {\n      ExplorerActions.updateStep(this.props.modelId, index, { active: false });\n    }\n  },\n\n  moveStep: function(index, direction) {\n    ExplorerActions.moveStep(this.props.modelId, index, direction);\n  },\n\n  buildSteps: function() {\n    return this.props.steps.map(function(step, index) {\n      var notice = _.find(this.props.stepNotices, { stepIndex: index });\n      return (\n        <li key={index}>\n          <FunnelStep index={index}\n                      step={step}\n                      notice={notice}\n                      removeStep={this.removeStep}\n                      canRemove={this.props.steps.length > 1}\n                      eventCollections={this.props.eventCollections}\n                      propertyNames={this.props.getEventPropertyNames(step.event_collection)}\n                      onBrowseEvents={this.props.onBrowseEvents}\n                      toggleStepActive={this.toggleStepActive}\n                      handleChange={this.handleChange}\n                      handleAddFilter={this.handleAddFilter}\n                      handleRemoveFilter={this.handleRemoveFilter}\n                      handleFilterChange={this.handleFilterChange}\n                      getPropertyType={this.props.getPropertyType}\n                      handleFiltersToggle={this.handleFiltersToggle}\n                      moveStep={this.moveStep} />\n        </li>\n      );\n    }.bind(this));\n  },\n\n  render: function() {\n    return (\n      <div className=\"funnel-builder margin-top-small\">\n        <h4>Steps</h4>\n        <ul className=\"steps\">\n          {this.buildSteps()}\n        </ul>\n        <a href=\"#\" className=\"add-step\" onClick={this.addStep}>\n          <i className=\"icon glyphicon glyphicon-plus-sign margin-right-tiny\"></i>\n          Add a step\n        </a>\n      </div>\n    );\n  }\n\n});\n\nexport default FunnelsBuilder;\n","import React from 'react';\nimport Input from '../../common/input.js';\nimport ExplorerUtils from '../../../utils/ExplorerUtils';\n\nconst LatestField = React.createClass({\n\n  render: function() {\n    return (\n      <div className=\"form-group\">\n        <Input type=\"text\"\n               name=\"latest\"\n               label=\"Limit number of events to extract\"\n               value={this.props.latest}\n               placeholder=\"Eg: 1000\"\n               onChange={this.props.handleChange} />\n        <small className=\"text-muted\">\n          <span className=\"icon glyphicon glyphicon-info-sign\"></span>\n          <span>{'Results are limited to 10 million events'}</span>\n        </small>\n      </div>\n    );\n  }\n\n});\n\nexport default LatestField;\n","import React from 'react';\n\nclass ReactMultiSelect extends React.Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      open: false,\n      id: 'react-multi-select',\n      focusedIndex: 0\n    }\n  }\n\n  interceptEvent(event) {\n    if (event) {\n      event.preventDefault();\n      event.stopPropagation();\n    }\n  }\n\n  // Private Event Handler Methods\n  _toggleOpenClose(event) {\n    this.interceptEvent(event);\n\n    if(this.state.open) {\n      return this.setState({ open: false });\n    }\n    else {\n      this.setState({ open: true })\n    }\n  }\n\n  _isSelected(itemVal) {\n    return this.props.items.filter((item) => {\n      if (item.value === itemVal && item.selected) return true;\n      return false;\n    }).length > 0;\n  }\n\n  _handleOptionChange(event) {\n    this.interceptEvent(event);\n    this.props.handleChange(this.props.name, event.target.text, !this._isSelected(event.target.text));\n  }\n\n  _renderOption(option, i) {\n    let className = 'react-select-box-option';\n    if (i === this.state.focusedIndex) {\n      className += ' react-select-box-option-focused'\n    }\n    if (option.selected) {\n      className += ' react-select-box-option-selected'\n    }\n\n    return (<a\n      id={`${this.state.id}-${i}`}\n      className={className}\n      href='#'\n      onClick={this._handleOptionChange.bind(this)}\n      title={option.label}\n      key={`${i}_${option.label}`}\n    >{option.label}</a>\n    )\n  }\n\n  // Private HTML Element methods\n  _renderOptionMenu() {\n    let className = 'react-select-box-options';\n    if (!this.state.open) {\n      className += ' react-select-box-hidden';\n    }\n\n    const options = this.props.items.map((item, i) => {\n      return this._renderOption({ value: item.value, selected: item.selected, label: item.value }, i);\n    });\n\n    return (<div className={className} ref='menu'>\n      {options}\n    </div>)\n  }\n\n  render() {\n    const selectedItems = this.props.items.filter(i => i.selected);\n    const label = selectedItems.length > 0 ? selectedItems.map(i => i.value).join(', ') : this.props.label;\n\n    return (<div className='react-select-box-container react-select-box-multi'>\n      <button id={this.state.id} onClick={this._toggleOpenClose.bind(this)} className='react-select-box'>\n        <div className='react-select-box-label'>{label}</div>\n      </button>\n\n      {this._renderOptionMenu()}\n    </div>);\n  }\n}\n\nexport default ReactMultiSelect;\n","import React from 'react';\nimport ExplorerUtils from '../../../utils/ExplorerUtils';\nimport Input from '../../common/input.js';\nimport ReactMultiSelect from '../../common/react_multi_select.js';\nimport LatestField from './latest_field.js';\n\nclass ExtractionOptions extends React.Component {\n\n  _getExtractionKeys() {\n    if (typeof this.props.projectSchema === \"undefined\") {\n      return false;\n    }\n\n    const schema = this.props.projectSchema[this.props.event_collection];\n    if (typeof schema === \"undefined\") {\n      return false;\n    }\n\n    if (!schema.sortedProperties || !schema.sortedProperties.length) {\n      return false;\n    }\n\n    return schema.sortedProperties.map((property) => {\n      return {\n        value: property,\n        selected: this.props.property_names.indexOf(property) > -1\n      }\n    });\n  }\n\n  _handlePropertyNamesChange(name, propertyName, shouldBeSelected) {\n    let newPropertyNames = this.props.property_names.slice(0);\n    if (shouldBeSelected) {\n      newPropertyNames.push(propertyName);\n    } else {\n      newPropertyNames = newPropertyNames.filter((name) => {\n        return name !== propertyName;\n      });\n    }\n    this.props.handleChange(name, newPropertyNames);\n  }\n\n  render(){\n    let emailField;\n    let latestField;\n    let extractionPropertiesFilter;\n\n    if (this.props.isEmail) {\n      emailField = (\n        <Input type=\"text\"\n               name=\"email\"\n               label=\"Recipient email address\"\n               placeholder=\"your@email.com\"\n               required=\"true\"\n               value={this.props.email}\n               onChange={this.props.handleChangeWithEvent} />\n      );\n      latestField = (\n        <LatestField latest={this.props.latest} handleChange={this.props.handleChangeWithEvent} />\n      );\n    }\n\n    if (this._getExtractionKeys()) {\n      extractionPropertiesFilter = <ReactMultiSelect\n            name=\"property_names\"\n            label=\"Filter extraction properties\"\n            handleChange={this._handlePropertyNamesChange.bind(this)}\n            items={this._getExtractionKeys()}\n      />\n    }\n\n    return (\n      <div className=\"field-component\">\n        <div className=\"extraction-options\">\n          <label>\n            <input type=\"radio\" name=\"extraction_type\" value=\"immediate\" onChange={this.props.setExtractionType} checked={!this.props.isEmail}/> Preview latest {ExplorerUtils.EXRACTION_EVENT_LIMIT} events now\n          </label>\n          <label>\n            <input type=\"radio\" name=\"extraction_type\" value=\"email\" onChange={this.props.setExtractionType} checked={this.props.isEmail}/> Bulk CSV extraction by email\n          </label>\n\n          {emailField}\n          {latestField}\n          {extractionPropertiesFilter}\n        </div>\n      </div>\n    );\n  }\n}\n\nexport default ExtractionOptions;\n","import React from 'react';\nimport _ from 'lodash';\nimport FieldsToggle from '../../common/fields_toggle.js';\n\n// Components\nimport ReactSelect from '../../common/react_select.js';\n\nclass GroupByField extends React.Component {\n\n  focusOnReactSelect(toggled) {\n    if (toggled && !this.props.value) {\n      var self = this;\n      setTimeout(function(){\n        self.refs.select.refs.input.focus();\n      }, 100);\n    }\n  }\n\n  multiGroupToggle() {\n    var icon = this.props.value.length > 1 ? 'remove' : 'plus';\n    var text = this.props.value.length > 1 ? 'Remove second property' : 'Group by a second property';\n    return (\n      <a className=\"margin-top-tiny double-groupby-toggle\" href=\"#\" onClick={(e) => this.toggleMultiGroupBy(e)}>\n        <i className={\"margin-right-bump icon glyphicon glyphicon-\"+icon}></i>\n        {text}\n      </a>\n    );\n  }\n\n  secondField() {\n    if (this.props.value.length > 1) {\n      return (\n        <div>\n          <label className=\"margin-top-tiny\">Second Target Property</label>\n          <ReactSelect ref=\"select\"\n                     inputClasses=\"group-by form-control margin-bottom-tiny\"\n                     wrapClasses=\"\"\n                     name=\"group_by.1\"\n                     items={this.props.options}\n                     handleChange={(e,v) => this.handleChange(e,v)}\n                     value={this.props.value[1] || ''}\n                     sort={true} />\n        </div>\n      )\n    }\n  }\n\n  getGroupBy() {\n    return this.props.value;\n  }\n\n  handleChange(name, value) {\n    var newVal = this.props.value.slice();\n    newVal[name.split('.')[1]] = value;\n    this.props.handleChange('group_by', newVal);\n  }\n\n  handleChangeOrder(name, value) {\n    this.props.handleChange('order_by', {\n      property_name: 'result',\n      direction: value\n    });\n  }\n\n  handleChangeLimit(value) {\n    this.props.handleChange('limit', value);\n  }\n\n  handleChangeOrderReset() {\n    this.props.handleChange('order_by', null);\n    this.handleChangeLimit(null);\n  }\n\n  toggleMultiGroupBy(event) {\n    event.preventDefault();\n    var newVal;\n    switch (this.props.value.length) {\n      case 0:\n        newVal = ['', ''];\n        break;\n      case 1:\n        newVal = this.props.value.concat(['']);\n        break;\n      case 2:\n        newVal = this.props.value.slice(0,1);\n        break;\n    }\n    this.props.handleChange('group_by', newVal);\n  }\n\n  shouldBeOpen() {\n    return this.props.value && this.props.value[0]\n  }\n\n  // React methods\n\n  render() {\n    return (\n      <div className=\"field-component\">\n        <FieldsToggle ref=\"toggle\"\n                      name=\"Group by - Order by\"\n                      initialOpenState={this.shouldBeOpen()}\n                      updateFn={(e) =>this.props.updateGroupBy(e)}\n                      getFn={() => this.getGroupBy()}\n                      attrsToStore=\"group_by\"\n                      handleReset={() => this.handleChangeOrderReset()}\n                      resetValues={{\n                        group_by: [],\n                        order_by: null,\n                        limit: null\n                      }}\n                      toggleCallback={(toggle) => this.focusOnReactSelect(toggle)}>\n                      <label>Target property</label>\n          <ReactSelect ref=\"select\"\n                       inputClasses=\"group-by form-control margin-bottom-tiny\"\n                       name=\"group_by.0\"\n                       items={this.props.options}\n                       handleChange={(e, v) => this.handleChange(e, v)}\n                       value={this.props.value[0] || ''}\n                       sort={true} />\n                       <label>Order</label>\n                       <ReactSelect ref=\"select\"\n                                    inputClasses=\"group-by form-control margin-bottom-tiny\"\n                                    name=\"order_by\"\n                                    items={['ASC', 'DESC']}\n                                    handleChange={(e, v) => this.handleChangeOrder(e, v)}\n                                    value={ (this.props.valueOrderBy && this.props.valueOrderBy.direction) || 'ASC'}\n                                    sort={true} />\n                      <label>Limit</label>\n                      <input type=\"number\"\n                             name=\"limit\"\n                             className=\"form-control property-value margin-bottom-tiny\"\n                             value={this.props.valueLimit || '10'}\n                             onChange={(e) => {\n                               this.handleChangeLimit(parseInt(e.target.value));\n                             }}\n                             autoComplete=\"off\" />\n          {this.secondField()}\n          {this.multiGroupToggle()}\n        </FieldsToggle>\n      </div>\n    );\n  }\n\n};\n\nexport default GroupByField;\n","import React from 'react';\nimport _ from 'lodash';\n\n// Components\nimport Input from '../../common/input.js';\n\nconst PercentileField = React.createClass({\n\n  // React methods\n\n  render: function() {\n    return (\n      <div className=\"field-component\">\n        <Input ref=\"input\"\n               label=\"Percentile Value\"\n               classes=\"percentile\"\n               name=\"percentile\"\n               required=\"true\"\n               placeholder=\"Ex: 50\"\n               onChange={this.props.onChange}\n               value={this.props.value || \"\"} />\n      </div>\n    );\n  }\n\n});\n\nexport default PercentileField;\n","import _ from 'lodash';\nimport React from 'react';\n\n// Components\nimport FieldsToggle from '../../common/fields_toggle.js';\nimport SelectField from './select_field.js';\nimport PercentileField from './percentile_field.js';\nimport GroupByField from './group_by_field.js';\nimport ExtractionOptions from './extraction_options.js';\nimport FunnelBuilder from './funnels/funnel_builder.js';\nimport Timeframe from '../../common/timeframe.js';\nimport Interval from '../../common/interval.js';\nimport Input from '../../common/input.js';\nimport ApiUrl from './api_url.js';\nimport ExplorerStore from '../../../stores/ExplorerStore';\nimport ExplorerUtils from '../../../utils/ExplorerUtils';\nimport FilterUtils from '../../../utils/FilterUtils';\nimport ExplorerActions from '../../../actions/ExplorerActions';\n\nconst QueryBuilder = React.createClass({\n\n  // Event callbacks\n\n  handleSelectionWithEvent: function(event) {\n    this.handleChange(event.target.name, event.target.value);\n  },\n\n  handleChange: function(update, value) {\n    var updates = { query: {} };\n\n    if(_.isPlainObject(update)) {\n      for(key in update) {\n        updates.query[key] = update[key];\n      }\n    } else {\n      updates.query[update] = value;\n    }\n\n    ExplorerActions.update(this.props.model.id, updates);\n  },\n\n  // Convenience Methods\n\n  updateGroupBy: function(updates) {\n    ExplorerActions.update(this.props.model.id, { query: updates });\n  },\n\n  handleRevertChanges: function(event) {\n    event.preventDefault();\n    ExplorerActions.revertActiveChanges();\n  },\n\n  shouldShowRevertButton: function() {\n    return ExplorerUtils.isPersisted(this.props.model) && this.props.model.originalModel && this.props.model.originalModel.query && !_.isEqual(this.props.model.query, this.props.model.originalModel.query);\n  },\n\n  // Fields Builders\n\n  buildEventCollectionField: function() {\n    if (this.props.model.query.analysis_type !== 'funnel') {\n      return (\n        <SelectField name=\"event_collection\"\n                     label=\"Event Collection\"\n                     value={this.props.model.query.event_collection}\n                     requiredLabel={true}\n                     onBrowseEvents={this.props.onBrowseEvents}\n                     handleChange={this.handleChange}\n                     options={this.props.project.eventCollections} />\n      );\n    }\n  },\n\n  buildExtractionOptions: function() {\n    if (this.props.model.query.analysis_type === 'extraction') {\n      return (\n        <ExtractionOptions latest={this.props.model.query.latest}\n                           email={this.props.model.query.email}\n                           property_names={this.props.model.query.property_names}\n                           event_collection={this.props.model.query.event_collection}\n                           projectSchema={this.props.project.schema}\n                           isEmail={ExplorerUtils.isEmailExtraction(this.props.model)}\n                           handleChangeWithEvent={this.handleSelectionWithEvent}\n                           handleChange={this.handleChange}\n                           setExtractionType={this.props.setExtractionType} />\n      );\n    }\n  },\n\n  buildGroupByField: function() {\n    if (['extraction', 'funnel'].indexOf(this.props.model.query.analysis_type) === -1) {\n      return (\n        <GroupByField ref=\"group-by-field\"\n                      value={this.props.model.query.group_by}\n                      valueOrderBy={this.props.model.query.order_by}\n                      valueLimit={this.props.model.query.limit}\n                      updateGroupBy={this.updateGroupBy}\n                      options={this.props.getEventPropertyNames(this.props.model.query.event_collection)}\n                      handleChange={this.handleChange} />\n      );\n    }\n  },\n\n  buildTargetPropertyField: function() {\n    var type = this.props.model.query.analysis_type;\n    if (type !== null && ExplorerUtils.shouldHaveTarget(this.props.model)) {\n      return (\n        <SelectField name=\"target_property\"\n                     label=\"Target Property\"\n                     inputClasses={['target-property']}\n                     requiredLabel={true}\n                     handleChange={this.handleChange}\n                     options={this.props.getEventPropertyNames(this.props.model.query.event_collection)}\n                     value={this.props.model.query.target_property}\n                     sort={true} />\n      );\n    }\n  },\n\n  buildPercentileField: function() {\n    if (this.props.model.query.analysis_type === 'percentile') {\n      return (\n        <PercentileField ref=\"percentile-field\"\n                         value={this.props.model.query.percentile}\n                         onChange={this.handleSelectionWithEvent} />\n      );\n    }\n  },\n\n  buildIntervalField: function() {\n    if (['extraction', 'funnel'].indexOf(this.props.model.query.analysis_type) === -1) {\n      return (\n        <Interval interval={this.props.model.query.interval}\n                  handleChange={this.handleChange} />\n      );\n    }\n  },\n\n  buildFilters: function() {\n    if (this.props.model.query.analysis_type !== 'funnel') {\n      return (\n        <div className=\"field-component\">\n          <FieldsToggle ref=\"filters-fields-toggle\"\n                        name=\"Filters\"\n                        toggleCallback={this.props.handleFiltersToggle}\n                        fieldsCount={FilterUtils.validFilters(this.props.model.query.filters).length} />\n        </div>\n      );\n    }\n  },\n\n  buildGlobalTimeframePicker: function() {\n    if (this.props.model.query.analysis_type !== 'funnel') {\n      return (\n        <div>\n          <Timeframe ref=\"timeframe\"\n                     time={this.props.model.query.time}\n                     timezone={this.props.model.query.timezone}\n                     handleChange={this.handleChange}/>\n          <hr className=\"fieldset-divider\" />\n        </div>\n      );\n    }\n  },\n\n  buildFunnelBuilder: function() {\n    if (this.props.model.query.analysis_type === 'funnel') {\n      return <FunnelBuilder modelId={this.props.model.id}\n                            steps={this.props.model.query.steps}\n                            stepNotices={this.props.stepNotices || []}\n                            onBrowseEvents={this.props.onBrowseEvents}\n                            eventCollections={this.props.project.eventCollections}\n                            getEventPropertyNames={this.props.getEventPropertyNames}\n                            getPropertyType={this.props.getPropertyType} />;\n    }\n  },\n\n  buildClearButton: function() {\n    if (!this.shouldShowRevertButton()) {\n      return (\n        <button type=\"reset\" role=\"clear-query\"\n          className=\"btn btn-default btn-block\"\n          id=\"clear-explorer-query\"\n          onClick={this.props.handleClearQuery}>\n            Clear\n        </button>\n      );\n    } else {\n      return (\n        <button\n          className=\"btn btn-default btn-block\"\n          onClick={this.handleRevertChanges}\n          role=\"revert-query\">\n            Revert to original\n        </button>\n      );\n    }\n  },\n\n  // React methods\n\n  render: function() {\n    var apiQueryUrl;\n    if (this.props.model.isValid) {\n      apiQueryUrl = ExplorerUtils.getApiQueryUrl(this.props.client, this.props.model);\n    }\n\n    return (\n      <section className=\"query-pane-section query-builder\">\n        <form className=\"form query-builder-form\" onSubmit={this.props.handleQuerySubmit}>\n          <SelectField name=\"analysis_type\"\n                       label=\"Analysis Type\"\n                       inputClasses={['analysis-type']}\n                       options={this.props.analysisTypes}\n                       value={this.props.model.query.analysis_type}\n                       handleChange={this.handleChange}\n                       requiredLabel={true} />\n          {this.buildEventCollectionField()}\n          {this.buildFunnelBuilder()}\n          {this.buildExtractionOptions()}\n          {this.buildTargetPropertyField()}\n          {this.buildPercentileField()}\n          {this.buildGlobalTimeframePicker()}\n          {this.buildGroupByField()}\n          {this.buildFilters()}\n          {this.buildIntervalField()}\n          <div className=\"button-set-clear-toggle\">\n            {this.buildClearButton()}\n          </div>\n          <ApiUrl url={apiQueryUrl}\n                  isValid={this.props.model.isValid} />\n        </form>\n      </section>\n    );\n  }\n});\n\nexport default QueryBuilder;\n","import React from 'react';\nimport classNames from 'classnames';\n\nconst QueryPaneTabs = React.createClass({\n\n  toggled: function(tab) {\n    this.props.toggleCallback(tab);\n  },\n\n  render: function() {\n    var btnNewQuery;\n    var queryPaneClasses = classNames({\n      'query-pane-tabs clearfix': true,\n      'query-pane-persisted': this.props.persisted,\n      'query-pane-new': !this.props.persisted\n    });\n\n    if (this.props.persisted) {\n      btnNewQuery = <li role=\"presentation\" className=\"tab-new-query\">\n        <a ref=\"new-query\" href=\"#\"\n           title=\"Create a new query\"\n           onClick={this.props.createNewQuery}>\n          <span className=\"icon glyphicon icon-plus glyphicon-plus\"></span>\n        </a>\n      </li>;\n    }\n\n    return (\n      <div className={queryPaneClasses}>\n        <ul className=\"nav nav-tabs\">\n          {btnNewQuery}\n          <li role=\"presentation\" className={this.props.activePane === 'build' ? 'tab-build-query active' : 'tab-build-query'}>\n            <a ref=\"build-tab\" href=\"#\"\n               id=\"build-query\"\n               title={this.props.persisted ? \"Edit query\" : \"Create a new query\"}\n               onClick={this.toggled.bind(this, 'build')}>\n              {this.props.persisted ? \"Edit query\" : \"Create a new query\"}\n            </a>\n          </li>\n          <li role=\"presentation\" className={this.props.activePane === 'browse' ? 'tab-browse-queries active' : 'tab-browse-queries'}>\n            <a ref=\"browse-tab\" href=\"#\"\n               id=\"browse\"\n               title=\"Browse saved queries\"\n               onClick={this.toggled.bind(this, 'browse')}>\n              <span className=\"icon glyphicon icon-th-list glyphicon-th-list\"></span>\n              Browse\n            </a>\n          </li>\n        </ul>\n      </div>\n    );\n  }\n\n});\n\nexport default QueryPaneTabs;\n","export default {\n  exportToCsv: function(data, filename) {\n    var csvContent = 'data:text/csv;charset=utf-8,';\n    var htmlElement;\n\n    data.forEach(function(row, i){\n      row.forEach(function(cell, j){\n        csvContent += String(cell).replace(/,/g, '');\n        if (row.length > j+1) {\n          csvContent += ',';\n        }\n      });\n      if (data.length > i+1) {\n        csvContent += '\\n';\n      }\n    });\n\n    htmlElement = document.createElement('a');\n    htmlElement.setAttribute('href', encodeURI(csvContent));\n    htmlElement.setAttribute('download', filename);\n    document.body.appendChild(htmlElement);\n    htmlElement.click();\n  }\n}\n","module.exports = __WEBPACK_EXTERNAL_MODULE__72__;","import _ from 'lodash';\nimport React from 'react';\nimport classNames from 'classnames';\nimport Highlight from 'react-highlight';\n\nconst CodeSample = React.createClass({\n  render: function() {\n    var panelClasses = classNames({\n      'code-sample-panel': true,\n      'hide': this.props.hidden\n    });\n\n    var text;\n    if(this.props.isValid) {\n      text = this.props.codeSample;\n    } else {\n      text = \"Your query is not valid right now, so we can't show you a code sample.\";\n    }\n\n    return (\n      <div className={panelClasses}>\n        <a href=\"#\" className=\"close-btn\" onClick={this.props.onCloseClick}>\n          <span className=\"icon glyphicon glyphicon glyphicon-remove-circle no-margin\"></span>\n        </a>\n        <div className=\"sample\">\n          <Highlight className=\"html\">\n            {text}\n          </Highlight>\n        </div>\n      </div>\n    );\n  }\n});\n\nexport default CodeSample;\n","//! moment-timezone.js\n//! version : 0.5.21\n//! Copyright (c) JS Foundation and other contributors\n//! license : MIT\n//! github.com/moment/moment-timezone\n\n(function (root, factory) {\n\t\"use strict\";\n\n\t/*global define*/\n\tif (typeof module === 'object' && module.exports) {\n\t\tmodule.exports = factory(require('moment')); // Node\n\t} else if (typeof define === 'function' && define.amd) {\n\t\tdefine(['moment'], factory);                 // AMD\n\t} else {\n\t\tfactory(root.moment);                        // Browser\n\t}\n}(this, function (moment) {\n\t\"use strict\";\n\n\t// Do not load moment-timezone a second time.\n\t// if (moment.tz !== undefined) {\n\t// \tlogError('Moment Timezone ' + moment.tz.version + ' was already loaded ' + (moment.tz.dataVersion ? 'with data from ' : 'without any data') + moment.tz.dataVersion);\n\t// \treturn moment;\n\t// }\n\n\tvar VERSION = \"0.5.21\",\n\t\tzones = {},\n\t\tlinks = {},\n\t\tnames = {},\n\t\tguesses = {},\n\t\tcachedGuess;\n\n\tif (!moment || typeof moment.version !== 'string') {\n\t\tlogError('Moment Timezone requires Moment.js. See https://momentjs.com/timezone/docs/#/use-it/browser/');\n\t}\n\n\tvar momentVersion = moment.version.split('.'),\n\t\tmajor = +momentVersion[0],\n\t\tminor = +momentVersion[1];\n\n\t// Moment.js version check\n\tif (major < 2 || (major === 2 && minor < 6)) {\n\t\tlogError('Moment Timezone requires Moment.js >= 2.6.0. You are using Moment.js ' + moment.version + '. See momentjs.com');\n\t}\n\n\t/************************************\n\t\tUnpacking\n\t************************************/\n\n\tfunction charCodeToInt(charCode) {\n\t\tif (charCode > 96) {\n\t\t\treturn charCode - 87;\n\t\t} else if (charCode > 64) {\n\t\t\treturn charCode - 29;\n\t\t}\n\t\treturn charCode - 48;\n\t}\n\n\tfunction unpackBase60(string) {\n\t\tvar i = 0,\n\t\t\tparts = string.split('.'),\n\t\t\twhole = parts[0],\n\t\t\tfractional = parts[1] || '',\n\t\t\tmultiplier = 1,\n\t\t\tnum,\n\t\t\tout = 0,\n\t\t\tsign = 1;\n\n\t\t// handle negative numbers\n\t\tif (string.charCodeAt(0) === 45) {\n\t\t\ti = 1;\n\t\t\tsign = -1;\n\t\t}\n\n\t\t// handle digits before the decimal\n\t\tfor (i; i < whole.length; i++) {\n\t\t\tnum = charCodeToInt(whole.charCodeAt(i));\n\t\t\tout = 60 * out + num;\n\t\t}\n\n\t\t// handle digits after the decimal\n\t\tfor (i = 0; i < fractional.length; i++) {\n\t\t\tmultiplier = multiplier / 60;\n\t\t\tnum = charCodeToInt(fractional.charCodeAt(i));\n\t\t\tout += num * multiplier;\n\t\t}\n\n\t\treturn out * sign;\n\t}\n\n\tfunction arrayToInt (array) {\n\t\tfor (var i = 0; i < array.length; i++) {\n\t\t\tarray[i] = unpackBase60(array[i]);\n\t\t}\n\t}\n\n\tfunction intToUntil (array, length) {\n\t\tfor (var i = 0; i < length; i++) {\n\t\t\tarray[i] = Math.round((array[i - 1] || 0) + (array[i] * 60000)); // minutes to milliseconds\n\t\t}\n\n\t\tarray[length - 1] = Infinity;\n\t}\n\n\tfunction mapIndices (source, indices) {\n\t\tvar out = [], i;\n\n\t\tfor (i = 0; i < indices.length; i++) {\n\t\t\tout[i] = source[indices[i]];\n\t\t}\n\n\t\treturn out;\n\t}\n\n\tfunction unpack (string) {\n\t\tvar data = string.split('|'),\n\t\t\toffsets = data[2].split(' '),\n\t\t\tindices = data[3].split(''),\n\t\t\tuntils  = data[4].split(' ');\n\n\t\tarrayToInt(offsets);\n\t\tarrayToInt(indices);\n\t\tarrayToInt(untils);\n\n\t\tintToUntil(untils, indices.length);\n\n\t\treturn {\n\t\t\tname       : data[0],\n\t\t\tabbrs      : mapIndices(data[1].split(' '), indices),\n\t\t\toffsets    : mapIndices(offsets, indices),\n\t\t\tuntils     : untils,\n\t\t\tpopulation : data[5] | 0\n\t\t};\n\t}\n\n\t/************************************\n\t\tZone object\n\t************************************/\n\n\tfunction Zone (packedString) {\n\t\tif (packedString) {\n\t\t\tthis._set(unpack(packedString));\n\t\t}\n\t}\n\n\tZone.prototype = {\n\t\t_set : function (unpacked) {\n\t\t\tthis.name       = unpacked.name;\n\t\t\tthis.abbrs      = unpacked.abbrs;\n\t\t\tthis.untils     = unpacked.untils;\n\t\t\tthis.offsets    = unpacked.offsets;\n\t\t\tthis.population = unpacked.population;\n\t\t},\n\n\t\t_index : function (timestamp) {\n\t\t\tvar target = +timestamp,\n\t\t\t\tuntils = this.untils,\n\t\t\t\ti;\n\n\t\t\tfor (i = 0; i < untils.length; i++) {\n\t\t\t\tif (target < untils[i]) {\n\t\t\t\t\treturn i;\n\t\t\t\t}\n\t\t\t}\n\t\t},\n\n\t\tparse : function (timestamp) {\n\t\t\tvar target  = +timestamp,\n\t\t\t\toffsets = this.offsets,\n\t\t\t\tuntils  = this.untils,\n\t\t\t\tmax     = untils.length - 1,\n\t\t\t\toffset, offsetNext, offsetPrev, i;\n\n\t\t\tfor (i = 0; i < max; i++) {\n\t\t\t\toffset     = offsets[i];\n\t\t\t\toffsetNext = offsets[i + 1];\n\t\t\t\toffsetPrev = offsets[i ? i - 1 : i];\n\n\t\t\t\tif (offset < offsetNext && tz.moveAmbiguousForward) {\n\t\t\t\t\toffset = offsetNext;\n\t\t\t\t} else if (offset > offsetPrev && tz.moveInvalidForward) {\n\t\t\t\t\toffset = offsetPrev;\n\t\t\t\t}\n\n\t\t\t\tif (target < untils[i] - (offset * 60000)) {\n\t\t\t\t\treturn offsets[i];\n\t\t\t\t}\n\t\t\t}\n\n\t\t\treturn offsets[max];\n\t\t},\n\n\t\tabbr : function (mom) {\n\t\t\treturn this.abbrs[this._index(mom)];\n\t\t},\n\n\t\toffset : function (mom) {\n\t\t\tlogError(\"zone.offset has been deprecated in favor of zone.utcOffset\");\n\t\t\treturn this.offsets[this._index(mom)];\n\t\t},\n\n\t\tutcOffset : function (mom) {\n\t\t\treturn this.offsets[this._index(mom)];\n\t\t}\n\t};\n\n\t/************************************\n\t\tCurrent Timezone\n\t************************************/\n\n\tfunction OffsetAt(at) {\n\t\tvar timeString = at.toTimeString();\n\t\tvar abbr = timeString.match(/\\([a-z ]+\\)/i);\n\t\tif (abbr && abbr[0]) {\n\t\t\t// 17:56:31 GMT-0600 (CST)\n\t\t\t// 17:56:31 GMT-0600 (Central Standard Time)\n\t\t\tabbr = abbr[0].match(/[A-Z]/g);\n\t\t\tabbr = abbr ? abbr.join('') : undefined;\n\t\t} else {\n\t\t\t// 17:56:31 CST\n\t\t\t// 17:56:31 GMT+0800 (台北標準時間)\n\t\t\tabbr = timeString.match(/[A-Z]{3,5}/g);\n\t\t\tabbr = abbr ? abbr[0] : undefined;\n\t\t}\n\n\t\tif (abbr === 'GMT') {\n\t\t\tabbr = undefined;\n\t\t}\n\n\t\tthis.at = +at;\n\t\tthis.abbr = abbr;\n\t\tthis.offset = at.getTimezoneOffset();\n\t}\n\n\tfunction ZoneScore(zone) {\n\t\tthis.zone = zone;\n\t\tthis.offsetScore = 0;\n\t\tthis.abbrScore = 0;\n\t}\n\n\tZoneScore.prototype.scoreOffsetAt = function (offsetAt) {\n\t\tthis.offsetScore += Math.abs(this.zone.utcOffset(offsetAt.at) - offsetAt.offset);\n\t\tif (this.zone.abbr(offsetAt.at).replace(/[^A-Z]/g, '') !== offsetAt.abbr) {\n\t\t\tthis.abbrScore++;\n\t\t}\n\t};\n\n\tfunction findChange(low, high) {\n\t\tvar mid, diff;\n\n\t\twhile ((diff = ((high.at - low.at) / 12e4 | 0) * 6e4)) {\n\t\t\tmid = new OffsetAt(new Date(low.at + diff));\n\t\t\tif (mid.offset === low.offset) {\n\t\t\t\tlow = mid;\n\t\t\t} else {\n\t\t\t\thigh = mid;\n\t\t\t}\n\t\t}\n\n\t\treturn low;\n\t}\n\n\tfunction userOffsets() {\n\t\tvar startYear = new Date().getFullYear() - 2,\n\t\t\tlast = new OffsetAt(new Date(startYear, 0, 1)),\n\t\t\toffsets = [last],\n\t\t\tchange, next, i;\n\n\t\tfor (i = 1; i < 48; i++) {\n\t\t\tnext = new OffsetAt(new Date(startYear, i, 1));\n\t\t\tif (next.offset !== last.offset) {\n\t\t\t\tchange = findChange(last, next);\n\t\t\t\toffsets.push(change);\n\t\t\t\toffsets.push(new OffsetAt(new Date(change.at + 6e4)));\n\t\t\t}\n\t\t\tlast = next;\n\t\t}\n\n\t\tfor (i = 0; i < 4; i++) {\n\t\t\toffsets.push(new OffsetAt(new Date(startYear + i, 0, 1)));\n\t\t\toffsets.push(new OffsetAt(new Date(startYear + i, 6, 1)));\n\t\t}\n\n\t\treturn offsets;\n\t}\n\n\tfunction sortZoneScores (a, b) {\n\t\tif (a.offsetScore !== b.offsetScore) {\n\t\t\treturn a.offsetScore - b.offsetScore;\n\t\t}\n\t\tif (a.abbrScore !== b.abbrScore) {\n\t\t\treturn a.abbrScore - b.abbrScore;\n\t\t}\n\t\treturn b.zone.population - a.zone.population;\n\t}\n\n\tfunction addToGuesses (name, offsets) {\n\t\tvar i, offset;\n\t\tarrayToInt(offsets);\n\t\tfor (i = 0; i < offsets.length; i++) {\n\t\t\toffset = offsets[i];\n\t\t\tguesses[offset] = guesses[offset] || {};\n\t\t\tguesses[offset][name] = true;\n\t\t}\n\t}\n\n\tfunction guessesForUserOffsets (offsets) {\n\t\tvar offsetsLength = offsets.length,\n\t\t\tfilteredGuesses = {},\n\t\t\tout = [],\n\t\t\ti, j, guessesOffset;\n\n\t\tfor (i = 0; i < offsetsLength; i++) {\n\t\t\tguessesOffset = guesses[offsets[i].offset] || {};\n\t\t\tfor (j in guessesOffset) {\n\t\t\t\tif (guessesOffset.hasOwnProperty(j)) {\n\t\t\t\t\tfilteredGuesses[j] = true;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tfor (i in filteredGuesses) {\n\t\t\tif (filteredGuesses.hasOwnProperty(i)) {\n\t\t\t\tout.push(names[i]);\n\t\t\t}\n\t\t}\n\n\t\treturn out;\n\t}\n\n\tfunction rebuildGuess () {\n\n\t\t// use Intl API when available and returning valid time zone\n\t\ttry {\n\t\t\tvar intlName = Intl.DateTimeFormat().resolvedOptions().timeZone;\n\t\t\tif (intlName && intlName.length > 3) {\n\t\t\t\tvar name = names[normalizeName(intlName)];\n\t\t\t\tif (name) {\n\t\t\t\t\treturn name;\n\t\t\t\t}\n\t\t\t\tlogError(\"Moment Timezone found \" + intlName + \" from the Intl api, but did not have that data loaded.\");\n\t\t\t}\n\t\t} catch (e) {\n\t\t\t// Intl unavailable, fall back to manual guessing.\n\t\t}\n\n\t\tvar offsets = userOffsets(),\n\t\t\toffsetsLength = offsets.length,\n\t\t\tguesses = guessesForUserOffsets(offsets),\n\t\t\tzoneScores = [],\n\t\t\tzoneScore, i, j;\n\n\t\tfor (i = 0; i < guesses.length; i++) {\n\t\t\tzoneScore = new ZoneScore(getZone(guesses[i]), offsetsLength);\n\t\t\tfor (j = 0; j < offsetsLength; j++) {\n\t\t\t\tzoneScore.scoreOffsetAt(offsets[j]);\n\t\t\t}\n\t\t\tzoneScores.push(zoneScore);\n\t\t}\n\n\t\tzoneScores.sort(sortZoneScores);\n\n\t\treturn zoneScores.length > 0 ? zoneScores[0].zone.name : undefined;\n\t}\n\n\tfunction guess (ignoreCache) {\n\t\tif (!cachedGuess || ignoreCache) {\n\t\t\tcachedGuess = rebuildGuess();\n\t\t}\n\t\treturn cachedGuess;\n\t}\n\n\t/************************************\n\t\tGlobal Methods\n\t************************************/\n\n\tfunction normalizeName (name) {\n\t\treturn (name || '').toLowerCase().replace(/\\//g, '_');\n\t}\n\n\tfunction addZone (packed) {\n\t\tvar i, name, split, normalized;\n\n\t\tif (typeof packed === \"string\") {\n\t\t\tpacked = [packed];\n\t\t}\n\n\t\tfor (i = 0; i < packed.length; i++) {\n\t\t\tsplit = packed[i].split('|');\n\t\t\tname = split[0];\n\t\t\tnormalized = normalizeName(name);\n\t\t\tzones[normalized] = packed[i];\n\t\t\tnames[normalized] = name;\n\t\t\taddToGuesses(normalized, split[2].split(' '));\n\t\t}\n\t}\n\n\tfunction getZone (name, caller) {\n\t\t\n\t\tname = normalizeName(name);\n\n\t\tvar zone = zones[name];\n\t\tvar link;\n\n\t\tif (zone instanceof Zone) {\n\t\t\treturn zone;\n\t\t}\n\n\t\tif (typeof zone === 'string') {\n\t\t\tzone = new Zone(zone);\n\t\t\tzones[name] = zone;\n\t\t\treturn zone;\n\t\t}\n\n\t\t// Pass getZone to prevent recursion more than 1 level deep\n\t\tif (links[name] && caller !== getZone && (link = getZone(links[name], getZone))) {\n\t\t\tzone = zones[name] = new Zone();\n\t\t\tzone._set(link);\n\t\t\tzone.name = names[name];\n\t\t\treturn zone;\n\t\t}\n\n\t\treturn null;\n\t}\n\n\tfunction getNames () {\n\t\tvar i, out = [];\n\n\t\tfor (i in names) {\n\t\t\tif (names.hasOwnProperty(i) && (zones[i] || zones[links[i]]) && names[i]) {\n\t\t\t\tout.push(names[i]);\n\t\t\t}\n\t\t}\n\n\t\treturn out.sort();\n\t}\n\n\tfunction addLink (aliases) {\n\t\tvar i, alias, normal0, normal1;\n\n\t\tif (typeof aliases === \"string\") {\n\t\t\taliases = [aliases];\n\t\t}\n\n\t\tfor (i = 0; i < aliases.length; i++) {\n\t\t\talias = aliases[i].split('|');\n\n\t\t\tnormal0 = normalizeName(alias[0]);\n\t\t\tnormal1 = normalizeName(alias[1]);\n\n\t\t\tlinks[normal0] = normal1;\n\t\t\tnames[normal0] = alias[0];\n\n\t\t\tlinks[normal1] = normal0;\n\t\t\tnames[normal1] = alias[1];\n\t\t}\n\t}\n\n\tfunction loadData (data) {\n\t\taddZone(data.zones);\n\t\taddLink(data.links);\n\t\ttz.dataVersion = data.version;\n\t}\n\n\tfunction zoneExists (name) {\n\t\tif (!zoneExists.didShowError) {\n\t\t\tzoneExists.didShowError = true;\n\t\t\t\tlogError(\"moment.tz.zoneExists('\" + name + \"') has been deprecated in favor of !moment.tz.zone('\" + name + \"')\");\n\t\t}\n\t\treturn !!getZone(name);\n\t}\n\n\tfunction needsOffset (m) {\n\t\tvar isUnixTimestamp = (m._f === 'X' || m._f === 'x');\n\t\treturn !!(m._a && (m._tzm === undefined) && !isUnixTimestamp);\n\t}\n\n\tfunction logError (message) {\n\t\tif (typeof console !== 'undefined' && typeof console.error === 'function') {\n\t\t\tconsole.error(message);\n\t\t}\n\t}\n\n\t/************************************\n\t\tmoment.tz namespace\n\t************************************/\n\n\tfunction tz (input) {\n\t\tvar args = Array.prototype.slice.call(arguments, 0, -1),\n\t\t\tname = arguments[arguments.length - 1],\n\t\t\tzone = getZone(name),\n\t\t\tout  = moment.utc.apply(null, args);\n\n\t\tif (zone && !moment.isMoment(input) && needsOffset(out)) {\n\t\t\tout.add(zone.parse(out), 'minutes');\n\t\t}\n\n\t\tout.tz(name);\n\n\t\treturn out;\n\t}\n\n\ttz.version      = VERSION;\n\ttz.dataVersion  = '';\n\ttz._zones       = zones;\n\ttz._links       = links;\n\ttz._names       = names;\n\ttz.add          = addZone;\n\ttz.link         = addLink;\n\ttz.load         = loadData;\n\ttz.zone         = getZone;\n\ttz.zoneExists   = zoneExists; // deprecated in 0.1.0\n\ttz.guess        = guess;\n\ttz.names        = getNames;\n\ttz.Zone         = Zone;\n\ttz.unpack       = unpack;\n\ttz.unpackBase60 = unpackBase60;\n\ttz.needsOffset  = needsOffset;\n\ttz.moveInvalidForward   = true;\n\ttz.moveAmbiguousForward = false;\n\n\t/************************************\n\t\tInterface with Moment.js\n\t************************************/\n\n\tvar fn = moment.fn;\n\n\tmoment.tz = tz;\n\n\tmoment.defaultZone = null;\n\n\tmoment.updateOffset = function (mom, keepTime) {\n\t\tvar zone = moment.defaultZone,\n\t\t\toffset;\n\n\t\tif (mom._z === undefined) {\n\t\t\tif (zone && needsOffset(mom) && !mom._isUTC) {\n\t\t\t\tmom._d = moment.utc(mom._a)._d;\n\t\t\t\tmom.utc().add(zone.parse(mom), 'minutes');\n\t\t\t}\n\t\t\tmom._z = zone;\n\t\t}\n\t\tif (mom._z) {\n\t\t\toffset = mom._z.utcOffset(mom);\n\t\t\tif (Math.abs(offset) < 16) {\n\t\t\t\toffset = offset / 60;\n\t\t\t}\n\t\t\tif (mom.utcOffset !== undefined) {\n\t\t\t\tmom.utcOffset(-offset, keepTime);\n\t\t\t} else {\n\t\t\t\tmom.zone(offset, keepTime);\n\t\t\t}\n\t\t}\n\t};\n\n\tfn.tz = function (name, keepTime) {\n\t\tif (name) {\n\t\t\tif (typeof name !== 'string') {\n\t\t\t\tthrow new Error('Time zone name must be a string, got ' + name + ' [' + typeof name + ']');\n\t\t\t}\n\t\t\tthis._z = getZone(name);\n\t\t\tif (this._z) {\n\t\t\t\tmoment.updateOffset(this, keepTime);\n\t\t\t} else {\n\t\t\t\tlogError(\"Moment Timezone has no data for \" + name + \". See http://momentjs.com/timezone/docs/#/data-loading/.\");\n\t\t\t}\n\t\t\treturn this;\n\t\t}\n\t\tif (this._z) { return this._z.name; }\n\t};\n\n\tfunction abbrWrap (old) {\n\t\treturn function () {\n\t\t\tif (this._z) { return this._z.abbr(this); }\n\t\t\treturn old.call(this);\n\t\t};\n\t}\n\n\tfunction resetZoneWrap (old) {\n\t\treturn function () {\n\t\t\tthis._z = null;\n\t\t\treturn old.apply(this, arguments);\n\t\t};\n\t}\n\n\tfn.zoneName = abbrWrap(fn.zoneName);\n\tfn.zoneAbbr = abbrWrap(fn.zoneAbbr);\n\tfn.utc      = resetZoneWrap(fn.utc);\n\n\tmoment.tz.setDefault = function(name) {\n\t\tif (major < 2 || (major === 2 && minor < 9)) {\n\t\t\tlogError('Moment Timezone setDefault() requires Moment.js >= 2.9.0. You are using Moment.js ' + moment.version + '.');\n\t\t}\n\t\tmoment.defaultZone = name ? getZone(name) : null;\n\t\treturn moment;\n\t};\n\n\t// Cloning a moment should include the _z property.\n\tvar momentProperties = moment.momentProperties;\n\tif (Object.prototype.toString.call(momentProperties) === '[object Array]') {\n\t\t// moment 2.8.1+\n\t\tmomentProperties.push('_z');\n\t\tmomentProperties.push('_a');\n\t} else if (momentProperties) {\n\t\t// moment 2.7.0\n\t\tmomentProperties._z = null;\n\t}\n\n\t// INJECT DATA\n\n\treturn moment;\n}));\n","import React from 'react';\nimport ChartTypeUtils from '../../../utils/ChartTypeUtils';\nimport FormatUtils from '../../../utils/FormatUtils';\nimport KeenDataviz from 'keen-dataviz';\nimport moment from 'moment-timezone';\n\nconst KeenViz = React.createClass({\n\n  lastDataTimestamp: null,\n  lastChartType: null,\n  datavizInstance: null,\n\n  // ***********************\n  // Convenience functions\n  // ***********************\n\n  showVisualization: function() {\n    if (this.datavizInstance) {\n      this.datavizInstance.destroy();\n    }\n\n    let sortGroups;\n    if (this.props.model.query.analysis_type !== \"funnel\") {\n      sortGroups = 'desc';\n    }\n\n    let type;\n    if (this.props.model.metadata.visualization.chart_type) {\n      type = this.props.model.metadata.visualization.chart_type;\n    }\n    let results = this.props.model.response;\n    if (Array.isArray(results.result)\n     && results.result[0].timeframe && results.result[0].timeframe.start\n     && !this.props.model.response.dateConvertedToTimezone\n     && type !== 'table'\n   ){\n       this.props.model.response.dateConvertedToTimezone = true;\n       const dateFormat = 'YYYY-MM-DDTHH:mm:ss.000Z';\n       results.result.forEach((result, key) => {\n         results.result[key].timeframe.start = moment(result.timeframe.start).tz(results.query.timezone).format(dateFormat);\n         results.result[key].timeframe.end = moment(result.timeframe.end).tz(results.query.timezone).format(dateFormat);\n       });\n    }\n\n    this.datavizInstance = new KeenDataviz({\n      container: this.refs['keen-viz'],\n      showTitle: false,\n      type,\n      sortGroups,\n      results,\n      ...((this.props.config && this.props.config.keenDatavizOptions) || {})\n    });\n\n    this.lastDataTimestamp = this.props.model.dataTimestamp;\n    this.lastChartType = this.props.model.metadata.visualization.chart_type;\n  },\n\n  // ***********************\n  // Lifecycle hooks\n  // ***********************\n\n  shouldComponentUpdate: function(nextProps, nextState) {\n    if (this.lastChartType !== nextProps.model.metadata.visualization.chart_type) {\n      return true;\n    }\n    if (!this.lastDataTimestamp || this.lastDataTimestamp !== nextProps.model.dataTimestamp) {\n      return true\n    }\n    return false;\n  },\n\n  componentDidUpdate: function() {\n    this.showVisualization();\n  },\n\n  componentDidMount: function() {\n    this.showVisualization();\n  },\n\n  render: function() {\n    var exportBtn;\n    if (ChartTypeUtils.isTableChartType(this.props.model.metadata.visualization.chart_type)) {\n      exportBtn = (\n        <button className=\"btn btn-default btn-download-csv\"\n                role=\"export-table\"\n                type=\"button\"\n                onClick={() => this.props.exportToCsv(this.datavizInstance)}>\n          Download CSV\n        </button>\n      );\n    }\n\n    return (\n      <div ref=\"keen-viz-wrapper\">\n        <div ref=\"keen-viz\"></div>\n        {exportBtn}\n      </div>\n    );\n  }\n});\n\nexport default KeenViz;\n","import _ from 'lodash';\nimport React from 'react';\nimport Loader from '../../common/loader.js';\nimport KeenViz from './keen_viz.js';\nimport ExplorerUtils from '../../../utils/ExplorerUtils';\nimport { prettyPrintJSON } from '../../../utils/FormatUtils';\n\nconst Chart = React.createClass({\n\n  // ***********************\n  // Content building\n  // ***********************\n\n  buildVizContent: function() {\n    if (!this.props.model.response) {\n      return (\n          <div ref=\"notice\" className=\"big-notice\">\n          <div className=\"alert alert-info\">\n          {'Let\\'s go exploring!'}\n          </div>\n          </div>\n          );\n    }\n\n    if (ExplorerUtils.isEmailExtraction(this.props.model)) {\n      return (\n          <div ref=\"notice\" className=\"big-notice\">\n          <div className=\"alert alert-info\">\n          {'Email extractions don\\'t have visualizations.'}\n          </div>\n          </div>\n          );\n    }\n\n    if (!ExplorerUtils.resultCanBeVisualized(this.props.model)) {\n      return (\n          <div ref=\"notice\" className=\"big-notice\">\n          <div className=\"alert alert-danger\">\n          <span className=\"icon glyphicon glyphicon-info-sign error\"></span>\n          Your query returned no results.\n          </div>\n          </div>\n          );\n    }\n\n    if (ExplorerUtils.resultCanBeVisualized(this.props.model)) {\n      return this.buildViz();\n    } else {\n      this.props.dataviz.destroy();\n    }\n  },\n\n  buildViz: function() {\n    var chartContent;\n    var msgContent;\n    var analysisType = this.props.model.query.analysis_type;\n    var wrapClasses = analysisType + '-viz';\n\n    if (ExplorerUtils.isJSONViz(this.props.model)) {\n      var content = {\n        result: this.props.model.response.result\n      };\n      if (this.props.model.response.actors) {\n        content.actors = this.props.model.response.actors;\n      }\n      chartContent = (\n        <textarea ref='jsonViz'\n                  className=\"json-view\"\n                  value={prettyPrintJSON(content)}\n                  readOnly />\n      );\n    }\n\n    else {\n      chartContent = (\n          <KeenViz model={this.props.model}\n          config={this.props.config}\n          exportToCsv={this.props.exportToCsv}/>\n          );\n    }\n\n    return (\n        <div className={wrapClasses}>\n        {chartContent}\n        </div>\n        );\n  },\n\n  // ***********************\n  // Lifecycle hooks\n  // ***********************\n\n  render: function() {\n    var vizContent = this.buildVizContent();\n\n    return (\n        <div className=\"chart-area\">\n        <Loader visible={this.props.model.loading} />\n        {vizContent}\n        </div>\n        );\n    }\n});\n\nexport default Chart;\n","import _ from 'lodash';\nimport React from 'react';\nimport classNames from 'classnames';\nimport KeenDataviz from 'keen-dataviz';\nimport Select from '../../common/select.js';\nimport Notice from '../../common/notice.js';\nimport Chart from './chart.js';\nimport CodeSample from './code_sample.js';\nimport AppDispatcher from '../../../dispatcher/AppDispatcher';\nimport ExplorerConstants from '../../../constants/ExplorerConstants';\nimport ExplorerActions from '../../../actions/ExplorerActions';\nimport ExplorerStore from '../../../stores/ExplorerStore';\nimport NoticeActions from '../../../actions/NoticeActions';\nimport ExplorerUtils from '../../../utils/ExplorerUtils';\nimport ChartTypeUtils from '../../../utils/ChartTypeUtils';\nimport FormatUtils from '../../../utils/FormatUtils';\nimport DataUtils from '../../../utils/DataUtils';\n\nconst Visualization = React.createClass({\n\n  getInitialState: function() {\n    return {\n      focusDisplayName: false,\n      focusQueryName: false,\n      blurTimeout: 100\n    };\n  },\n\n  handleDisplayNameFocus: function(){\n    this.setState({ focusDisplayName: true });\n  },\n\n  handleDisplayNameBlur: function(){\n    setTimeout(function(){\n      this.setState({ focusDisplayName: false });\n    }.bind(this), this.state.blurTimeout);\n  },\n\n  handleQueryNameFocus: function(){\n    this.setState({ focusQueryName: true });\n  },\n\n  handleQueryNameBlur: function(){\n    setTimeout(function(){\n      this.setState({ focusQueryName: false });\n    }.bind(this), this.state.blurTimeout);\n  },\n\n  noticeClosed: function() {\n    NoticeActions.clearAll();\n  },\n\n  changeChartType: function(event) {\n    var chartType = _.find(this.formatChartTypes(), function(type){\n      return type.value === event.target.value;\n    });\n    var updates = {\n      metadata: {\n        visualization: { chart_type: chartType.value }\n      }\n    };\n    ExplorerActions.update(this.props.model.id, updates);\n  },\n\n  formatChartTypes: function() {\n    return _.map(ChartTypeUtils.getChartTypeOptions(this.props.model.query), function(type) {\n      return {\n        name: (type !== 'JSON') ? FormatUtils.toTitleCase(type).replace('chart', '') : type,\n        value: type\n      };\n    });\n  },\n\n  chartType: function() {\n    if (this.props.model.metadata.visualization &&\n        this.props.model.metadata.visualization.chart_type) {\n      return this.props.model.metadata.visualization.chart_type;\n    }\n    else {\n      return _.first(ChartTypeUtils.getChartTypeOptions(this.props.model.query))\n    }\n  },\n\n  componentWillMount: function() {\n    this.dataviz = new KeenDataviz();\n  },\n\n  componentWillUnmount: function() {\n    AppDispatcher.unregister(this.dispatcherToken);\n  },\n\n  exportToCsv: function(dataviz) {\n    let data = this.dataviz.dataset.matrix;\n    if (dataviz && dataviz.dataset && dataviz.dataset.matrix) {\n      data = dataviz.dataset.matrix;\n    }\n    var filename = this.props.model.query_name || 'untitled-query';\n    DataUtils.exportToCsv(data, filename);\n  },\n\n  render: function() {\n    var chartTitle,\n        codeSample;\n\n    var chartDetailBarClasses = classNames({\n      'chart-detail-bar': true,\n      'chart-detail-bar-focus': (this.state.focusDisplayName || this.state.focusQueryName) && this.props.model.response !== null && !this.props.model.loading,\n      'chart-detail-active': this.props.model.response !== null && !this.props.model.loading\n    });\n\n    if (this.props.model.isValid) {\n      codeSample = ExplorerUtils.getSdkExample(this.props.model, this.props.client, this.props.config);\n    }\n\n    if (this.props.persistence) {\n      const display_name = this.props.model.metadata.display_name || '';\n      const query_name = this.props.model.query_name || '';\n      chartTitle = (\n        <div className=\"chart-title-component\">\n          <input className=\"chart-display-name\"\n                 type=\"text\"\n                 onChange={this.props.onDisplayNameChange}\n                 onBlur={this.handleDisplayNameBlur}\n                 onFocus={this.handleDisplayNameFocus}\n                 spellCheck=\"false\"\n                 value={display_name}\n                 placeholder=\"Give your query a name...\" />\n          <div className=\"chart-query-name\">\n            <label>\n              Saved Query Resource Name &nbsp;\n              <a href=\"https://keen.io/docs/api/#saved-queries\" target=\"_blank\">\n                <i className=\"icon glyphicon glyphicon-question-sign\"></i>\n              </a>\n            </label>\n            <input className=\"chart-query-name\"\n                   type=\"text\"\n                   onChange={this.props.onQueryNameChange}\n                   onBlur={this.handleQueryNameBlur}\n                   onFocus={this.handleQueryNameFocus}\n                   spellCheck=\"false\"\n                   value={query_name} />\n          </div>\n        </div>\n      );\n    }\n\n    return (\n      <div className=\"visualization\">\n        <Notice notice={this.props.notice} closeCallback={this.noticeClosed} />\n        <div className=\"visualization-wrapper\">\n          <div className={chartDetailBarClasses}>\n            {chartTitle}\n            <div className=\"chart-type-component\">\n              <Select label={false}\n                      ref=\"chart-type\"\n                      name=\"chart_type\"\n                      classes=\"chart-type\"\n                      options={this.formatChartTypes()}\n                      handleSelection={this.changeChartType}\n                      selectedOption={this.chartType()}\n                      emptyOption={false}\n                      disabled={this.props.model.loading} />\n            </div>\n          </div>\n          <div className=\"chart-component\">\n            <Chart model={this.props.model}\n                   dataviz={this.dataviz}\n                   config={this.props.config}\n                   exportToCsv={this.exportToCsv}/>\n          </div>\n          <CodeSample ref=\"codesample\"\n                      codeSample={codeSample}\n                      hidden={this.props.appState.codeSampleHidden}\n                      onCloseClick={this.props.toggleCodeSample}\n                      isValid={this.props.model.isValid} />\n        </div>\n      </div>\n    );\n  }\n});\n\nexport default Visualization;\n","import React from 'react';\nimport _ from 'lodash';\nimport classNames from 'classnames';\nimport Loader from '../common/loader.js';\nimport FormatUtils from '../../utils/FormatUtils';\nimport ProjectUtils from '../../utils/ProjectUtils';\nimport ProjectActions from '../../actions/ProjectActions';\nimport Modal from './modal.js';\n\nconst EventBrowser = React.createClass({\n\n  onKeyUp: function(event) {\n    var enterKeyCode = 13;\n    if (event.keyCode === enterKeyCode) this.selectEventCollection();\n  },\n\n  shouldFetchCollectionSchema: function (collection) {\n    if (!this.props.project.schema[collection]) return false;\n    return _.keys(this.props.project.schema[collection].properties).length < 1;\n  },\n\n  selectEventCollectionClick: function(event) {\n    event.preventDefault();\n    this.props.selectEventCollection(this.state.activeEventCollection);\n  },\n\n  setActiveEventCollectionClick: function(event) {\n    this.setActiveEventCollection(event.target.innerText);\n  },\n\n  setActiveEventCollection: function(collection) {\n    if (collection === this.state.activeEventCollection) return;\n    this.setState({ activeEventCollection: collection });\n    if (this.state.activeView === 'recentEvents') {\n      this.fetchRecentEvents(collection);\n    }\n    else if (this.shouldFetchCollectionSchema(collection)) {\n      ProjectActions.fetchCollectionSchema(this.props.client, collection);\n    }\n  },\n\n  modalOpened: function() {\n    if (this.state.activeView === 'recentEvents') {\n      this.fetchRecentEvents();\n    }\n    else if (this.shouldFetchCollectionSchema(this.state.activeEventCollection)) {\n      ProjectActions.fetchCollectionSchema(this.props.client, this.state.activeEventCollection);\n    }\n  },\n\n  fetchRecentEvents: function(collectionToUse) {\n    var collection = collectionToUse ? collectionToUse : this.state.activeEventCollection;\n    var schema = this.props.project.schema;\n    if (!_.isEmpty(schema) && schema[collection] && !schema[collection].recentEvents && !schema[collection].loading) {\n      ProjectActions.fetchRecentEventsForCollection(this.props.client, collection);\n    }\n  },\n\n  setSearchText: function(event) {\n    this.setState({ searchtext: event.target.value });\n  },\n\n  // Builders\n\n  buildEventCollectionNodes: function() {\n    return _.map(this.props.project.eventCollections, _.bind(function(eventCollection) {\n      var re = new RegExp(this.state.searchtext, 'i');\n      var classes = classNames({\n        'active': this.state.activeEventCollection === eventCollection,\n        'hide':  re.test(eventCollection) ? false : true\n      });\n      return (\n        <li className={classes} key={eventCollection}>\n          <a href=\"#\" onClick={this.setActiveEventCollectionClick}>{eventCollection}</a>\n        </li>\n      );\n    }, this));\n  },\n\n  // Convenience functions\n\n  getNavClasses: function(name) {\n    return (this.state.activeView === name) ? 'active' : '';\n  },\n\n  shouldShowLoader: function() {\n    if (this.props.project.schema[this.state.activeEventCollection]) {\n      return this.props.project.schema[this.state.activeEventCollection].loading;\n    }\n    return false;\n  },\n\n  getRecentEvents: function() {\n    if (!this.props.project.schema[this.state.activeEventCollection]) return \"\";\n    var recentEvents = this.props.project.schema[this.state.activeEventCollection].recentEvents;\n    return recentEvents ? FormatUtils.prettyPrintJSON(recentEvents) : \"\";\n  },\n\n  getSchema: function() {\n    var schema = this.props.project.schema;\n    var collection = this.state.activeEventCollection;\n    var properties = schema[collection] ? schema[collection].properties : {};\n    var ordered = {};\n    if (properties) {\n      _.each(Object.keys(properties).sort(), function(key, i) {\n        ordered[key] = properties[key];\n      });\n    }\n    return FormatUtils.prettyPrintJSON(ordered) || '';\n  },\n\n  changeActiveView: function(event) {\n    event.preventDefault();\n    var tabName = event.target.name;\n    this.setState({ activeView: tabName });\n    if (tabName === 'recentEvents') this.fetchRecentEvents();\n  },\n\n  // Lifecycle hooks\n\n  getInitialState: function() {\n    return {\n      activeView: 'schema',\n      activeEventCollection: null,\n      searchtext: ''\n    }\n  },\n\n  componentDidMount: function() {\n    if (!this.state.activeEventCollection && !_.isEmpty(this.props.project.schema)) {\n      this.setActiveEventCollection(this.props.currentEventCollection || this.props.project.eventCollections[0]);\n    }\n  },\n\n  componentWillReceiveProps: function(nextProps) {\n    if (!_.isEmpty(nextProps.project.schema) && !this.state.activeEventCollection) {\n      this.setState({ activeEventCollection: nextProps.project.eventCollections[0] });\n    }\n    if (nextProps.currentEventCollection && nextProps.currentEventCollection != this.props.currentEventCollection) {\n      this.setState({ activeEventCollection: nextProps.currentEventCollection });\n    }\n  },\n\n  render: function() {\n    var previewData;\n    if (this.state.activeView === 'recentEvents') {\n      previewData = this.getRecentEvents();\n    } else {\n      previewData = this.getSchema();\n    }\n\n    var browseContent = (\n      <div className=\"event-browser\" onKeyUp={this.handleKeyUp}>\n        <div className=\"event-names\">\n          <div className=\"search-box\">\n            <input type=\"text\" name=\"search\" ref=\"search-box\" placeholder=\"Search...\" onChange={this.setSearchText} autoComplete=\"off\" />\n            <span className=\"glyphicon glyphicon-search icon\"></span>\n          </div>\n          <ul className=\"nav nav-pills nav-stacked event-names-list\" ref=\"event-names-list\">\n            {this.buildEventCollectionNodes()}\n          </ul>\n        </div>\n        <div className=\"event-browser-content\">\n          <ul className=\"nav nav-tabs view-options\">\n            <li className={this.getNavClasses('schema')}>\n              <a href=\"#\" name=\"schema\" onClick={this.changeActiveView}>\n                Schema\n              </a>\n            </li>\n            <li className={this.getNavClasses('recentEvents')}>\n              <a href=\"#\" name=\"recentEvents\" onClick={this.changeActiveView}>\n                Recent Events\n              </a>\n            </li>\n          </ul>\n          <div ref=\"event-data-wrapper\" className=\"event-data-wrapper\">\n            <Loader ref=\"loader\" visible={this.shouldShowLoader()} />\n            <textarea className=\"json-view\" value={previewData} readOnly />\n          </div>\n        </div>\n      </div>\n    );\n\n    var alertContent = (\n      <div className=\"alert alert-info no-margin no-collections-alert\">\n        There is no data to preview. This project does not have any event collections.\n      </div>\n    );\n\n    var footerBtns = [{ text: 'Close' }];\n\n    var modalClasses = this.props.project.eventCollections.length > 0 ? \"event-browser-modal\" : \"\";\n\n    if (this.props.project.eventCollections.length > 0) {\n      footerBtns.push({\n        text: 'Use this Event Collection',\n        iconName: 'ok',\n        classes: 'btn-primary',\n        onClick: this.selectEventCollectionClick\n      });\n    }\n\n    return (\n      <Modal ref=\"modal\"\n             title=\"Project Event Collections\"\n             size=\"large\"\n             modalClasses={modalClasses}\n             onOpen={this.modalOpened}\n             footerBtns={footerBtns}>\n\n        { this.props.project.eventCollections.length > 0 ? browseContent : alertContent }\n      </Modal>\n    );\n  }\n});\n\nexport default EventBrowser;\n","import React from 'react';\nimport _ from 'lodash';\nimport EventBrowser from '../common/event_browser.js';\nimport Visualization from './visualization/index.js';\nimport QueryPaneTabs from './query_pane_tabs.js';\nimport QueryBuilder from './query_builder/index.js';\nimport BrowseQueries from './saved_queries/browse_queries.js';\nimport CacheToggle from './cache_toggle.js';\nimport QueryActions from './query_actions.js';\nimport Notice from '../common/notice.js';\nimport FilterManager from '../common/filter_manager.js';\nimport ExplorerStore from '../../stores/ExplorerStore';\nimport ExplorerActions from '../../actions/ExplorerActions';\nimport NoticeActions from '../../actions/NoticeActions';\nimport AppStateActions from '../../actions/AppStateActions';\nimport NoticeStore from '../../stores/NoticeStore';\nimport AppStateStore from '../../stores/AppStateStore';\nimport ExplorerUtils from '../../utils/ExplorerUtils';\nimport FilterUtils from '../../utils/FilterUtils';\nimport ProjectUtils from '../../utils/ProjectUtils';\nimport QueryStringUtils from '../../utils/QueryStringUtils';\n\nfunction getStoresState() {\n  return {\n    allPersistedExplorers: ExplorerStore.getAllPersisted(),\n    activeExplorer: ExplorerStore.getActive(),\n    notice: NoticeStore.getGlobalNotice(),\n    stepNotices: NoticeStore.getStepNotices(),\n    appState: AppStateStore.getState()\n  };\n}\n\nconst Explorer = React.createClass({\n\n  toggleFields: function() {\n    _.each(this.getFieldsToggleComponents(), function(toggleObj) {\n      if (toggleObj.component) {\n        var hasValue = (!_.isUndefined(toggleObj.value) && !_.isNull(toggleObj.value)) ? true : false;\n        toggleObj.component.setState({ open: hasValue });\n      }\n    });\n  },\n\n  // ********************************\n  // Callbacks for child components\n  // ********************************\n\n  selectEventCollection: function(collectionName) {\n    var updates = {\n      query: {\n        event_collection: collectionName\n      }\n    };\n    ExplorerActions.update(this.state.activeExplorer.id, updates);\n    this.refs['event-browser'].refs.modal.close();\n  },\n\n  savedQueryClicked: function(event) {\n    event.preventDefault();\n    if (this.state.activeExplorer.loading) {\n      NoticeActions.create({\n        icon: 'info-sign',\n        type: 'warning',\n        text: \"There is already a query in progress. Wait for it to finish loading before selecting a query.\"\n      });\n    } else {\n      ExplorerActions.revertActiveChanges();\n      var modelId = event.currentTarget.dataset.id;\n      ExplorerActions.setActive(modelId);\n      ExplorerActions.exec(this.props.client, modelId);\n    }\n  },\n\n  removeSavedQueryClicked: function() {\n    if (confirm('Are you sure you want to delete this saved query?')) {\n      ExplorerActions.destroy(this.props.persistence, this.state.activeExplorer.id);\n    }\n  },\n\n  saveQueryClick: function(event) {\n    event.preventDefault();\n    ExplorerActions.save(this.props.persistence, this.state.activeExplorer.id);\n  },\n\n  cloneQueryClick: function(event) {\n    event.preventDefault();\n    ExplorerActions.clone(this.state.activeExplorer.id);\n    var newExplorer = ExplorerStore.getLast();\n    ExplorerActions.setActive(newExplorer.id);\n    this.setState({ activeQueryPane: 'build' });\n  },\n\n  createNewQuery: function(event) {\n    event.preventDefault();\n    ExplorerActions.create();\n    var newExplorer = ExplorerStore.getLast();\n    ExplorerActions.setActive(newExplorer.id);\n    this.setState({ activeQueryPane: 'build' });\n  },\n\n  onBrowseEvents: function(event) {\n    event.preventDefault();\n    this.refs['event-browser'].refs.modal.open();\n  },\n\n  handleFiltersToggle: function() {\n    this.refs['filter-manager'].open();\n  },\n\n  onDisplayNameChange: function(event) {\n    var updates = {\n      query_name: ExplorerUtils.slugify(event.target.value),\n      metadata: {\n        display_name: event.target.value\n      }\n    };\n    ExplorerActions.update(this.state.activeExplorer.id, updates);\n  },\n\n  onQueryNameChange: function(event) {\n    var name = event.target.value.replace(/[^\\w-]/g,'');\n    ExplorerActions.update(this.state.activeExplorer.id, { query_name: name });\n  },\n\n  handleRevertChanges: function(event) {\n    event.preventDefault();\n    ExplorerActions.revertActiveChanges();\n  },\n\n  handleQuerySubmit: function(event) {\n    event.preventDefault();\n    if (ExplorerUtils.isEmailExtraction(this.state.activeExplorer)) {\n      ExplorerActions.runEmailExtraction(this.props.client, this.state.activeExplorer.id);\n    } else {\n      ExplorerActions.exec(this.props.client, this.state.activeExplorer.id);\n    }\n  },\n\n  setExtractionType: function(event) {\n    var updates = {\n      query: {\n        email: event.target.value === 'email' ? \"\" : null\n      }\n    };\n    ExplorerActions.update(this.state.activeExplorer.id, updates);\n  },\n\n  handleClearQuery: function() {\n    // NOTE: (Eric Anderson, Aug 19, 2015): Awful terrible hack to\n    // ensure that the components properly display the values of the cleared\n    // model.\n    var self = this;\n    setTimeout(function(){\n      ExplorerActions.clear(self.state.activeExplorer.id);\n    }, 0);\n  },\n\n  handleAddFilter: function() {\n    ExplorerActions.addFilter(this.state.activeExplorer.id);\n  },\n\n  handleRemoveFilter: function(index) {\n    ExplorerActions.removeFilter(this.state.activeExplorer.id, index);\n  },\n\n  handleFilterChange: function(index, updates) {\n    ExplorerActions.updateFilter(this.state.activeExplorer.id, index, updates);\n  },\n\n  // ********************************\n  // Convenience functions\n  // ********************************\n\n  setVizWrapTop: function(top) {\n    this.refs['viz-area'].style.top = top + 'px';\n  },\n\n  getSelectedIndex: function() {\n    if (!this.state.activeExplorer || !ExplorerUtils.isPersisted(this.state.activeExplorer)) {\n      return null;\n    }\n    return _.findIndex(this.state.allPersistedExplorers, { id: this.state.activeExplorer.id });\n  },\n\n  toggleQueryPane: function(pane) {\n    this.setState({ activeQueryPane: pane });\n  },\n\n  getSelectedIndex: function() {\n    var index;\n    for (var i=0; i<this.state.allPersistedExplorers.length; i++) {\n      if (this.state.allPersistedExplorers[i].active) {\n        index = i;\n        break;\n      }\n    }\n    return index;\n  },\n\n  toggleCodeSample: function(event) {\n    event.preventDefault();\n    AppStateActions.update({\n      codeSampleHidden: !this.state.appState.codeSampleHidden\n    });\n  },\n\n  getEventPropertyNames: function(collection)  {\n    return ProjectUtils.getEventCollectionPropertyNames(\n      this.props.project,\n      collection\n    );\n  },\n\n  getPropertyType: function (eventCollection, property_name) {\n    return ProjectUtils.getPropertyType(\n      this.props.project,\n      eventCollection,\n      property_name\n    );\n  },\n\n  // Lifecycle hooks\n\n  componentDidMount: function() {\n    ExplorerStore.addChangeListener(this._onChange);\n    NoticeStore.addChangeListener(this._onChange);\n    AppStateStore.addChangeListener(this._onChange);\n  },\n\n  componentWillUnmount: function() {\n    ExplorerStore.removeChangeListener(this._onChange);\n    NoticeStore.removeChangeListener(this._onChange);\n    AppStateStore.removeChangeListener(this._onChange);\n    // Create a default filter if there are no filters already on this model\n    if (!this.state.activeExplorer.query.filters.length) {\n      ExplorerActions.addFilter(this.state.activeExplorer.id);\n    }\n  },\n\n  getInitialState: function() {\n    return _.assign(getStoresState(), {\n      activeQueryPane: 'build'\n    });\n  },\n\n  render: function() {\n    var cacheToggle,\n        queryPane,\n        queryPaneTabs,\n        browseListNotice,\n        browseEmptyContent;\n\n    if (this.props.persistence) {\n      queryPaneTabs = <QueryPaneTabs ref=\"query-pane-tabs\"\n                                     activePane={this.state.activeQueryPane}\n                                     toggleCallback={this.toggleQueryPane}\n                                     createNewQuery={this.createNewQuery}\n                                     persisted={ExplorerUtils.isPersisted(this.state.activeExplorer)} />;\n      if (['extraction'].indexOf(this.state.activeExplorer.query.analysis_type) === -1) {\n        cacheToggle = <CacheToggle model={this.state.activeExplorer} />;\n      }\n      if (this.state.appState.fetchingPersistedExplorers) {\n        browseListNotice = <Notice notice={{ icon: 'info-sign', text: 'Loading saved queries...', type: 'info' }} closable={false} />\n      } else {\n        browseEmptyContent = <h4 className=\"text-center\">You don&#39;t have any saved queries yet.</h4>;\n      }\n    }\n\n    if (!this.props.persistence || this.state.activeQueryPane === 'build') {\n      queryPane = <QueryBuilder ref=\"query-builder\"\n                                model={this.state.activeExplorer}\n                                originalModel={this.state.activeExplorerOriginal}\n                                client={this.props.client}\n                                project={this.props.project}\n                                onBrowseEvents={this.onBrowseEvents}\n                                handleFiltersToggle={this.handleFiltersToggle}\n                                handleRevertChanges={this.handleRevertChanges}\n                                handleQuerySubmit={this.handleQuerySubmit}\n                                setExtractionType={this.setExtractionType}\n                                handleClearQuery={this.handleClearQuery}\n                                getEventPropertyNames={this.getEventPropertyNames}\n                                getPropertyType={this.getPropertyType}\n                                analysisTypes={ProjectUtils.getConstant('ANALYSIS_TYPES')}\n                                stepNotices={this.state.stepNotices} />;\n    } else {\n      queryPane = <BrowseQueries ref=\"query-browser\"\n                                 listItems={this.state.allPersistedExplorers}\n                                 emptyContent={browseEmptyContent}\n                                 notice={browseListNotice}\n                                 clickCallback={this.savedQueryClicked}\n                                 selectedIndex={this.getSelectedIndex()} />;\n    }\n\n    return (\n      <div ref=\"root\">\n        <div className=\"row\">\n          <div className=\"col-sm-5 col-md-4 explorer-query-builder\">\n            {queryPaneTabs}\n            {queryPane}\n          </div>\n          <div ref=\"viz-area\" className=\"col-sm-7 col-md-8 explorer-visualization\">\n            <Visualization notice={this.state.notice}\n                           model={this.state.activeExplorer}\n                           client={this.props.client}\n                           project={this.props.project}\n                           config={this.props.config}\n                           persistence={this.props.persistence}\n                           onNameChange={this.onNameChange}\n                           appState={this.state.appState}\n                           toggleCodeSample={this.toggleCodeSample}\n                           onQueryNameChange={this.onQueryNameChange}\n                           onDisplayNameChange={this.onDisplayNameChange} />\n            {cacheToggle}\n            <QueryActions model={this.state.activeExplorer}\n                          handleRevertChanges={this.handleRevertChanges}\n                          handleQuerySubmit={this.handleQuerySubmit}\n                          saveQueryClick={this.saveQueryClick}\n                          removeClick={this.removeSavedQueryClicked}\n                          cloneQueryClick={this.cloneQueryClick}\n                          persistence={this.props.persistence}\n                          codeSampleHidden={this.state.appState.codeSampleHidden}\n                          toggleCodeSample={this.toggleCodeSample} />\n          </div>\n        </div>\n        <EventBrowser ref=\"event-browser\"\n                      client={this.props.client}\n                      project={this.props.project}\n                      currentEventCollection={this.state.activeExplorer.query.event_collection}\n                      selectEventCollection={this.selectEventCollection} />\n        <FilterManager ref=\"filter-manager\"\n                       eventCollection={this.state.activeExplorer.query.event_collection}\n                       filters={this.state.activeExplorer.query.filters}\n                       handleChange={this.handleFilterChange}\n                       removeFilter={this.handleRemoveFilter}\n                       addFilter={this.handleAddFilter}\n                       getPropertyType={this.getPropertyType}\n                       propertyNames={this.getEventPropertyNames(this.state.activeExplorer.query.event_collection)} />\n      </div>\n    );\n  },\n\n  _onChange: function() {\n    var newState = getStoresState();\n    this.setState(newState);\n    if (ExplorerUtils.isPersisted(newState.activeExplorer)) {\n      window.history.pushState({ model: newState.activeExplorer }, \"\", '?saved_query='+newState.activeExplorer.id);\n    } else {\n      QueryStringUtils.updateSearchString(ExplorerUtils.paramsForURL(newState.activeExplorer));\n    }\n  }\n});\n\nexport default Explorer;\n","import React from 'react';\nimport Loader from './common/loader.js';\nimport ProjectStore from '../stores/ProjectStore';\nimport AppStateStore from '../stores/AppStateStore';\nimport Explorer from './explorer/index.js';\n\nfunction getProjectState() {\n  return {\n    project: ProjectStore.getProject(),\n    app: AppStateStore.getState()\n  };\n}\n\nconst App = React.createClass({\n\n\tcomponentDidMount: function() {\n    ProjectStore.addChangeListener(this._onChange);\n    AppStateStore.addChangeListener(this._onChange);\n\t},\n\n  componentWillUnmount: function() {\n    ProjectStore.removeChangeListener(this._onChange);\n    AppStateStore.addChangeListener(this._onChange);\n  },\n\n\tgetInitialState: function() {\n\t\treturn getProjectState();\n\t},\n\n  render: function () {\n    return (\n      <div id=\"keen-explorer\">\n        <Loader visible={this.state.project.loading || !this.state.app.ready} additionalClasses=\"app-loader\" />\n        <Explorer project={this.state.project}\n                  client={this.props.client}\n                  persistence={this.props.persistence}\n                  config={this.props.config}/>\n      </div>\n    );\n  },\n\n  _onChange: function() {\n    this.setState(getProjectState());\n  }\n\n});\n\nexport default App;\n","module.exports = __WEBPACK_EXTERNAL_MODULE__82__;","export default {\n  isDST: function() {\n    var date = new Date();\n    var jan = new Date(date.getFullYear(), 0, 1);\n    var jul = new Date(date.getFullYear(), 6, 1);\n    var stdOffset = Math.max(jan.getTimezoneOffset(), jul.getTimezoneOffset());\n    return date.getTimezoneOffset() < stdOffset;\n  }\n};\n","import _ from 'lodash';\nimport FormatUtils from './FormatUtils';\nimport FilterUtils from './FilterUtils';\nimport TimeframeUtils from './TimeframeUtils';\n\nconst STEP_PARAMS = [\n  'event_collection',\n  'actor_property',\n  'timeframe',\n  'interval',\n  'timezone',\n  'filters',\n  'optional',\n  'inverted',\n  'with_actors'\n];\nexport default {\n\n  stepJSON: function (step) {\n    var params = _.cloneDeep(step);\n\n    _.assign(params, TimeframeUtils.getTimeParameters(step.time, step.timezone));\n\n    if (params.filters) {\n      params.filters = _.map(params.filters, function(filter) {\n        return FilterUtils.queryJSON(filter, TimeframeUtils.getTimezoneOffset(params.timezone));\n      });\n\n      _.remove(params.filters, _.isEmpty);\n    }\n\n    // Remove empty, null, or unnecessary properties\n    _.each(params, function(value, key) {\n      if (!FormatUtils.isValidQueryValue(value) || !_.includes(STEP_PARAMS, key)) {\n        delete params[key];\n      }\n    });\n\n    return params;\n  },\n\n  formatQueryParams: function (step) {\n    if (step.timeframe) {\n      var unpackedTime = TimeframeUtils.unpackTimeframeParam(step.timeframe, step.timezone);\n      step.time = unpackedTime.time;\n      step.timezone = unpackedTime.timezone;\n    }\n\n    if (step.filters) {\n      step.filters = _.compact(_.map(step.filters, FilterUtils.formatFilterParams));\n    }\n\n    step.inverted = (step.inverted === true || step.inverted === \"true\");\n    step.optional = (step.optional === true || step.optional === \"true\");\n    step.with_actors = (step.with_actors === true || step.with_actors === \"true\");\n\n    return step;\n  }\n\n};\n","module.exports = __WEBPACK_EXTERNAL_MODULE__85__;","import _ from 'lodash';\nimport ExplorerUtils from '../../utils/ExplorerUtils';\n\nfunction KeenSavedQueries(config) {\n  this.config = config;\n}\n\nKeenSavedQueries.prototype.create = function(model, callback) {\n  var body = _.omit(model, ['id']);\n  this.config.client\n    .put({\n      url: this.config.client.url('queries', 'saved', model.query_name),\n      api_key: this.config.client.masterKey(),\n      params: body\n    })\n    .then(function(res){\n      callback(null, res);\n    })\n    .catch(callback);\n};\n\nKeenSavedQueries.prototype.update = function(model, callback) {\n  var body = _.omit(model, ['id']);\n  this.config.client\n    .put({\n      url: this.config.client.url('queries', 'saved', model.id),\n      api_key: this.config.client.masterKey(),\n      params: body\n    })\n    .then(function(res){\n      callback(null, res);\n    })\n    .catch(callback);\n};\n\nKeenSavedQueries.prototype.destroy = function(model, callback) {\n  this.config.client\n    .del({\n      url: this.config.client.url('queries', 'saved', model.id),\n      api_key: this.config.client.masterKey()\n    })\n    .then(function(res){\n      callback(null, res);\n    })\n    .catch(function(err){\n      if (err.status === 204) {\n        callback(null, undefined);\n      }\n      else {\n        callback(err, null);\n      }\n    });\n};\n\nKeenSavedQueries.prototype.get = function(model, callback) {\n  if (model) {\n    this.config.client\n      .get({\n        url: this.config.client.url('queries', 'saved', model.id),\n        api_key: this.config.client.masterKey()\n      })\n      .then(function(res){\n        callback(null, res);\n      })\n      .catch(callback);\n  } else {\n    this.config.client\n      .get({\n        url: this.config.client.url('queries', 'saved'),\n        api_key: this.config.client.masterKey()\n      })\n      .then(function(res){\n        callback(null, res);\n      })\n      .catch(callback);\n  }\n};\n\nexport default KeenSavedQueries;\n","import KeenSavedQueries from './KeenSavedQueries.js';\n\nexport default {\n  KeenSavedQueries\n};\n","module.exports = __WEBPACK_EXTERNAL_MODULE__88__;","module.exports = __WEBPACK_EXTERNAL_MODULE__89__;","import _ from 'lodash';\nimport KeenAnalysis from 'keen-analysis';\nimport React from 'react';\nimport ReactDOM from 'react-dom';\n\nimport Persistence from './modules/persistence/persistence.js';\nimport AppDispatcher from './dispatcher/AppDispatcher';\nimport AppComponent from './components/app.js';\nimport ProjectActions from './actions/ProjectActions';\nimport ExplorerActions from './actions/ExplorerActions';\nimport AppStateActions from './actions/AppStateActions';\nimport NoticeActions from './actions/NoticeActions';\nimport ExplorerUtils from './utils/ExplorerUtils';\nimport FormatUtils from './utils/FormatUtils';\nimport RunValidations from './utils/RunValidations';\nimport ExplorerValidations from './validations/ExplorerValidations';\nimport ExplorerStore from './stores/ExplorerStore';\nimport ProjectStore from './stores/ProjectStore';\nimport QueryStringUtils from './utils/QueryStringUtils';\n\nexport const KeenExplorer = function (options) {\n  var tempId = FormatUtils.generateTempId();\n  this.appDispatcher = AppDispatcher;\n  this.config = {\n    params: QueryStringUtils.getQueryAttributes(),\n    persistence: null\n  };\n  if (typeof options === 'string') {\n    // backward compatibility\n    this.el(options);\n  } else {\n    // configuration object\n    this.config = { ...this.config, ...options };\n    this.el(this.config.container);\n  }\n  if (!this.config.el) {\n    console.error(\"Can't find HTML element\", el);\n  }\n  ExplorerActions.create(_.assign(ExplorerUtils.formatQueryParams(this.config.params) || {}, { 'id': tempId }));\n  ExplorerActions.setActive(tempId);\n  ExplorerActions.validate(tempId);\n  if (this.config.keenAnalysisOptions) {\n    this.client(this.config.keenAnalysisOptions);\n  }\n}\n\nKeenExplorer.prototype.client = function(obj) {\n  if (!arguments.length) return this.config.client;\n  this.config.client = new KeenAnalysis(obj);\n  this.config.client.resources({\n    'events': '{protocol}://{host}/3.0/projects/{projectId}/events'\n  });\n  ProjectActions.create({ client: this.config.client });\n  ProjectActions.fetchProjectCollections(this.config.client);\n  if (this.config.persistence) {\n    this.persistence(true);\n  }\n  this.fetch();\n  return this;\n};\n\nKeenExplorer.prototype.el = function(target) {\n  if (!arguments.length) return this.config.el;\n  if (target.nodeName) {\n    this.config.el = target;\n  }\n  else if (document.querySelector) {\n    this.config.el = document.querySelector(target);\n  }\n  else {\n    this.config.el = undefined;\n  }\n  return this;\n};\n\nKeenExplorer.prototype.fetch = function(){\n  if (this.config.persistence) {\n    ExplorerActions.fetchAllPersisted(this.config.persistenceInstance, function(err) {\n      if (err) console.error('There was an error fetching the persisted explorers: ', err.stack);\n    });\n    // Is this a saved query we want to load?\n    if (this.config.params.saved_query) {\n      // Once the models come back from the server, mark the right one as active.\n      ExplorerActions.fetchPersisted(this.config.persistenceInstance, { id: this.config.params.saved_query },\n        this.doneFetchingSavedQuery.bind(this, this.config.params.saved_query));\n    } else {\n      AppStateActions.update({ ready: true });\n      // Run the query for this explorer if it's valid\n      var isEmailExtraction = ExplorerUtils.isEmailExtraction(ExplorerStore.getActive());\n      RunValidations.run(ExplorerValidations, ExplorerStore.getActive());\n      if (!isEmailExtraction && ExplorerStore.getActive().isValid) {\n        ExplorerActions.exec(this.config.client, ExplorerStore.getActive().id);\n      }\n    }\n  } else {\n    AppStateActions.update({ ready: true });\n  }\n  this.render();\n  return this;\n};\n\nKeenExplorer.prototype.persistence = function(bool) {\n  if (!arguments.length) return this.config.persistenceInstance;\n  if (typeof bool === 'boolean' && bool) {\n    if (!this.config.client || !this.config.client.masterKey()) {\n      console.error('The Persistence feature requires a client instance with a masterKey value');\n    }\n    this.config.persistenceInstance = new Persistence.KeenSavedQueries({\n      baseUrl: this.config.client.url('queries', 'saved'),\n      client: this.config.client\n    });\n    this.config.persistenceInstance.config.masterKey = this.config.client.masterKey();\n  }\n  return this;\n};\n\nKeenExplorer.prototype.doneFetchingSavedQuery = function(savedQueryName, err) {\n  if (!err) {\n    ExplorerActions.setActive(savedQueryName);\n    ExplorerActions.exec(this.config.client, savedQueryName);\n    AppStateActions.update({ ready: true });\n  } else {\n    if (err.status === 404) {\n      // We couldn't find that saved query.\n      NoticeActions.create({\n        text: 'The saved query '+savedQueryName+' could not be found.',\n        type: 'error',\n        icon: 'remove-sign'\n      });\n      var id = FormatUtils.generateTempId();\n      ExplorerActions.create({ id: id });\n      ExplorerActions.setActive(id);\n      AppStateActions.update({ ready: true });\n    } else {\n      console.error(\"There was a problem fetching a saved query: \", err.stack);\n    }\n  }\n};\n\nKeenExplorer.prototype.render = function() {\n  let Component = React.createFactory(AppComponent);\n  ReactDOM.render(Component({\n    persistence: this.config.persistenceInstance,\n    client: this.config.client,\n    config: this.config\n  }), this.config.el);\n};\n\nexport let keenGlobals = undefined;\nif (typeof webpackKeenGlobals !== 'undefined') {\n  keenGlobals = webpackKeenGlobals;\n}\n\nKeenExplorer.Persistence = Persistence;\nexport default KeenExplorer;\n"],"sourceRoot":""}